<!doctype html>
<html lang="en">
    <head>
        <!-- OneTrust Cookies Consent Notice start for fintego.com -->
        <script refer async type="text/javascript">
            function OptanonWrapper() { }
        </script>
        <!-- OneTrust Cookies Consent Notice end for fintego.com -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script refer async>
            document.addEventListener('DOMContentLoaded', e => {
                window.dataLayer = window.dataLayer || []
                if (document.getElementById('page-industries')) {
                    const industriesList = Array.from(document.getElementById('page-industries').classList)
                    industriesList.forEach(industry => {
                        window.dataLayer.push ({"event": "page-load", "PageGrouping": industry});
                    })
                }
                if (document.getElementById('page-services')) {
                    const servicesList = Array.from(document.getElementById('page-services').classList)
                    servicesList.forEach(service => {
                        window.dataLayer.push ({"event": "page-load", "PageGrouping": service});
                    })
                }
            })
        </script>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
        {'gtm.start': new Date().getTime(),event:'gtm.js'}
        );var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','');</script>
        <!-- End Google Tag Manager -->
        <!-- Google tag (gtag.js) -->
        <script refer async src="https://www.googletagmanager.com/gtag/js?id="></script>
        <link rel="shortcut icon" type="image/x-icon" href="/theme/fintego/static/images/favicon/favicon.svg" />
        <script refer src="https://code.jquery.com/jquery-3.7.1.min.js"crossorigin="anonymous"></script>
        <link rel="manifest" href="/theme/fintego/static/images/favicon/site.webmanifest">
        <script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BreadcrumbList","itemListElement":[[{"@type":"ListItem","position":1,"item":"https:\/\/www.fintego.com\/","name":"Home"},{"@type":"ListItem","position":2,"item":"https:\/\/www.fintego.com\/blog","name":"Blog"},{"@type":"ListItem","position":3,"name":"Mastering MLOps practices for a trading bot "}]]}</script>
        <title>
        Mastering MLOps for trading bots
        </title>
        <script refer async type="text/javascript" src="//cdn-4.convertexperiments.com/js/10041441-10041537.js"></script>
        <link rel="stylesheet" href="/theme/fintego/assets/app.min.41025cec95a71e1b0698.css">
        <link rel="preload" href="/theme/fintego/assets/swiper-bundle.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
                <script refer src="//offer.fintego.com/js/forms2/js/forms2.min.js"></script>
    <meta property="og:locale" content="en" />
        <meta property="og:title" content="Mastering MLOps for trading bots" />
        <meta property="og:description" content="Discover the power of MLOps in optimizing machine learning model production, maintenance and deployment for trading bots. " />
        <meta name="description" content="Discover the power of MLOps in optimizing machine learning model production, maintenance and deployment for trading bots. " />
                    <meta property="og:url" content="/blog/mastering-mlops-for-trading-bots" />
                    <meta property="og:image:width" content="960">
        <meta property="og:image:height" content="960">
        <meta property="og:image" content="/files/blog/2023/08/1692174572_431955-CIS-CIS-blog-page-2-Blog-banner-960x960px-2023-07-27.jpg" />
        <meta name="twitter:image" content="/files/blog/2023/08/1692174572_431955-CIS-CIS-blog-page-2-Blog-banner-960x960px-2023-07-27.jpg" />
        <meta name="twitter:description" content="Discover the power of MLOps in optimizing machine learning model production, maintenance and deployment for trading bots. " />
        <meta name="twitter:title" content="Mastering MLOps for trading bots" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@luxoft" />
        <script id="imageMarkUpData" type="application/ld+json"></script>
                            <link rel="canonical" href="/blog/mastering-mlops-for-trading-bots">
<meta name="generator" content="Bolt">
</head>
    <body class="  bd-white
">
        <a href="#main-content" class="skip-link">Skip to main content</a>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
<header class="header ">
    <div class="container--wide">
        <div class="header__nav">
            <div class="switch" id="menu-switcher">
                <div class="item"></div>
                <div class="item"></div>
                <div class="item"></div>
                <div class="text">
                    <span>Menu</span>
                </div>
            </div>
            <div class="logo">
                <a href="/">
                    <img src="/theme/fintego/assets/images/logo/fintego-new-white.svg"
                         class="img img--white"
                         alt="Luxoft | A leading IT company for cutting-edge software engineering and digital transformation services"
                         style="width:110px" />
                </a>
            </div>
            <div class="lux-menu">
                <nav class="lux-menu__nav">
                    <div class="lux-menu__line"></div>
                    <ul>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">Industries</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>Industries
                                        </a>
                                    </li>
                                    <li><a href="/industries/automotive">Automotive</a></li>
                                    <li><a href="/industries/banking">Banking</a></li>
                                    <li>
                                        <a href="/industries/capital-markets">Capital Markets</a>
                                    </li>
                                    <li><a href="/industries/consumer-goods">Consumer Goods</a></li>
                                    <li>
                                        <a href="/industries/energy-and-utilities">Energy and Utilities</a>
                                    </li>
                                    <li>
                                        <a href="/industries/healthcare">
                                            Healthcare and Life Sciences
                                        </a>
                                    </li>
                                    <li><a href="/industries/insurance">Insurance</a></li>
                                    <li>
                                        <a href="/industries/manufacturing">Manufacturing</a>
                                    </li>
                                    <li><a href="/industries/media">Media</a></li>
                                    <li>
                                        <a href="/industries/technology-networking">
                                            Networking and Technology
                                        </a>
                                    </li>
                                    <li><a href="/industries/oil">Oil and Gas</a></li>
                                    <li>
                                        <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
                                    </li>
                                    <li>
                                        <a href="/industries/telecommunications">
                                            Telecommunications
                                        </a>
                                    </li>
                                    <li><a href="/industries/travel-and-hospitality">Travel and Hospitality</a></li>
                                    <li>
                                        <a href="/industries/transportation-and-logistics">
                                            Transportation and Logistics
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">Services</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>Services
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/cloud-solutions">Cloud Solutions</a>
                                    </li>
                                    <li>
                                        <a href="/services/data-to-insights">Data Analytics</a>
                                    </li>
                                    <li><a href="/services/design">Design</a></li>
                                    <li>
                                        <a href="/services/engineering-services">Engineering</a>
                                    </li>
                                    <li>
                                        <a href="/services/front-end-development">Front-end Development</a>
                                    </li>
                                    <li>
                                        <a href="/services/innovation-strategy">
                                            Innovation Strategy
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/intelligent-automation">
                                            Intelligent Automation
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/legacy-modernization">
                                            Legacy Modernization
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/beyond">Luxoft Beyond</a>
                                    </li>
                                    <li>
                                        <a href="/services/machine-learning">Machine Learning</a>
                                    </li>
                                    <li><a href="/services/qa-automation">QA Automation</a></li>
                                </ul>
                            </div>
                        </li>
                        <li class="firstLvl">
                            <a href="/case-studies">Case studies</a>
                        </li>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">Insights</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>Insights
                                        </a>
                                    </li>
                                    <li><a href="/insights">Insights and Resource Hub</a></li>
                                    <li><a href="/insights/automotive">Automotive Insights</a></li>
                                    <li><a href="/insights/financial-services">Financial Services Insights</a></li>
                                    <li><a href="/insights/cross-industry-solutions">Cross-Industry Solutions Insights</a></li>
                                    <li><a href="/insights/technology-and-engineering">Technology and Engineering Insights</a></li>
                                </ul>
                            </div>
                        </li>
                        <li class="firstLvl">
                            <a href="https://career.fintego.com/">
                                Careers
                            </a>
                        </li>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">About us</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>About us
                                        </a>
                                    </li>
                                    <li><a href="/about-us">About Luxoft</a></li>
                                    <li><a href="/esg">Environmental, Social and Governance</a></li>
                                    <li><a href="/event">Events</a></li>
                                    <li><a href="/global-presence">Global Presence</a></li>
                                    <li><a href="/pr">Newsroom</a></li>
                                    <li><a href="/partners">Partnerships</a></li>
                                    <li><a href="/ukraine-updates">Ukraine updates</a></li>
                                </ul>
                            </div>
                        </li>
                                                <li class="firstLvl"><a href="/contact-form">Contact us</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="header__new-menu">
            <ul>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">Industries</a>
                    <div class="header__new-menu--sub-menu industry-expertise">
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/automotive">Automotive</a>
                            </div>
                            <div class="single">
                                <a href="/industries/healthcare">
                                    Healthcare and Life Sciences
                                </a>
                            </div>
                            <div class="single">
                                <a href="/industries/oil">Oil and Gas</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/banking">Banking</a>
                            </div>
                            <div class="single">
                                <a href="/industries/insurance">Insurance</a>
                            </div>
                            <div class="single">
                                <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/capital-markets">Capital Markets</a>
                            </div>
                            <div class="single">
                                <a href="/industries/manufacturing">Manufacturing</a>
                            </div>
                            <div class="single">
                                <a href="/industries/telecommunications">Telecommunications</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/consumer-goods">Consumer Goods</a>
                            </div>
                            <div class="single">
                                <a href="/industries/media">Media</a>
                            </div>
                            <div class="single">
                                <a href="/industries/travel-and-hospitality">Travel and Hospitality</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/energy-and-utilities">Energy and Utilities</a>
                            </div>
                            <div class="single">
                                <a href="/industries/technology-networking">
                                    Networking and Technology
                                </a>
                            </div>
                            <div class="single">
                                <a href="/industries/transportation-and-logistics">
                                    Transportation and Logistics
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">Services</a>
                    <div class="header__new-menu--sub-menu our-services">
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/services/cloud-solutions">Cloud Solutions</a>
                            </div>
                            <div class="single">
                                <a href="/services/engineering-services">Engineering</a>
                            </div>
                            <div class="single">
                                <a href="/services/intelligent-automation">
                                    Intelligent Automation
                                </a>
                            </div>
                            <div class="single">
                                <a href="/services/machine-learning">Machine Learning</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/services/data-to-insights">Data Analytics</a>
                            </div>
                            <div class="single">
                                <a href="/services/front-end-development">Front-end Development</a>
                            </div>
                            <div class="single">
                                <a href="/services/legacy-modernization">
                                    Legacy Modernization
                                </a>
                            </div>
                            <div class="single">
                                <a href="/services/qa-automation">QA Automation</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/services/design">Design</a>
                            </div>
                            <div class="single">
                                <a href="/services/innovation-strategy">
                                    Innovation Strategy
                                </a>
                            </div>
                            <div class="single">
                                <a href="/services/beyond">Luxoft Beyond</a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="/case-studies" class="element">Case studies</a>
                </li>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">Insights</a>
                    <div class="header__new-menu--sub-menu insights-menu">
                        <div class="header__new-menu--sub-menu--item align-items-center">
                            <div class="single">
                                <a href="/insights">Insights and Resource Hub</a>
                            </div>
                            <div class="single">
                                <a href="/insights/automotive">Automotive Insights</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/insights/financial-services">Financial Services Insights</a>
                            </div>
                            <div class="single">
                                <a href="/insights/cross-industry-solutions">Cross-Industry Solutions Insights</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/insights/technology-and-engineering">Technology and Engineering Insights</a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://career.fintego.com/" class="element">Careers</a>
                </li>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">About us</a>
                    <div class="header__new-menu--sub-menu about-us">
                        <div class="header__new-menu--sub-menu--item align-items-center">
                            <div class="single">
                                <a href="/about-us">About Luxoft</a>
                            </div>
                            <div class="single">
                                <a href="/esg">Environmental, Social and Governance</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/event">Events</a>
                            </div>
                            <div class="single">
                                <a href="/pr">Newsroom</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/global-presence">Global Presence</a>
                            </div>
                            <div class="single">
                                <a href="/partners">Partnerships</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/ukraine-updates">Ukraine updates</a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a class="contact" href="/contact-form" aria-label="Contact us">
                        <div class="contact--image"></div>
                    </a>
                </li>
            </ul>
        </div>
                <div class="header__contact">
            <ul>
                <li>
                    <a href="#" class="search-btn" id="search-btn">
                        <img src="/theme/fintego/assets/images/icons/search.svg"
                             alt="search icon" />
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="header__contact--square" id="header--square"></div>
    <div class="header__search-open">
        <div class="header__search-open__panel">
            <div class="header__search-open__top">
                <div class="close" id="close-search">
                    &times;
                </div>
            </div>
            <div class="header__search-open__form">
                <form id="global-search" method="GET" action="/search">
                    <input id="input-search" type="text" name="q" placeholder="Search..." />
                </form>
            </div>
        </div>
    </div>
</header>
      <script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Mastering MLOps practices for a trading bot ","description":"Discover the power of MLOps in optimizing machine learning model production, maintenance and deployment for trading bots. ","name":"Blog","url":"https:\/\/www.fintego.com\/blog\/mastering-mlops-for-trading-bots","inLanguage":"en","articleBody":"<p>{​{light_breadcrumbs(record)}​}<\/p>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<section class=\"blog-in-brief\">\r\n<p class=\"blog-in-brief__heading text-20 unscaled\">\r\n    In brief\r\n<\/p>\r\n<ul class=\"text-18 default-ul unscaled\"><li><b><\/b><b><\/b><b><\/b><span data-contrast=\"auto\">Machine learning operations (MLOps) is a core part of machine learning engineering, helping to streamline the way that machine learning models are taken to production, maintained and monitored<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\"><\/span><span data-contrast=\"auto\"><\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\">&nbsp;<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\"><\/span><\/li>\r\n    <li><b><\/b><b><\/b><b><\/b><span data-contrast=\"auto\">Applying these practices increases the quality, simplifies the management process, and automates the deployment of machine learning models in large-scale production environments<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\"><\/span><\/li><li><b><\/b><b><\/b>This article describes the way we introduced MLOps to a trading bot development project and how this helped to control the models<span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\"><\/span><\/li>\r\n<\/ul>\r\n<\/section>\r\n<p>\r\n    &nbsp;&nbsp;\r\n<\/p>\r\n<div><div><div><p><span data-contrast=\"none\">As your team grows, the processes become more complex. In this article, we will talk about the interaction of a large system of neural networks for a trading bot project and the MLOps system, you might start thinking about MLOps technologies and how they can help increase control over development. If talking about our team, at some point we began to feel that we were lacking MLOps practices, so we decided to explore new tools and options.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">To master these, we chose one of our projects — a trading bot with several types of models, some of these models have various versions. Without MLOps, controlling the models might be a challenging task, so this project is of high priority for us.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">In this article, we will describe how we translated our trading bot to the Vertex AI platform from Google.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div>\r\n\r\n<\/div>\r\n<p>&nbsp; &nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n    About the project   \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div>\r\n    <div><p><span data-contrast=\"none\">Most algorithms for analyzing stock price behavior are based only on the historical price, but it is also important to consider the impact of company news. Therefore, our main idea was to create a system that could predict the price not only according to a schedule, but also according to text news.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">The main idea of the algorithm was to combine the company news, the stock price and technical analysis. This requires 3 machine learning models:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><div><ol class=\"text-18 unscaled\"><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"8\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\">Language model — it evaluates the news. This estimate is the model’s confidence that the price will rise by a certain threshold.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-aria-level=\"1\" data-aria-posinset=\"1\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-listid=\"8\" data-font=\"Calibri\" data-leveltext=\"%1.\"><span data-contrast=\"none\">The model for time series processing also converts the price chart and technical analysis into confidence.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"8\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\">The final classifier takes an average estimate of the news for the current day as input, their number and the confidence of the model for time series.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ol><\/div>\r\n<div><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-01-1.jpg\" id=\"191415boxizo\" data-image=\"191415boxizo\"><\/figure><\/div>\r\n<\/div>\r\n<\/div>\r\n<div>\r\n    \r\n<p>&nbsp;<\/p><p><span data-contrast=\"none\">Thus, we have a system that gives predictions both on the text and the price chart.<\/span><\/p><p>&nbsp;<\/p>\r\n<\/div>\r\n<h2 class=\"text-24 unscaled\">\r\n    Language model \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div>\r\n    <div><p><span data-contrast=\"none\">As the foundation of the language model, we chose the GPT-2 transformer. This model was introduced by OpenAI in early 2019. The model was previously trained on a WebText dataset consisting of 45 million links to websites.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">GPT-2 converts the text at the input into a special matrix that contains a contextual representation of words. Next, this matrix is transformed using a single linear layer into a binary classification.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">The resulting language model is universal for all companies.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n\r\n\r\n<\/div>\r\n<p>&nbsp;&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">Price model  <\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><p><span data-contrast=\"none\">Recurrent networks are best suited as the basic network architecture for working with stock prices. The main advantage of recurrent networks is the ability to remember long-term dependencies. <\/span><span data-contrast=\"auto\">There are many implementations of this architecture, but the long short-term memory (LSTM) network is considered one of the best in terms of operational quality<\/span><span data-contrast=\"none\">. The developed network consists of several LSTM blocks and subsequent data transformation.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">A vector from the historical price and several technical analysis indicators are fed to the input at each moment in time. The output of the last cell is fed into a neural network consisting of four layers. As a result, we have three numbers corresponding to the confidence of the model to buy, hold or sell the stock.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><\/div>\r\n<h2 class=\"text-24 unscaled\">Final classifier   <\/h2>\r\n<p>&nbsp;<\/p>\r\n<p><span data-contrast=\"none\">As the final classifier, we use a random forest. This model belongs to the algorithms of classical machine learning and consists of several decision trees that determine, by majority vote, whether the price will rise.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<p>&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">Testing    <\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><p><span data-contrast=\"none\">To test the algorithm, we decided to implement a trading strategy for it. To do this, we compiled a portfolio of several shares and selected the maximum fraction of one share when buying. After that, we performed back-testing, that is, the launch of a trading strategy based on historical data.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">The following table shows the test results. The graph shows the account balance over time.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure class=\"align-center\"><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-02-v2.jpg\" id=\"r8lgqhdcyq0i\" data-image=\"r8lgqhdcyq0i\"><\/figure><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-03.jpg\" id=\"0tl8dcpv0xch\" data-image=\"0tl8dcpv0xch\"><\/figure><p>&nbsp;<\/p><div><p><span data-contrast=\"none\">As a result of testing the trading strategy, we obtained positive results (most of the transactions are positive, the drawdown is less than 1%, the average profit of the transaction is 1.8%).<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">We were rather pleased with the results thus far. We do, however, need to dive a little deeper into the world of MLOps to demonstrate how this was able to help us and how Vertex AI is ready for ML.&nbsp;<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><\/div><\/div>\r\n<h2 class=\"text-24 unscaled\">MLOps    <\/h2>\r\n<p>&nbsp;<\/p>\r\n<p><i>MLOps<\/i><span data-contrast=\"none\"> is an ML engineering culture and practice that aims at unifying ML system development (Dev) and ML system operation (Ops). Practicing MLOps means that you advocate for automation and monitoring at all steps of ML system construction, including integration, testing, releasing, deployment and infrastructure management.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<p>&nbsp;<\/p>\r\n<figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-04-1.jpg\" id=\"u9vwk7h06ije\" data-image=\"u9vwk7h06ije\"><\/figure>\r\n<p>&nbsp;<\/p>\r\n<div><p><span data-contrast=\"none\">Below is a classic diagram from a <\/span><a href=\"https:\/\/cloud.google.com\/architecture\/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning#ml_pipeline_triggers\" target=\"_blank\"><span data-contrast=\"none\">Google article<\/span><\/a><span data-contrast=\"none\"> which shows that only a small part of the real ML system is contained in the ML code. The necessary elements surrounding it are extensive and complex.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">On this diagram, the rest of the system consists of configurations, automations, data collection, verification, testing, debugging, resource management, model analysis, metadata management, model serving and monitoring.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-05.jpg\" id=\"6tpkp2upxrpj\" data-image=\"6tpkp2upxrpj\"><\/figure><p>&nbsp;<\/p><p><span data-contrast=\"none\">The automation level of these processes determines the maturity level of your ML project, which reflects the speed of models learning on new data, or the speed of learning taking into account other implementations. Next, we will describe two levels of MLOps, starting with the most common one — which does not require automation, and then we will switch to the full automation of ML and CI\/CD pipelines.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><\/div>\r\n<h2 class=\"text-24 unscaled\">MLOps level 0: Manual process    <\/h2>\r\n<p>&nbsp;<\/p>\r\n<figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-06.jpg\" id=\"jk050s5ab5us\" data-image=\"jk050s5ab5us\"><\/figure>\r\n<p>&nbsp;<\/p>\r\n<div><p><span data-contrast=\"none\">The following list of characteristics reflects the MLOps level 0 setup:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><div><div><div><div><ul class=\"default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Manual, scripted interactive process<\/b><span data-contrast=\"none\">.<\/span><span data-contrast=\"none\"> <\/span><span data-contrast=\"none\">Each of the standard steps is performed manually; manual code execution, and manual data exchange between the steps are required<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Disconnect between ML and operations<\/b>.<span data-contrast=\"none\"> <\/span><span data-contrast=\"none\">The process divides data scientists who develop models and the engineers serving them. DS passes the model in the form of an artifact to the team of engineers<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><b>Infrequent release iterations<\/b>.<span data-contrast=\"none\"> <\/span><span data-contrast=\"none\">The process assumes that the data scientist team manages a certain number of models, while the frequency of their updates is not very clear<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><b>No CI<\/b><span data-contrast=\"none\">. Since there are supposed to be some changes in the implementation, CI is ignored. Usually, code testing runs using laptops or some scripts<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><b>No CD<\/b><span data-contrast=\"none\">. Since there is no versioned deployment of models, CD is ignored<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"5\" data-aria-level=\"1\"><b>Deployment refers to a prediction service<\/b><span data-contrast=\"none\">. This process only concerns the deployment of a trained model as a “prediction service”, it can be a microservice with a REST API, for example, and not an ML system deployment<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Lack of active performance monitoring<\/b><span data-contrast=\"none\">. The process does not analyze the model operation, which is required to track model degradation<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div>\r\n\r\n<\/div><\/div>\r\n\r\n\r\n\r\n<\/div>\r\n<p>&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n    MLOps Level 1  \r\n<\/h2>\r\n<p>&nbsp;<\/p>\r\n<figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-07.jpg\" id=\"q0e1x2injzc1\" data-image=\"q0e1x2injzc1\"><\/figure>\r\n<p>&nbsp;<\/p>\r\n<p>\r\n    &nbsp;&nbsp;\r\n<\/p>\r\n<p dir=\"ltr\"><span data-contrast=\"none\">The following list highlights characteristics of the Level 1 setup:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<div><div><div><div><ul class=\"default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Quick experiments<\/b><span data-contrast=\"none\">. The steps of the ML experiment process are consistent. Transitions between steps are automated<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><b>Model CT to production<\/b><span data-contrast=\"none\">. The model is automatically trained in the production environment using up-to-date data and pipeline triggers<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><b>Experimental-operational symmetry<\/b><span data-contrast=\"none\">. This is a pipeline implementation that is used in the development or experimental environment and in the preparation and production environment, which is a key aspect of MLOps practice for the unification of DevOps<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><b>Modular code for components and pipelines<\/b><span data-contrast=\"none\">.<\/span><span data-contrast=\"none\"> <\/span><span data-contrast=\"none\">To build ML pipelines, components must be reusable, composable and potentially shared in ML pipelines. In addition, ideally, components should be placed in containers to perform the following tasks:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><div><ul class=\"default-ul align-left\"><li data-leveltext=\"o\" data-font=\"Courier New\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":1440,\"335559991\":360,\"469769226\":\"courier=\"\" new\",\"469769242\":[9675],\"469777803\":\"left\",\"469777804\":\"o\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"2\"><span data-contrast=\"none\">Decouple the execution environment from the custom code runtime<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"o\" data-font=\"Courier New\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":1440,\"335559991\":360,\"469769226\":\"courier=\"\" new\",\"469769242\":[9675],\"469777803\":\"left\",\"469777804\":\"o\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"2\"><span data-contrast=\"none\">Make code reproducible between development and production environments<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"o\" data-font=\"Courier New\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":1440,\"335559991\":360,\"469769226\":\"courier=\"\" new\",\"469769242\":[9675],\"469777803\":\"left\",\"469777804\":\"o\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"2\"><span data-contrast=\"none\">Isolate each component in the pipeline. Components can have their own version of the runtime environment and have different languages and libraries<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div>\r\n<div><div><ul class=\"default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Apply models CD<\/b><span data-contrast=\"none\">. The ML pipeline is continuously delivered to the production inference server and trained on new data. This is a deployment step when the validated models move to the step of serving models and creating inference services<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"6\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><b>Pipeline deployment<\/b><span data-contrast=\"none\">. At level 0, you have deployed the model as an inference server. Level 1 implies the deployment of the entire training pipeline, which is automatically and recursively run, while serving trained and validated models as a prediction service<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div><\/div><\/div>\r\n<p><b>&nbsp;&nbsp;<\/b><\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n    Vertex AI  \r\n<\/h2>\r\n<p>&nbsp;<\/p>\r\n<p><span data-contrast=\"none\">The main feature of the new platform is its scale and integration with Google Cloud. Vertex AI has all Google cloud tools incorporated for preparing datasets and training ML models.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<p>&nbsp;<\/p>\r\n<figure class=\"align-center\"><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/Mastering-MLOps-practices-for-a-trading-bot\/433537-HO-GEMS-blog-1-chart-08.jpg\" id=\"hpequntzrnf8\" data-image=\"hpequntzrnf8\"><\/figure>\r\n<p>&nbsp;<\/p>\r\n<div><p><span data-contrast=\"none\">According to Google developers, teams will be able to completely transfer all ML processes to Vertex AI: Data engineers search for data in Google BigQuery, annotators mark-up data using built-in tools, data scientists configure learning algorithms in AutoML and automatically select optimal hyperparameters. A trained and tested ML model can be connected to a working application in a couple of clicks — either uploaded to a specially prepared server in Google Cloud or exported to one of the popular formats.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">Despite the comprehensiveness of the platform, developers have provided with the possibility to replace any part of it with their own solutions. Support of Docker containers allows the writing code in any programming language and use of any libraries. Client bindings for Python, Java and Node.js are officially supported. Containers are not limited to anything in particular, they have access to the Internet and Google Storage, which allows the downloading of any data necessary for training the model. A similar mechanism also works for the code of the ML model itself, which can be created using an arbitrary technology, packed into a container and loaded onto Vertex AI.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<p>&nbsp;&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n    Initial setup  \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div>\r\n    <div><div><p><span data-contrast=\"none\">1. In the Google Cloud console, on the project selector page, select or <\/span><a href=\"https:\/\/cloud.google.com\/resource-manager\/docs\/creating-managing-projects\" target=\"_blank\"><span data-contrast=\"none\">create a Google Cloud project<\/span><\/a><span data-contrast=\"none\">. Make sure that billing is enabled for your Cloud project.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">2. <\/span><a href=\"https:\/\/console.cloud.google.com\/flows\/enableapi?apiid=aiplatform.googleapis.com&amp;_ga=2.262763340.173902850.1663164267-1097805963.1661340542\" target=\"_blank\"><span data-contrast=\"none\">Enable<\/span><\/a><span data-contrast=\"none\"> the Vertex AI API.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">3. Install the gcloud CLI. For Linux, run the following commands:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>curl -O https:\/\/dl.google.com\/dl\/cloudsdk\/channels\/rapid\/downloads\/google-cloud-cli-402.0.0-linux-x86_64.tar.gz \r\ntar -xf google-cloud-cli-402.0.0-linux-x86_64.tar.gz \r\n.\/google-cloud-sdk\/install.sh <\/pre><\/div>\r\n<div><p><span data-contrast=\"none\">4. Open a new terminal so that the changes take effect.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>.\/google-cloud-sdk\/bin\/gcloud init \r\ngcloud components update &amp;&amp; \r\ngcloud components install beta \r\ngcloud auth login <\/pre><\/div>\r\n<div><p><span data-contrast=\"none\">For other platforms, use this: <\/span><a href=\"https:\/\/cloud.google.com\/sdk\/docs\/install\" target=\"_blank\"><span data-contrast=\"none\">official documentation<\/span><\/a><span data-contrast=\"none\">.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">5. Install Python SDK:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>pip3 install --upgrade google-cloud-aiplatform google-cloud-storage jsonlines -q <\/pre><\/div>\r\n<div><p><span data-contrast=\"none\">You will also need to authorize Docker to upload our images.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">1. <\/span><a href=\"https:\/\/console.cloud.google.com\/flows\/enableapi?apiid=containerregistry.googleapis.com&amp;redirect=https%3A%2F%2Fcloud.google.com%2Fcontainer-registry%2Fdocs%2Fquickstart&amp;_ga=2.170545632.173902850.1663164267-1097805963.1661340542\" target=\"_blank\"><span data-contrast=\"none\">Enable<\/span><\/a><span data-contrast=\"none\"> the Container Registry API.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">2. Open the terminal and run:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>gcloud auth configure-docker <\/pre><p><a href=\"https:\/\/console.cloud.google.com\/storage\/create-bucket\" target=\"_blank\"><span data-contrast=\"none\">Let’s create a bucket<\/span><\/a><span data-contrast=\"none\"> in Cloud Storage for storing datasets and training artifacts. It is better to create a name using the <\/span><i>projectname-bucketname<\/i> <span data-contrast=\"none\">approach. For example, in the <\/span><i>gems-ai-ml<\/i><span data-contrast=\"none\"> project, we will create a new bucket <\/span><i>gems-ai-ml-vertex-bucket<\/i><span data-contrast=\"none\">. We will use the <\/span><i>us-central1<\/i><span data-contrast=\"none\"> region in all cases.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p><\/p><\/div>\r\n\r\n<\/div>\r\n\r\n\r\n<\/div>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n   Adding datasets \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div>\r\n    <div><div><div><p><span data-contrast=\"none\">For initial tests, you can add a dataset manually via the Cloud Storage interface or via the Python SDK.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">Consider adding datasets via Cloud Storage:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">1. Open a <\/span><a href=\"https:\/\/console.cloud.google.com\/storage\/browser\" target=\"_blank\"><span data-contrast=\"none\">page with the created Buckets<\/span><\/a><span data-contrast=\"none\">.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">2. Select the necessary Bucket.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p><span data-contrast=\"none\">3. Upload a file with a dataset.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div>\r\n\r\n<div><div><div><div><p><span data-contrast=\"none\">Also consider downloading using the Python SDK:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>from google.cloud import storage \r\nstorage_client = storage.Client() \r\nbucket = storage_client.bucket(bucket_name) # e.g. bucket_name = “gems-ai-ml-vertex-bucket” \r\nblob = bucket.blob(f\"{bucket_name}\/{output_filename}\")  # e.g. output_filename = “dataset.csv” \r\nblob.upload_from_filename(local_path_to _dataset) <\/pre><\/div>\r\n<div><p><span data-contrast=\"none\">In order not to manually download data every time anew, we should create a script that takes data from the necessary source using the code from the example in the Python SDK, and then puts it in the Storage Bucket.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">You can also create a Dataset entity in Vertex AI on the <\/span><a href=\"https:\/\/console.cloud.google.com\/vertex-ai\/datasets\" target=\"_blank\"><span data-contrast=\"none\">Datasets<\/span><\/a><span data-contrast=\"none\"> tab. This entity is necessary to train the AutoML model, but since we will use custom training, creating a Dataset is not required.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div><\/div>\r\n<\/div><\/div>\r\n\r\n\r\n<\/div>\r\n<div>\r\n    <p>\r\n        <span data-contrast=\"auto\"><span data-ccp-parastyle=\"Normal (Web)\"><\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"134245417\":false,\"201341983\":0,\"335559738\":0,\"335559739\":0,\"335559740\":276}\"=\"\">&nbsp;<\/span>\r\n    <\/p>\r\n<\/div>\r\n<h2 class=\"text-24 unscaled\">\r\n   Custom training  \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div><div><p><span data-contrast=\"none\">Custom training will be performed inside the Docker container. To do this, you must first prepare the training code of the model. Here are the features of the code for learning in Vertex AI:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">1. Get command line arguments for training configuration:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>def get_args(): \r\n    parser = argparse.ArgumentParser() \r\n    parser.add_argument( \r\n        '--model-name', \r\n        default=\"gpt_linear_full\", \r\n        help='The name of your saved model') \r\n    parser.add_argument( \r\n        '--model_dir', \r\n        help='Directory to output model and artifacts', \r\n        type=str, \r\n    parser.add_argument('--data-uri', type=str,   default='bert_main_dataset_11k_news.csv', help=\"Dataset path or gcp uri\") \r\n    parser.add_argument(\"--mode\", default='stocks_news', type=str, help=\"train or stocks_news.\") \r\n    parser.add_argument(\"--num-epochs\", default=N_EPOCHS, type=int, help=\"num epochs\") \r\n    parser.add_argument(\"--batch\", default=BATCHSIZE, type=int, help=\"batch size\") \r\n    return parser.parse_args() <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">2. If the <\/span><i>— data-uri<\/i><span data-contrast=\"none\"> parameter is a link to a file in a bucket, you need to download it:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>filename = args.data_uri \r\nif 'gs:\/\/' in filename: \r\n      new_filename = 'gs_file.csv' \r\n      scheme, bucket_name, path, file = process_gcs_uri(args.model_dir) \r\n      file_path = filename.split('\/\/')[1].split('\/', maxsplit=1)[1] \r\n      from google.cloud import storage \r\n      storage_client = storage.Client() \r\n      bucket = storage_client.get_bucket(bucket_name) \r\n      blob = bucket.blob(path) \r\n      blob.download_to_filename(new_filename) \r\n      filename = new_filename <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">3. Gcs uri parsing code:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>def process_gcs_uri(uri: str) -&gt; (str, str, str, str):    ''' \r\n    Receives a Google Cloud Storage (GCS) uri and breaks it down to the scheme, bucket, path and file        Parameters: \r\n                uri (str): GCS uri        Returns: \r\n                scheme (str): uri scheme \r\n                bucket (str): uri bucket \r\n                path (str): uri path \r\n                file (str): uri file    ''' \r\n    url_arr = uri.split(\"\/\") \r\n    if \".\" not in url_arr[-1]: \r\n        file = \"\" \r\n    else: \r\n        file = url_arr.pop() \r\n    scheme = url_arr[0] \r\n    bucket = url_arr[2] \r\n    path = \"\/\".join(url_arr[3:]) \r\n    path = path[:-1] if path.endswith(\"\/\") else path \r\n    return scheme, bucket, path, file <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">4. To log learning results in tensorboard, you need to set the path from the environment variable<\/span><i> ‘AIP_TENSORBOARD_LOG_DIR’<\/i><span data-contrast=\"none\">:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>tensorboard_callback = tf.keras.callbacks.TensorBoard( log_dir=os.environ['AIP_TENSORBOARD_LOG_DIR'],histogram_freq=1) <\/pre><\/div>\r\n<div><p><span data-contrast=\"none\">or<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>from torch.utils.tensorboard import SummaryWriter \r\nwriter = SummaryWriter(os.environ['AIP_TENSORBOARD_LOG_DIR']) <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">5. Upload the model files to Cloud Storage by a tensorflow model example:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>tf_model.save_weights(\"best_model.h5\") \r\nscheme, bucket, path, file = process_gcs_uri(args.model_dir) \r\nstorage_client = storage.Client() \r\nbucket = storage_client.bucket(bucket) \r\nblob = bucket.blob(f\"{path}\/{args.model_name}.h5\") \r\nblob.upload_from_filename('best_model.h5') <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">6. As a result, we have the following training code:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>def main(): \r\n  # parse args \r\n  args = get_args() \r\n  # download dataset \r\n  filename = args.data_uri \r\n  if 'gs:\/\/' in filename: \r\n       new_filename = 'gs_file.csv' \r\n      scheme, bucket_name, path, file = process_gcs_uri(args.model_dir) \r\n      file_path = filename.split('\/\/')[1].split('\/', maxsplit=1)[1] \r\n      from google.cloud import storage \r\n      storage_client = storage.Client() \r\n      bucket = storage_client.get_bucket(bucket_name) \r\n      blob = bucket.blob(path) \r\n      blob.download_to_filename(new_filename) \r\n      filename = new_filename \r\n  N_EPOCHS = args.num_epochs \r\n  BATCHSIZE = args.batch \r\n  # train model \r\n  model = train_bert_sentiment(data_path=filename) \r\n  # save model \r\n  save_model(best_model, args.model_dir, args.model_name) <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">The model training code now needs to be packed into a Docker container. To do this, let’s create a Dockerfile. As a base image, we use a ready-made image from the <\/span><a href=\"https:\/\/cloud.google.com\/vertex-ai\/docs\/training\/pre-built-containers\" target=\"_blank\"><span data-contrast=\"none\">Google Cloud list<\/span><\/a><span data-contrast=\"none\"> containing the desired version of the framework and other necessary dependencies:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>FROM us-docker.pkg.dev\/vertex-ai\/training\/pytorch-gpu.1-9:latest \r\nWORKDIR \/component \r\nRUN pip install transformers==3.0.2 tqdm \r\nCOPY gpt_model.py . \r\nCOPY transformers_utils.py . \r\nENTRYPOINT [\"python\", \"gpt_model.py\"] <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">It is important to set the ENTRYPOINT in the format exactly as in the example, as this will allow you to set arguments for training.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">Now let’s assemble the container with a tag in the format gcr.io\/project_name\/image_name:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>docker build -f Dockerfile_train_text_model -t gcr.io\/gems-ai-ml\/pytorch_gpu_train_text . <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">Then send the container to the <\/span><a href=\"https:\/\/console.cloud.google.com\/gcr?project=gems-ai-ml\" target=\"_blank\"><span data-contrast=\"none\">Container Registry<\/span><\/a><span data-contrast=\"none\">:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>docker push gcr.io\/gems-ai-ml\/pytorch_gpu_train_text <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">You can now train the model in Vertex AI. To do this, go to the <\/span><a href=\"https:\/\/console.cloud.google.com\/vertex-ai\/training\/training-pipelines\" target=\"_blank\"><span data-contrast=\"none\">Training<\/span><\/a><span data-contrast=\"none\"> tab and create a new custom job using the Create button.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n\r\n\r\n<p><span data-contrast=\"none\">Next, we set the name of the model.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<p><span data-contrast=\"none\">Select a custom container and specify the previously downloaded image. We also need to define the training parameters.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<p><span data-contrast=\"none\">Next, specify the Compute settings to run the container. (There are no GPU quotas for custom training by default, so you may need to write to a support team to increase quotas.)<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<p><span data-contrast=\"none\">Click Start training. Once training is complete, we see the Training pipeline with the Finished status.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p>\r\n<p><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\"><span data-contrast=\"none\">You can view the details of the created pipeline by clicking its name. There you’ll find information about the training execution time, training arguments and machine parameters. You can also view logs and graphs for CPU and GPU utilization:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/span><\/p>\r\n<div><p><span data-contrast=\"none\">To view a Vertex AI TensorBoard associated with a training job:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><div><ol class=\"text-18 unscaled\"><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\">In the Vertex AI section of the Google Cloud console, navigate to the Training page<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\">Select the Custom Jobs tab<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\">To view the Training Detail page, select the training job<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><span data-contrast=\"none\">At the top of the page, click the Open TensorBoard button<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ol><\/div><\/div>\r\n<div><p><span data-contrast=\"none\">You can also create a Custom Job using the Python SDK:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>from google.cloud import aiplatform \r\nPROJECT_ID='gems-ai-ml' \r\nBUCKET_NAME='gems-ai-ml-vertex' \r\nAPP_NAME=’gpt’aiplatform.init(project=PROJECT_ID, staging_bucket=BUCKET_NAME)# define variable names \r\nCUSTOM_TRAIN_IMAGE_URI = f\"gcr.io\/{PROJECT_ID}\/pytorch_gpu_train_text\" \r\nTIMESTAMP = datetime.now().strftime(\"%Y%m%d%H%M%S\") \r\nJOB_NAME = f\"{APP_NAME}-text-model\"# configure the job with container image spec \r\njob = aiplatform.CustomContainerTrainingJob( \r\n    display_name=f\"{JOB_NAME}\",  \r\n    container_uri=f {CUSTOM_TRAIN_IMAGE_URI}\" \r\n)# define training code arguments \r\ntraining_args = [\"--model-name=gpt-news-classifier\", \"--batch=54\", \r\n                 \"--data-uri=gs:\/\/gems-ai-ml- vertex\/datasets\/bert_main_dataset_11k_news.csv\", \r\n                 \"--model_dir=gs:\/\/gems-ai-ml-vertex\/models\"]# submit the Custom Job to Vertex Training service \r\nmodel = job.run( \r\n    replica_count=1, \r\n    machine_type=\"n1-standard-8\", \r\n    accelerator_type=\"NVIDIA_TESLA_T4\", \r\n    accelerator_count=1, \r\n    args=training_args, \r\n    sync=False) <\/pre><\/div>\r\n<div><p><span data-contrast=\"none\">As a result of training, we have a Tensorboard log and the model weights by the path specified in Cloud Storage. Custom Training made it possible to flexibly create a model training code, as well as take advantage of creating a Compute Engine with the required number of GPUs.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<p>&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n   Deploy model    \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div><div><div><p><span data-contrast=\"none\">To deploy the model, you need to prepare the request processing code. You can use TorchServe as recommended in the Google <\/span><a href=\"https:\/\/cloud.google.com\/blog\/topics\/developers-practitioners\/pytorch-google-cloud-how-deploy-pytorch-models-vertex-ai\" target=\"_blank\"><span data-contrast=\"none\">documentation<\/span><\/a><span data-contrast=\"none\">, but for simplicity and versatility, consider a flask application:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>import argparse \r\nimport traceback \r\nimport torch \r\nimport numpy as np \r\nfrom flask import Response, request, jsonify, Flask \r\nfrom flask_cors import CORS \r\nfrom transformers import GPT2Model, GPT2Tokenizerapp = Flask(__name__) \r\nCORS(app)def load_model(model_path): \r\n  if 'gs:\/\/' in model_path: \r\n     new_filename = 'text_model.pth' \r\n     bucket_name = model_path.split('\/\/')[1].split('\/')[0] \r\n     file_path = model_path.split('\/\/')[1].split('\/', maxsplit=1)[1] \r\n     from google.cloud import storage     storage_client = storage.Client(bucket_name) \r\n     bucket = storage_client.get_bucket(bucket_name) \r\n     blob = bucket.blob(file_path) \r\n     blob.download_to_filename(new_filename) \r\n     # download \r\n     model_path = new_filename \r\n  gpt = GPT2Model.from_pretrained('gpt2') \r\n  model = GPT2LinearSentiment(gpt) \r\n  model.load_state_dict(torch.load(model_path)) \r\n  return model@app.route(\"\/isalive\") \r\ndef is_alive(): \r\n  status_code = Response(status=200) \r\n  return status_code@app.route(\"\/predict\", methods=[\"POST\"]) \r\ndef predict(): \r\n  global model \r\n  req_json = request.get_json() \r\n  news = req_json['instances'][\"news\"] \r\n  preds = gpt_compute_sentiment(news, model =model) \r\n  return jsonify({ \r\n        \"predictions\": preds.tolist()def get_args(): \r\n  parser = argparse.ArgumentParser() \r\n  parser.add_argument( \r\n        '--model-path', \r\n        default=\"text_model.pth\", \r\n        help='The name of your saved model') \r\n  return parser.parse_args()if __name__ == \"__main__\": \r\n  args = get_args() \r\n  model_path = args.model_path \r\n  app.run(debug=True, host=\"0.0.0.0\", port=8080) <\/pre><\/div>\r\n\r\n<div><div><p><span data-contrast=\"none\">In the code above, some points are omitted for brevity, but the most important details are preserved:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ol class=\"text-18 unscaled\"><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\">Creating a flask application and adding CORS to avoid errors; No ‘Access-Control-Allow-Origin’.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\">The loading code can be load_model’ed from Cloud Storage.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\"><\/span><span data-contrast=\"none\">Two mandatory routes: “\/isalive” (ping that the server is running) and “\/predict” (directly processing users’ request).<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\"><\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><span data-contrast=\"none\">Getting get_args command line arguments. The path to the weights of the model will be obtained through the command line parameters.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"5\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"5\" data-aria-level=\"1\"><span data-contrast=\"none\">Launching the app with the host address and port.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ol><\/div><\/div>\r\n<div><div><p><span data-contrast=\"none\">Now the model deployment code needs to be packed into a Docker container. To do this, let’s create a Dockerfile:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><pre>FROM us-docker.pkg.dev\/vertex-ai\/training\/pytorch-gpu.1-9:latest \r\nWORKDIR \/component \r\nRUN pip install transformers==3.0.2 tqdm flask flask-corsCOPY gpt_model.py . \r\nCOPY transformers_utils.py . \r\nCOPY deploy_text_model.py .EXPOSE 8080 \r\nENTRYPOINT [\"python\", \"deploy_text_model.py\"] <\/pre><\/div><\/div>\r\n<div><p><span data-contrast=\"none\">Build a Docker image and upload it to the Container Registry.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">On the Model Registry tab, import our model.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p><span data-contrast=\"none\">We set the name and select the region.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p><span data-contrast=\"none\">Select the container with the model and set the arguments.<\/span><\/p><p><span data-contrast=\"none\">Specify the routes and port inside the container, and click import.<\/span><\/p><p><span data-contrast=\"none\">Now we will create an Endpoint on the appropriate <\/span><a href=\"https:\/\/console.cloud.google.com\/vertex-ai\/endpoints\" target=\"_blank\"><span data-contrast=\"none\">tab<\/span><\/a><span data-contrast=\"none\"> to test the added model.<\/span><\/p><p><span data-contrast=\"none\">Select the model created earlier and specify the Compute settings.<\/span><\/p><p><span data-contrast=\"none\">Also turn on monitoring and click Create.<\/span><\/p><div><p><span data-contrast=\"none\">After deploying the model to Endpoint, we will check its operability using Python SDK:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><pre>from typing import Dict, List, Union \r\nfrom google.cloud import aiplatform \r\nfrom google.protobuf import json_format \r\nfrom google.protobuf.struct_pb2 import Valuedef predict_custom_trained_model_sample( \r\n    project: str, \r\n    endpoint_id: str, \r\n    instances: Union[Dict, List[Dict]], \r\n    location: str = \"us-central1\", \r\n    api_endpoint: str = \"us-central1-aiplatform.googleapis.com\", \r\n):    \"\"\" \r\n    `instances` can be either single instance of type dict or a list of instances.    \"\"\" \r\n    # The AI Platform services require regional API endpoints. \r\nclient_options = {\"api_endpoint\": api_endpoint}    # Initialize client that will be used to create and send requests. \r\n    # This client only needs to be created once, and can be reused for multiple requests.    client = aiplatform.gapic.PredictionServiceClient(client_options=client_options)    # The format of each instance should conform to the deployed model's prediction input schema.    instances = instances if type(instances) == list else [instances] \r\n    instances = [ \r\n        json_format.ParseDict(instance_dict, Value()) for instance_dict in instances \r\n    ] \r\n    parameters_dict = {} \r\n    parameters = json_format.ParseDict(parameters_dict, Value()) \r\n    endpoint = client.endpoint_path( \r\n        project=project, location=location, endpoint=endpoint_id \r\n    ) \r\n    response = client.predict( \r\n    endpoint=endpoint, instances=instances, parameters=parameters \r\n    ) \r\n    print(\"response\") \r\n    print(\" deployed_model_id:\", response.deployed_model_id)    # The predictions are a google.protobuf.Value representation of the model's predictions.    predictions = response.predictions \r\n    for prediction in predictions: \r\n        print(\" prediction:\", dict(prediction))predict_custom_trained_model_sample( \r\n    project=\"38068****5047\", \r\n    endpoint_id=\"662337******5424128\", \r\n    location=\"us-central1\", \r\n    instances={\"news\": \"test news, sell all your stuff\"} \r\n) <\/pre><\/div>\r\n\r\n<div><p><span data-contrast=\"none\">Finally, we have successfully deployed our model. You can monitor the workload of the Endpoint and Vertex AI will dynamically increase the number of Endpoints when the load increases.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div><\/div>\r\n\r\n\r\n\r\n<\/div>\r\n<p>&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n Conclusion     \r\n<\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><div><p><span data-contrast=\"none\">In this article, we have talked about the key points of custom learning in Vertex AI. This platform contains all the necessary components for MLOps. It is also worth paying attention to AutoML which allows you to obtain a machine learning model without specific deep knowledge.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">We also need to mention that at the operation stage there were also disadvantages, mainly related to versioning. You can create a dataset entity only if your file matches the desired schema, otherwise you must store it in cloud storage. Custom models are stored as a container, which makes it a bit difficult to add a new version for them.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div>\r\n<p>&nbsp;&nbsp;<\/p>\r\n<section class=\"cta-banner-section\"><div class=\"row\"><div class=\"col-12 col-md-6\"><div class=\"cta-banner-section__content\"><div class=\"tag\"><p class=\"text-14 unscaled\">Advanced Analytics<\/p><\/div><a href=\"https:\/\/www.fintego.com\/insights\/financial-services\/advanced-analytics\" class=\"stretched-link\"><p class=\"cta-banner-text text-22 unscaled\">Discover more insights to help you unlock the value of your data \r\n\r\n<\/p><\/a><div class=\"btn btn-text btn-icon focus\"><div class=\"text-container\"><div class=\"text\">Read more<\/div><div class=\"arr-offering\"><i class=\"arr-small one\"><\/i><i class=\"arr-small two\"><\/i><i class=\"arr-small three\"><\/i><\/div><\/div><\/div><\/div><\/div><div class=\"col-12 col-md-6 d-none d-md-block\"><div class=\"cta-banner-section__image\"><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/cta-banners\/Advanced-analytics.jpg\" alt=\"cta banner\"><\/figure><\/div><\/div><\/div><\/section>\r\n<p>\r\n    &nbsp;\r\n<\/p>","image":{"@type":"ImageObject","url":"https:\/\/www.fintego.com\/files\/blog\/2023\/08\/431955-CIS-CIS-blog-page-2-Blog-banner-960x960px-2023-07-27.jpg","width":960,"height":960},"publisher":{"@type":"Organization","url":"https:\/\/www.fintego.com\/","name":"Luxoft","logo":{"@type":"ImageObject","url":"https:\/\/www.fintego.com\/theme\/luxoft\/assets\/images\/logo\/fintego-new-white.svg","width":"188","height":"50"}},"author":[{"@type":"Person","name":"Arthur Shaikhatarov","image":"https:\/\/www.fintego.com\/files\/people\/2023\/09\/Arthur-Shaikhatarov.jpg","url":"https:\/\/www.linkedin.com\/in\/arthur-shaikhatarov-1b358b211\/","jobTitle":"AI\/ML Project Manager, Automotive, Luxoft"}],"datePublished":"2023-09-13T11:22:03+00:00","dateModified":"2024-07-24T07:29:17+00:00"}</script>
    <section class="blog-post-right-column blog-post-right-column__banner">
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-8 col-lg-7 offset-lg-1">
                <h1>Mastering MLOps practices for a trading bot </h1>
                <p>Sep 13, 2023
                                             by  <b>Arthur Shaikhatarov</b>                                    </p>
            </div>
            <div class="col-12 col-md-4 col-lg-3 pl-70">
                <div class="blog-post-right-column__banner--social">
                    <ul>
                        <li>
                            <a href="#" class="social-share" data-network="linkedin">
                                <img src="/theme/fintego/assets/images/icons/linkedin.svg" alt="linkedin icon">
                            </a>
                        </li>
                        <li>
                            <a href="#" class="social-share" data-network="fb">
                                <img src="/theme/fintego/assets/images/icons/fb-square.svg" alt="facebook icon">
                            </a>
                        </li>
                        <li>
                            <a href="#" class="social-share" data-network="twitter">
                                <img src="/theme/fintego/assets/images/logo-tw.svg" alt="twitter icon">
                            </a>
                        </li>
                                            </ul>
                </div>
            </div>
        </div>
    </div>
</section>
    <div class="container blog-post-right-column blog-post-right-column__content" id="main-content">
      <div class="row">
        <div class="col-12 col-md-8 col-lg-7 offset-lg-1 text-content">
        <p><section class="container-breadcrumbs--light"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="/"><span>Home</span></a></li><li class="breadcrumb-item"><a href="/blog"><span>Blog</span></a></li><li class="breadcrumb-item active"><span>Mastering MLOps practices for a trading bot </span></li></ol></section></p>
<p>
    &nbsp;
</p>
<section class="blog-in-brief">
<p class="blog-in-brief__heading text-20 unscaled">
    In brief
</p>
<ul class="text-18 default-ul unscaled"><li><b></b><b></b><b></b><span data-contrast="auto">Machine learning operations (MLOps) is a core part of machine learning engineering, helping to streamline the way that machine learning models are taken to production, maintained and monitored</span><span data-ccp-props="{" 201341983":0,"335559740":276}"=""></span><span data-contrast="auto"></span><span data-ccp-props="{" 201341983":0,"335559740":276}"="">&nbsp;</span><span data-ccp-props="{" 201341983":0,"335559740":276}"=""></span></li>
    <li><b></b><b></b><b></b><span data-contrast="auto">Applying these practices increases the quality, simplifies the management process, and automates the deployment of machine learning models in large-scale production environments</span><span data-ccp-props="{" 201341983":0,"335559740":276}"=""></span></li><li><b></b><b></b>This article describes the way we introduced MLOps to a trading bot development project and how this helped to control the models<span data-ccp-props="{" 201341983":0,"335559740":276}"=""></span></li>
</ul>
</section>
<p>
    &nbsp;&nbsp;
</p>
<div><div><div><p><span data-contrast="none">As your team grows, the processes become more complex. In this article, we will talk about the interaction of a large system of neural networks for a trading bot project and the MLOps system, you might start thinking about MLOps technologies and how they can help increase control over development. If talking about our team, at some point we began to feel that we were lacking MLOps practices, so we decided to explore new tools and options.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">To master these, we chose one of our projects — a trading bot with several types of models, some of these models have various versions. Without MLOps, controlling the models might be a challenging task, so this project is of high priority for us.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">In this article, we will describe how we translated our trading bot to the Vertex AI platform from Google.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div>
</div>
<p>&nbsp; &nbsp;</p>
<h2 class="text-24 unscaled">
    About the project   
</h2>
<p>
    &nbsp;
</p>
<div>
    <div><p><span data-contrast="none">Most algorithms for analyzing stock price behavior are based only on the historical price, but it is also important to consider the impact of company news. Therefore, our main idea was to create a system that could predict the price not only according to a schedule, but also according to text news.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">The main idea of the algorithm was to combine the company news, the stock price and technical analysis. This requires 3 machine learning models:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><div><ol class="text-18 unscaled"><li data-leveltext="%1." data-font="Calibri" data-listid="8" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">Language model — it evaluates the news. This estimate is the model’s confidence that the price will rise by a certain threshold.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-aria-level="1" data-aria-posinset="1" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-listid="8" data-font="Calibri" data-leveltext="%1."><span data-contrast="none">The model for time series processing also converts the price chart and technical analysis into confidence.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="8" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">The final classifier takes an average estimate of the news for the current day as input, their number and the confidence of the model for time series.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ol></div>
<div><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-01-1.jpg" id="191415boxizo" data-image="191415boxizo"></figure></div>
</div>
</div>
<div>
<p>&nbsp;</p><p><span data-contrast="none">Thus, we have a system that gives predictions both on the text and the price chart.</span></p><p>&nbsp;</p>
</div>
<h2 class="text-24 unscaled">
    Language model 
</h2>
<p>
    &nbsp;
</p>
<div>
    <div><p><span data-contrast="none">As the foundation of the language model, we chose the GPT-2 transformer. This model was introduced by OpenAI in early 2019. The model was previously trained on a WebText dataset consisting of 45 million links to websites.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">GPT-2 converts the text at the input into a special matrix that contains a contextual representation of words. Next, this matrix is transformed using a single linear layer into a binary classification.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">The resulting language model is universal for all companies.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
</div>
<p>&nbsp;&nbsp;</p>
<h2 class="text-24 unscaled">Price model  </h2>
<p>&nbsp;</p>
<div><p><span data-contrast="none">Recurrent networks are best suited as the basic network architecture for working with stock prices. The main advantage of recurrent networks is the ability to remember long-term dependencies. </span><span data-contrast="auto">There are many implementations of this architecture, but the long short-term memory (LSTM) network is considered one of the best in terms of operational quality</span><span data-contrast="none">. The developed network consists of several LSTM blocks and subsequent data transformation.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">A vector from the historical price and several technical analysis indicators are fed to the input at each moment in time. The output of the last cell is fed into a neural network consisting of four layers. As a result, we have three numbers corresponding to the confidence of the model to buy, hold or sell the stock.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p></div>
<h2 class="text-24 unscaled">Final classifier   </h2>
<p>&nbsp;</p>
<p><span data-contrast="none">As the final classifier, we use a random forest. This model belongs to the algorithms of classical machine learning and consists of several decision trees that determine, by majority vote, whether the price will rise.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<p>&nbsp;</p>
<h2 class="text-24 unscaled">Testing    </h2>
<p>&nbsp;</p>
<div><p><span data-contrast="none">To test the algorithm, we decided to implement a trading strategy for it. To do this, we compiled a portfolio of several shares and selected the maximum fraction of one share when buying. After that, we performed back-testing, that is, the launch of a trading strategy based on historical data.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">The following table shows the test results. The graph shows the account balance over time.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure class="align-center"><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-02-v2.jpg" id="r8lgqhdcyq0i" data-image="r8lgqhdcyq0i"></figure><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-03.jpg" id="0tl8dcpv0xch" data-image="0tl8dcpv0xch"></figure><p>&nbsp;</p><div><p><span data-contrast="none">As a result of testing the trading strategy, we obtained positive results (most of the transactions are positive, the drawdown is less than 1%, the average profit of the transaction is 1.8%).</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">We were rather pleased with the results thus far. We do, however, need to dive a little deeper into the world of MLOps to demonstrate how this was able to help us and how Vertex AI is ready for ML.&nbsp;</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p></div></div>
<h2 class="text-24 unscaled">MLOps    </h2>
<p>&nbsp;</p>
<p><i>MLOps</i><span data-contrast="none"> is an ML engineering culture and practice that aims at unifying ML system development (Dev) and ML system operation (Ops). Practicing MLOps means that you advocate for automation and monitoring at all steps of ML system construction, including integration, testing, releasing, deployment and infrastructure management.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<p>&nbsp;</p>
<figure><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-04-1.jpg" id="u9vwk7h06ije" data-image="u9vwk7h06ije"></figure>
<p>&nbsp;</p>
<div><p><span data-contrast="none">Below is a classic diagram from a </span><a href="https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning#ml_pipeline_triggers" target="_blank"><span data-contrast="none">Google article</span></a><span data-contrast="none"> which shows that only a small part of the real ML system is contained in the ML code. The necessary elements surrounding it are extensive and complex.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">On this diagram, the rest of the system consists of configurations, automations, data collection, verification, testing, debugging, resource management, model analysis, metadata management, model serving and monitoring.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-05.jpg" id="6tpkp2upxrpj" data-image="6tpkp2upxrpj"></figure><p>&nbsp;</p><p><span data-contrast="none">The automation level of these processes determines the maturity level of your ML project, which reflects the speed of models learning on new data, or the speed of learning taking into account other implementations. Next, we will describe two levels of MLOps, starting with the most common one — which does not require automation, and then we will switch to the full automation of ML and CI/CD pipelines.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p></div>
<h2 class="text-24 unscaled">MLOps level 0: Manual process    </h2>
<p>&nbsp;</p>
<figure><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-06.jpg" id="jk050s5ab5us" data-image="jk050s5ab5us"></figure>
<p>&nbsp;</p>
<div><p><span data-contrast="none">The following list of characteristics reflects the MLOps level 0 setup:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><div><div><div><div><ul class="default-ul"><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Manual, scripted interactive process</b><span data-contrast="none">.</span><span data-contrast="none"> </span><span data-contrast="none">Each of the standard steps is performed manually; manual code execution, and manual data exchange between the steps are required</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Disconnect between ML and operations</b>.<span data-contrast="none"> </span><span data-contrast="none">The process divides data scientists who develop models and the engineers serving them. DS passes the model in the form of an artifact to the team of engineers</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="2" data-aria-level="1"><b>Infrequent release iterations</b>.<span data-contrast="none"> </span><span data-contrast="none">The process assumes that the data scientist team manages a certain number of models, while the frequency of their updates is not very clear</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="3" data-aria-level="1"><b>No CI</b><span data-contrast="none">. Since there are supposed to be some changes in the implementation, CI is ignored. Usually, code testing runs using laptops or some scripts</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="4" data-aria-level="1"><b>No CD</b><span data-contrast="none">. Since there is no versioned deployment of models, CD is ignored</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="5" data-aria-level="1"><b>Deployment refers to a prediction service</b><span data-contrast="none">. This process only concerns the deployment of a trained model as a “prediction service”, it can be a microservice with a REST API, for example, and not an ML system deployment</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="5" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Lack of active performance monitoring</b><span data-contrast="none">. The process does not analyze the model operation, which is required to track model degradation</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div>
</div></div>
</div>
<p>&nbsp;</p>
<h2 class="text-24 unscaled">
    MLOps Level 1  
</h2>
<p>&nbsp;</p>
<figure><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-07.jpg" id="q0e1x2injzc1" data-image="q0e1x2injzc1"></figure>
<p>&nbsp;</p>
<p>
    &nbsp;&nbsp;
</p>
<p dir="ltr"><span data-contrast="none">The following list highlights characteristics of the Level 1 setup:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<div><div><div><div><ul class="default-ul"><li data-leveltext="" data-font="Symbol" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Quick experiments</b><span data-contrast="none">. The steps of the ML experiment process are consistent. Transitions between steps are automated</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="2" data-aria-level="1"><b>Model CT to production</b><span data-contrast="none">. The model is automatically trained in the production environment using up-to-date data and pipeline triggers</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="3" data-aria-level="1"><b>Experimental-operational symmetry</b><span data-contrast="none">. This is a pipeline implementation that is used in the development or experimental environment and in the preparation and production environment, which is a key aspect of MLOps practice for the unification of DevOps</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="4" data-aria-level="1"><b>Modular code for components and pipelines</b><span data-contrast="none">.</span><span data-contrast="none"> </span><span data-contrast="none">To build ML pipelines, components must be reusable, composable and potentially shared in ML pipelines. In addition, ideally, components should be placed in containers to perform the following tasks:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div><div><ul class="default-ul align-left"><li data-leveltext="o" data-font="Courier New" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":1440,"335559991":360,"469769226":"courier="" new","469769242":[9675],"469777803":"left","469777804":"o","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="2"><span data-contrast="none">Decouple the execution environment from the custom code runtime</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="o" data-font="Courier New" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":1440,"335559991":360,"469769226":"courier="" new","469769242":[9675],"469777803":"left","469777804":"o","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="2"><span data-contrast="none">Make code reproducible between development and production environments</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="o" data-font="Courier New" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":1440,"335559991":360,"469769226":"courier="" new","469769242":[9675],"469777803":"left","469777804":"o","469777815":"hybridmultilevel"}"="" data-aria-posinset="2" data-aria-level="2"><span data-contrast="none">Isolate each component in the pipeline. Components can have their own version of the runtime environment and have different languages and libraries</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div>
<div><div><ul class="default-ul"><li data-leveltext="" data-font="Symbol" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Apply models CD</b><span data-contrast="none">. The ML pipeline is continuously delivered to the production inference server and trained on new data. This is a deployment step when the validated models move to the step of serving models and creating inference services</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="6" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"hybridmultilevel"}"="" data-aria-posinset="2" data-aria-level="1"><b>Pipeline deployment</b><span data-contrast="none">. At level 0, you have deployed the model as an inference server. Level 1 implies the deployment of the entire training pipeline, which is automatically and recursively run, while serving trained and validated models as a prediction service</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div></div></div>
<p><b>&nbsp;&nbsp;</b></p>
<h2 class="text-24 unscaled">
    Vertex AI  
</h2>
<p>&nbsp;</p>
<p><span data-contrast="none">The main feature of the new platform is its scale and integration with Google Cloud. Vertex AI has all Google cloud tools incorporated for preparing datasets and training ML models.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<p>&nbsp;</p>
<figure class="align-center"><img src="/files/blog-posts/2023/Mastering-MLOps-practices-for-a-trading-bot/433537-HO-GEMS-blog-1-chart-08.jpg" id="hpequntzrnf8" data-image="hpequntzrnf8"></figure>
<p>&nbsp;</p>
<div><p><span data-contrast="none">According to Google developers, teams will be able to completely transfer all ML processes to Vertex AI: Data engineers search for data in Google BigQuery, annotators mark-up data using built-in tools, data scientists configure learning algorithms in AutoML and automatically select optimal hyperparameters. A trained and tested ML model can be connected to a working application in a couple of clicks — either uploaded to a specially prepared server in Google Cloud or exported to one of the popular formats.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">Despite the comprehensiveness of the platform, developers have provided with the possibility to replace any part of it with their own solutions. Support of Docker containers allows the writing code in any programming language and use of any libraries. Client bindings for Python, Java and Node.js are officially supported. Containers are not limited to anything in particular, they have access to the Internet and Google Storage, which allows the downloading of any data necessary for training the model. A similar mechanism also works for the code of the ML model itself, which can be created using an arbitrary technology, packed into a container and loaded onto Vertex AI.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<p>&nbsp;&nbsp;</p>
<h2 class="text-24 unscaled">
    Initial setup  
</h2>
<p>
    &nbsp;
</p>
<div>
    <div><div><p><span data-contrast="none">1. In the Google Cloud console, on the project selector page, select or </span><a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects" target="_blank"><span data-contrast="none">create a Google Cloud project</span></a><span data-contrast="none">. Make sure that billing is enabled for your Cloud project.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">2. </span><a href="https://console.cloud.google.com/flows/enableapi?apiid=aiplatform.googleapis.com&amp;_ga=2.262763340.173902850.1663164267-1097805963.1661340542" target="_blank"><span data-contrast="none">Enable</span></a><span data-contrast="none"> the Vertex AI API.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">3. Install the gcloud CLI. For Linux, run the following commands:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-402.0.0-linux-x86_64.tar.gz 
tar -xf google-cloud-cli-402.0.0-linux-x86_64.tar.gz 
./google-cloud-sdk/install.sh </pre></div>
<div><p><span data-contrast="none">4. Open a new terminal so that the changes take effect.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>./google-cloud-sdk/bin/gcloud init 
gcloud components update &amp;&amp; 
gcloud components install beta 
gcloud auth login </pre></div>
<div><p><span data-contrast="none">For other platforms, use this: </span><a href="https://cloud.google.com/sdk/docs/install" target="_blank"><span data-contrast="none">official documentation</span></a><span data-contrast="none">.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">5. Install Python SDK:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>pip3 install --upgrade google-cloud-aiplatform google-cloud-storage jsonlines -q </pre></div>
<div><p><span data-contrast="none">You will also need to authorize Docker to upload our images.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">1. </span><a href="https://console.cloud.google.com/flows/enableapi?apiid=containerregistry.googleapis.com&amp;redirect=https%3A%2F%2Fcloud.google.com%2Fcontainer-registry%2Fdocs%2Fquickstart&amp;_ga=2.170545632.173902850.1663164267-1097805963.1661340542" target="_blank"><span data-contrast="none">Enable</span></a><span data-contrast="none"> the Container Registry API.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">2. Open the terminal and run:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>gcloud auth configure-docker </pre><p><a href="https://console.cloud.google.com/storage/create-bucket" target="_blank"><span data-contrast="none">Let’s create a bucket</span></a><span data-contrast="none"> in Cloud Storage for storing datasets and training artifacts. It is better to create a name using the </span><i>projectname-bucketname</i> <span data-contrast="none">approach. For example, in the </span><i>gems-ai-ml</i><span data-contrast="none"> project, we will create a new bucket </span><i>gems-ai-ml-vertex-bucket</i><span data-contrast="none">. We will use the </span><i>us-central1</i><span data-contrast="none"> region in all cases.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p></p></div>
</div>
</div>
<p>
    &nbsp;
</p>
<h2 class="text-24 unscaled">
   Adding datasets 
</h2>
<p>
    &nbsp;
</p>
<div>
    <div><div><div><p><span data-contrast="none">For initial tests, you can add a dataset manually via the Cloud Storage interface or via the Python SDK.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">Consider adding datasets via Cloud Storage:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">1. Open a </span><a href="https://console.cloud.google.com/storage/browser" target="_blank"><span data-contrast="none">page with the created Buckets</span></a><span data-contrast="none">.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">2. Select the necessary Bucket.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p><span data-contrast="none">3. Upload a file with a dataset.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div>
<div><div><div><div><p><span data-contrast="none">Also consider downloading using the Python SDK:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>from google.cloud import storage 
storage_client = storage.Client() 
bucket = storage_client.bucket(bucket_name) # e.g. bucket_name = “gems-ai-ml-vertex-bucket” 
blob = bucket.blob(f"{bucket_name}/{output_filename}")  # e.g. output_filename = “dataset.csv” 
blob.upload_from_filename(local_path_to _dataset) </pre></div>
<div><p><span data-contrast="none">In order not to manually download data every time anew, we should create a script that takes data from the necessary source using the code from the example in the Python SDK, and then puts it in the Storage Bucket.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">You can also create a Dataset entity in Vertex AI on the </span><a href="https://console.cloud.google.com/vertex-ai/datasets" target="_blank"><span data-contrast="none">Datasets</span></a><span data-contrast="none"> tab. This entity is necessary to train the AutoML model, but since we will use custom training, creating a Dataset is not required.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div></div>
</div></div>
</div>
<div>
    <p>
        <span data-contrast="auto"><span data-ccp-parastyle="Normal (Web)"></span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"134245417":false,"201341983":0,"335559738":0,"335559739":0,"335559740":276}"="">&nbsp;</span>
    </p>
</div>
<h2 class="text-24 unscaled">
   Custom training  
</h2>
<p>
    &nbsp;
</p>
<div><div><p><span data-contrast="none">Custom training will be performed inside the Docker container. To do this, you must first prepare the training code of the model. Here are the features of the code for learning in Vertex AI:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">1. Get command line arguments for training configuration:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>def get_args(): 
    parser = argparse.ArgumentParser() 
    parser.add_argument( 
        '--model-name', 
        default="gpt_linear_full", 
        help='The name of your saved model') 
    parser.add_argument( 
        '--model_dir', 
        help='Directory to output model and artifacts', 
        type=str, 
    parser.add_argument('--data-uri', type=str,   default='bert_main_dataset_11k_news.csv', help="Dataset path or gcp uri") 
    parser.add_argument("--mode", default='stocks_news', type=str, help="train or stocks_news.") 
    parser.add_argument("--num-epochs", default=N_EPOCHS, type=int, help="num epochs") 
    parser.add_argument("--batch", default=BATCHSIZE, type=int, help="batch size") 
    return parser.parse_args() </pre></div>
<div><p><span data-contrast="none">2. If the </span><i>— data-uri</i><span data-contrast="none"> parameter is a link to a file in a bucket, you need to download it:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>filename = args.data_uri 
if 'gs://' in filename: 
      new_filename = 'gs_file.csv' 
      scheme, bucket_name, path, file = process_gcs_uri(args.model_dir) 
      file_path = filename.split('//')[1].split('/', maxsplit=1)[1] 
      from google.cloud import storage 
      storage_client = storage.Client() 
      bucket = storage_client.get_bucket(bucket_name) 
      blob = bucket.blob(path) 
      blob.download_to_filename(new_filename) 
      filename = new_filename </pre></div>
<div><p><span data-contrast="none">3. Gcs uri parsing code:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>def process_gcs_uri(uri: str) -&gt; (str, str, str, str):    ''' 
    Receives a Google Cloud Storage (GCS) uri and breaks it down to the scheme, bucket, path and file        Parameters: 
                uri (str): GCS uri        Returns: 
                scheme (str): uri scheme 
                bucket (str): uri bucket 
                path (str): uri path 
                file (str): uri file    ''' 
    url_arr = uri.split("/") 
    if "." not in url_arr[-1]: 
        file = "" 
    else: 
        file = url_arr.pop() 
    scheme = url_arr[0] 
    bucket = url_arr[2] 
    path = "/".join(url_arr[3:]) 
    path = path[:-1] if path.endswith("/") else path 
    return scheme, bucket, path, file </pre></div>
<div><p><span data-contrast="none">4. To log learning results in tensorboard, you need to set the path from the environment variable</span><i> ‘AIP_TENSORBOARD_LOG_DIR’</i><span data-contrast="none">:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>tensorboard_callback = tf.keras.callbacks.TensorBoard( log_dir=os.environ['AIP_TENSORBOARD_LOG_DIR'],histogram_freq=1) </pre></div>
<div><p><span data-contrast="none">or</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>from torch.utils.tensorboard import SummaryWriter 
writer = SummaryWriter(os.environ['AIP_TENSORBOARD_LOG_DIR']) </pre></div>
<div><p><span data-contrast="none">5. Upload the model files to Cloud Storage by a tensorflow model example:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>tf_model.save_weights("best_model.h5") 
scheme, bucket, path, file = process_gcs_uri(args.model_dir) 
storage_client = storage.Client() 
bucket = storage_client.bucket(bucket) 
blob = bucket.blob(f"{path}/{args.model_name}.h5") 
blob.upload_from_filename('best_model.h5') </pre></div>
<div><p><span data-contrast="none">6. As a result, we have the following training code:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>def main(): 
  # parse args 
  args = get_args() 
  # download dataset 
  filename = args.data_uri 
  if 'gs://' in filename: 
       new_filename = 'gs_file.csv' 
      scheme, bucket_name, path, file = process_gcs_uri(args.model_dir) 
      file_path = filename.split('//')[1].split('/', maxsplit=1)[1] 
      from google.cloud import storage 
      storage_client = storage.Client() 
      bucket = storage_client.get_bucket(bucket_name) 
      blob = bucket.blob(path) 
      blob.download_to_filename(new_filename) 
      filename = new_filename 
  N_EPOCHS = args.num_epochs 
  BATCHSIZE = args.batch 
  # train model 
  model = train_bert_sentiment(data_path=filename) 
  # save model 
  save_model(best_model, args.model_dir, args.model_name) </pre></div>
<div><p><span data-contrast="none">The model training code now needs to be packed into a Docker container. To do this, let’s create a Dockerfile. As a base image, we use a ready-made image from the </span><a href="https://cloud.google.com/vertex-ai/docs/training/pre-built-containers" target="_blank"><span data-contrast="none">Google Cloud list</span></a><span data-contrast="none"> containing the desired version of the framework and other necessary dependencies:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>FROM us-docker.pkg.dev/vertex-ai/training/pytorch-gpu.1-9:latest 
WORKDIR /component 
RUN pip install transformers==3.0.2 tqdm 
COPY gpt_model.py . 
COPY transformers_utils.py . 
ENTRYPOINT ["python", "gpt_model.py"] </pre></div>
<div><p><span data-contrast="none">It is important to set the ENTRYPOINT in the format exactly as in the example, as this will allow you to set arguments for training.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">Now let’s assemble the container with a tag in the format gcr.io/project_name/image_name:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>docker build -f Dockerfile_train_text_model -t gcr.io/gems-ai-ml/pytorch_gpu_train_text . </pre></div>
<div><p><span data-contrast="none">Then send the container to the </span><a href="https://console.cloud.google.com/gcr?project=gems-ai-ml" target="_blank"><span data-contrast="none">Container Registry</span></a><span data-contrast="none">:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>docker push gcr.io/gems-ai-ml/pytorch_gpu_train_text </pre></div>
<div><p><span data-contrast="none">You can now train the model in Vertex AI. To do this, go to the </span><a href="https://console.cloud.google.com/vertex-ai/training/training-pipelines" target="_blank"><span data-contrast="none">Training</span></a><span data-contrast="none"> tab and create a new custom job using the Create button.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<p><span data-contrast="none">Next, we set the name of the model.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<p><span data-contrast="none">Select a custom container and specify the previously downloaded image. We also need to define the training parameters.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<p><span data-contrast="none">Next, specify the Compute settings to run the container. (There are no GPU quotas for custom training by default, so you may need to write to a support team to increase quotas.)</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<p><span data-contrast="none">Click Start training. Once training is complete, we see the Training pipeline with the Finished status.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p>
<p><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"=""><span data-contrast="none">You can view the details of the created pipeline by clicking its name. There you’ll find information about the training execution time, training arguments and machine parameters. You can also view logs and graphs for CPU and GPU utilization:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></span></p>
<div><p><span data-contrast="none">To view a Vertex AI TensorBoard associated with a training job:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><div><ol class="text-18 unscaled"><li data-leveltext="%1." data-font="Calibri" data-listid="4" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">In the Vertex AI section of the Google Cloud console, navigate to the Training page</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="4" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none">Select the Custom Jobs tab</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="4" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none">To view the Training Detail page, select the training job</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="4" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="4" data-aria-level="1"><span data-contrast="none">At the top of the page, click the Open TensorBoard button</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ol></div></div>
<div><p><span data-contrast="none">You can also create a Custom Job using the Python SDK:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>from google.cloud import aiplatform 
PROJECT_ID='gems-ai-ml' 
BUCKET_NAME='gems-ai-ml-vertex' 
APP_NAME=’gpt’aiplatform.init(project=PROJECT_ID, staging_bucket=BUCKET_NAME)# define variable names 
CUSTOM_TRAIN_IMAGE_URI = f"gcr.io/{PROJECT_ID}/pytorch_gpu_train_text" 
TIMESTAMP = datetime.now().strftime("%Y%m%d%H%M%S") 
JOB_NAME = f"{APP_NAME}-text-model"# configure the job with container image spec 
job = aiplatform.CustomContainerTrainingJob( 
    display_name=f"{JOB_NAME}",  
    container_uri=f {CUSTOM_TRAIN_IMAGE_URI}" 
)# define training code arguments 
training_args = ["--model-name=gpt-news-classifier", "--batch=54", 
                 "--data-uri=gs://gems-ai-ml- vertex/datasets/bert_main_dataset_11k_news.csv", 
                 "--model_dir=gs://gems-ai-ml-vertex/models"]# submit the Custom Job to Vertex Training service 
model = job.run( 
    replica_count=1, 
    machine_type="n1-standard-8", 
    accelerator_type="NVIDIA_TESLA_T4", 
    accelerator_count=1, 
    args=training_args, 
    sync=False) </pre></div>
<div><p><span data-contrast="none">As a result of training, we have a Tensorboard log and the model weights by the path specified in Cloud Storage. Custom Training made it possible to flexibly create a model training code, as well as take advantage of creating a Compute Engine with the required number of GPUs.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<p>&nbsp;</p>
<h2 class="text-24 unscaled">
   Deploy model    
</h2>
<p>
    &nbsp;
</p>
<div><div><div><p><span data-contrast="none">To deploy the model, you need to prepare the request processing code. You can use TorchServe as recommended in the Google </span><a href="https://cloud.google.com/blog/topics/developers-practitioners/pytorch-google-cloud-how-deploy-pytorch-models-vertex-ai" target="_blank"><span data-contrast="none">documentation</span></a><span data-contrast="none">, but for simplicity and versatility, consider a flask application:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>import argparse 
import traceback 
import torch 
import numpy as np 
from flask import Response, request, jsonify, Flask 
from flask_cors import CORS 
from transformers import GPT2Model, GPT2Tokenizerapp = Flask(__name__) 
CORS(app)def load_model(model_path): 
  if 'gs://' in model_path: 
     new_filename = 'text_model.pth' 
     bucket_name = model_path.split('//')[1].split('/')[0] 
     file_path = model_path.split('//')[1].split('/', maxsplit=1)[1] 
     from google.cloud import storage     storage_client = storage.Client(bucket_name) 
     bucket = storage_client.get_bucket(bucket_name) 
     blob = bucket.blob(file_path) 
     blob.download_to_filename(new_filename) 
     # download 
     model_path = new_filename 
  gpt = GPT2Model.from_pretrained('gpt2') 
  model = GPT2LinearSentiment(gpt) 
  model.load_state_dict(torch.load(model_path)) 
  return model@app.route("/isalive") 
def is_alive(): 
  status_code = Response(status=200) 
  return status_code@app.route("/predict", methods=["POST"]) 
def predict(): 
  global model 
  req_json = request.get_json() 
  news = req_json['instances']["news"] 
  preds = gpt_compute_sentiment(news, model =model) 
  return jsonify({ 
        "predictions": preds.tolist()def get_args(): 
  parser = argparse.ArgumentParser() 
  parser.add_argument( 
        '--model-path', 
        default="text_model.pth", 
        help='The name of your saved model') 
  return parser.parse_args()if __name__ == "__main__": 
  args = get_args() 
  model_path = args.model_path 
  app.run(debug=True, host="0.0.0.0", port=8080) </pre></div>
<div><div><p><span data-contrast="none">In the code above, some points are omitted for brevity, but the most important details are preserved:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ol class="text-18 unscaled"><li data-leveltext="%1." data-font="Calibri" data-listid="5" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">Creating a flask application and adding CORS to avoid errors; No ‘Access-Control-Allow-Origin’.</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="5" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none">The loading code can be load_model’ed from Cloud Storage.</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="5" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none"></span><span data-contrast="none">Two mandatory routes: “/isalive” (ping that the server is running) and “/predict” (directly processing users’ request).</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"=""></span></li><li data-leveltext="%1." data-font="Calibri" data-listid="5" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="4" data-aria-level="1"><span data-contrast="none">Getting get_args command line arguments. The path to the weights of the model will be obtained through the command line parameters.</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="5" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"multilevel"}"="" data-aria-posinset="5" data-aria-level="1"><span data-contrast="none">Launching the app with the host address and port.</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ol></div></div>
<div><div><p><span data-contrast="none">Now the model deployment code needs to be packed into a Docker container. To do this, let’s create a Dockerfile:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><pre>FROM us-docker.pkg.dev/vertex-ai/training/pytorch-gpu.1-9:latest 
WORKDIR /component 
RUN pip install transformers==3.0.2 tqdm flask flask-corsCOPY gpt_model.py . 
COPY transformers_utils.py . 
COPY deploy_text_model.py .EXPOSE 8080 
ENTRYPOINT ["python", "deploy_text_model.py"] </pre></div></div>
<div><p><span data-contrast="none">Build a Docker image and upload it to the Container Registry.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">On the Model Registry tab, import our model.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p><span data-contrast="none">We set the name and select the region.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p><span data-contrast="none">Select the container with the model and set the arguments.</span></p><p><span data-contrast="none">Specify the routes and port inside the container, and click import.</span></p><p><span data-contrast="none">Now we will create an Endpoint on the appropriate </span><a href="https://console.cloud.google.com/vertex-ai/endpoints" target="_blank"><span data-contrast="none">tab</span></a><span data-contrast="none"> to test the added model.</span></p><p><span data-contrast="none">Select the model created earlier and specify the Compute settings.</span></p><p><span data-contrast="none">Also turn on monitoring and click Create.</span></p><div><p><span data-contrast="none">After deploying the model to Endpoint, we will check its operability using Python SDK:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><pre>from typing import Dict, List, Union 
from google.cloud import aiplatform 
from google.protobuf import json_format 
from google.protobuf.struct_pb2 import Valuedef predict_custom_trained_model_sample( 
    project: str, 
    endpoint_id: str, 
    instances: Union[Dict, List[Dict]], 
    location: str = "us-central1", 
    api_endpoint: str = "us-central1-aiplatform.googleapis.com", 
):    """ 
    `instances` can be either single instance of type dict or a list of instances.    """ 
    # The AI Platform services require regional API endpoints. 
client_options = {"api_endpoint": api_endpoint}    # Initialize client that will be used to create and send requests. 
    # This client only needs to be created once, and can be reused for multiple requests.    client = aiplatform.gapic.PredictionServiceClient(client_options=client_options)    # The format of each instance should conform to the deployed model's prediction input schema.    instances = instances if type(instances) == list else [instances] 
    instances = [ 
        json_format.ParseDict(instance_dict, Value()) for instance_dict in instances 
    ] 
    parameters_dict = {} 
    parameters = json_format.ParseDict(parameters_dict, Value()) 
    endpoint = client.endpoint_path( 
        project=project, location=location, endpoint=endpoint_id 
    ) 
    response = client.predict( 
    endpoint=endpoint, instances=instances, parameters=parameters 
    ) 
    print("response") 
    print(" deployed_model_id:", response.deployed_model_id)    # The predictions are a google.protobuf.Value representation of the model's predictions.    predictions = response.predictions 
    for prediction in predictions: 
        print(" prediction:", dict(prediction))predict_custom_trained_model_sample( 
    project="38068****5047", 
    endpoint_id="662337******5424128", 
    location="us-central1", 
    instances={"news": "test news, sell all your stuff"} 
) </pre></div>
<div><p><span data-contrast="none">Finally, we have successfully deployed our model. You can monitor the workload of the Endpoint and Vertex AI will dynamically increase the number of Endpoints when the load increases.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div></div>
</div>
<p>&nbsp;</p>
<h2 class="text-24 unscaled">
 Conclusion     
</h2>
<p>&nbsp;</p>
<div><div><p><span data-contrast="none">In this article, we have talked about the key points of custom learning in Vertex AI. This platform contains all the necessary components for MLOps. It is also worth paying attention to AutoML which allows you to obtain a machine learning model without specific deep knowledge.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">We also need to mention that at the operation stage there were also disadvantages, mainly related to versioning. You can create a dataset entity only if your file matches the desired schema, otherwise you must store it in cloud storage. Custom models are stored as a container, which makes it a bit difficult to add a new version for them.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div>
<p>&nbsp;&nbsp;</p>
<section class="cta-banner-section"><div class="row"><div class="col-12 col-md-6"><div class="cta-banner-section__content"><div class="tag"><p class="text-14 unscaled">Advanced Analytics</p></div><a href="/insights/financial-services/advanced-analytics" class="stretched-link"><p class="cta-banner-text text-22 unscaled">Discover more insights to help you unlock the value of your data 
</p></a><div class="btn btn-text btn-icon focus"><div class="text-container"><div class="text">Read more</div><div class="arr-offering"><i class="arr-small one"></i><i class="arr-small two"></i><i class="arr-small three"></i></div></div></div></div></div><div class="col-12 col-md-6 d-none d-md-block"><div class="cta-banner-section__image"><figure><img src="/files/blog-posts/cta-banners/Advanced-analytics.jpg" alt="cta banner"></figure></div></div></div></section>
<p>
    &nbsp;
</p>
            <section class="enhanced-blog-author blog-post-right-column">
        <div class="quote-container">
            <div class="quote">
                                                            <div class="quote__content">
                                                        <div class="author-image">
                                <figure>
                                    <img src="/files/people/2023/09/Arthur-Shaikhatarov.jpg" class="picture" alt="Arthur Shaikhatarov , AI/ML Project Manager, Automotive, Luxoft ">
                                </figure>
                            </div>
                                                        <div class="author-content">
                                <h3 class="author-name d-flex align-items-center text-20 unscaled">
                                                                            Arthur Shaikhatarov
                                                                                                                <a href="https://www.linkedin.com/in/arthur-shaikhatarov-1b358b211/" target="_blank">
                                            <img src="/theme/fintego/assets/images/icons/linkedin-gray24x24.svg" alt="author linkedin">
                                        </a>
                                                                    </h3>
                                <p class="author-title text-16 unscaled">AI/ML Project Manager, Automotive, Luxoft </p>
                                <p class="text-16 unscaled">Arthur has served as project manager specializing in AI/ML initiatives at Luxoft for 4 years. His journey in artificial intelligence and machine learning began as an engineer, where he honed his skills and knowledge. Arthur is responsible for team management and formation, presales activities for ML projects, the orchestration and execution of AI/ML proofs-of-concept and the growth of AI/ML activities within Luxoft. </p>
                            </div>
                        </div>
                                                </div>
        </div>
    </section>
        </div>
        <div class="col-12 col-md-4 col-lg-3 d-none d-md-block pl-70">
          <div class="blog-post-right-column__right-column ">
            <div class="blog-post-right-column blog-post-right-column__authors">
                        <div class="item">
                                <div class="image">
                    <figure>
                        <img src="/files/people/2023/09/Arthur-Shaikhatarov.jpg" class="picture" alt="Arthur Shaikhatarov , AI/ML Project Manager, Automotive, Luxoft ">
                    </figure>
                </div>
                                <div class="text">
                    <h3 class="author-name d-flex align-items-center text-16 unscaled">
                                                    Arthur Shaikhatarov
                                                                            <a href="https://www.linkedin.com/in/arthur-shaikhatarov-1b358b211/" target="_blank">
                                <img src="/theme/fintego/assets/images/icons/linkedin-gray24x24.svg" class="author-linkedin" alt="author linkedin">
                            </a>
                                            </h3>
                    <p class="author-title text-14 unscaled">AI/ML Project Manager, Automotive, Luxoft </p>
                </div>
            </div>
            </div>
            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><?xml encoding="utf-8" ?><html><body><div class="container"><div class="related-content">
								<div class="related-content__title">
									<p class="text-20 unscaled bold">Related content</p>
								</div>
								<div class="related-content__items">
											<div class="item">
    <div class="item--image">
      <figure>
        <img src="/files/blog/2023/07/7-ways-data-analytics-BlogImage.jpg" alt="7 ways data analytics and AI will shape the future of the retail industry">
      </figure>
    </div>
    <div class="item--title">
      <a href="/blog/ai-and-data-analytics-future-of-retail-industry" class="stretched-link" aria-label="7 ways data analytics and AI will shape the future of the retail industry  ">
        <p class="text-20 unscaled fw-bold">
            7 ways data analytics and AI will shape the future of the retail industry  
        </p>
      </a>
    </div>
</div>
											<div class="item">
    <div class="item--image">
      <figure>
        <img src="/files/blog/2023/07/432678-FS-EarlyResolution-Auto-Loan-960x960-v2.jpg" alt="Closing the digital innovation gap: Industry 4.0 benchmarks">
      </figure>
    </div>
    <div class="item--title">
      <a href="/blog/navigating-industry4-challenges" class="stretched-link" aria-label="Closing the digital innovation gap: Industry 4.0 benchmarks ">
        <p class="text-20 unscaled fw-bold">
            Closing the digital innovation gap: Industry 4.0 benchmarks 
        </p>
      </a>
    </div>
</div>
											<div class="item">
    <div class="item--image">
      <figure>
        <img src="/files/blog/2024/06/1718024173_508-Piloting-Scaling-Smart-Manufacturing-Industry-960x960px-optimized-image.jpg" alt="Piloting and scaling, smart manufacturing, Industry 4.0">
      </figure>
    </div>
    <div class="item--title">
      <a href="/blog/piloting-scaling-smart-manufacturing-industry-40" class="stretched-link" aria-label="Piloting and scaling, smart manufacturing, Industry 4.0 ">
        <p class="text-20 unscaled fw-bold">
            Piloting and scaling, smart manufacturing, Industry 4.0 
        </p>
      </a>
    </div>
</div>
													</div>
							</div></div></body></html>
          </div>
        </div>
      </div>
    </div>
    <div class="blog-post-right-column__related-content">
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><html><body><div class="related-content-snippet container"><div class="row title"><div class="col text-center"><div class="text-28 fs-2 unscaled">Related content</div></div></div><div class="row"><div class="col"><div class="related-content-snippet__item"><div class="related-content-snippet__item--image"><figure><img src="/files/blog/2023/10/433541-FS-GEMS-blog-5-Machine-Learning-with-Microsoft-Azure-KV4-jpg-1.jpg" alt="Machine learning with Microsoft Azure Monitoring machine learning models in production"></figure></div><div class="related-content-snippet__item--content"><a href="/blog/master-mlops-with-azure-deploy-monitor-ml-models"><div class="stretched-link"><b class="text-18 unscaled">Machine learning with Microsoft Azure Monitoring machine learning models in production
</b></div></a><p class="text-16 unscaled">by  Arthur Shaikhatarov, Suraj Manjunatha</p></div></div></div>
<div class="col"><div class="related-content-snippet__item"><div class="related-content-snippet__item--image"><figure><img src="/files/blog/2023/09/431694-CO-QA-automation-optimize-images-KV1-chosen.jpg" alt="Unleashing the power of automation with conversational AI"></figure></div><div class="related-content-snippet__item--content"><a href="/blog/unleashing-the-power-of-automation-with-conversational-ai"><div class="stretched-link"><b class="text-18 unscaled">Unleashing the power of automation with conversational AI</b></div></a><p class="text-16 unscaled">by Arthur Shaikhatarov,&nbsp;Martin D&rsquo;Ippolito</p></div></div></div><div class="col"><div class="related-content-snippet__item"><div class="related-content-snippet__item--image"><figure><img src="/files/services/natural-language-processing/header-banner.jpg" alt="Natural language processing (NLP)"></figure></div><div class="related-content-snippet__item--content"><a href="/services/natural-language-processing"><div class="stretched-link"><b class="text-18 unscaled">Natural language processing (NLP)
</b></div></a>
</div></div></div></div></div></body></html>
    </div>
        <div id="back-to-top-btn" class="back-to-top-btn">
            <button type="button">
                <img src="/theme/fintego/assets/images/arrow-down.svg" alt="back to top icon">
            </button>
        </div>
                                                                            <div id="page-industries" class="industry-Banking-and-Capital-Markets "></div>
                                                                        <div id="page-services" class="service-Data-Analytics "></div>
        <footer class="footer">
    <div class="container pt-10">
        <div class="row">
            <div class="col-12 col-lg-3 footer__col-contact">
                <p class="text-white paragraph-as-5">Enable your digital advantage with Luxoft</p>
                <a class="btn btn-outline" id="button-addon2" type="button" href="/contact-form">
                    Connect with us
                </a>
                <ul class="footer__social-networks">
                    <li>
                        <a href="https://www.facebook.com/Luxoft" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-fb.svg" alt="facebook icon">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.youtube.com/channel/UCDtOIqWxKHTdtmVi8yr_D7Q" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-yt.svg" alt="youtube icon">
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/Luxoft" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-tw.svg" alt="twitter icon">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/companies/luxoft" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-in.svg" alt="linkedin icon">
                        </a>
                    </li>
                </ul>
            </div>
            <div class="col-12 col-lg-3 footer__menu mt-0">
    <div class="menu-section">
        <p class="mb-3 overline menu-section--title">
            Discover Luxoft
        </p>
        <ul>
            <li>
                <a href="/about-us">About Us</a>
            </li>
            <li>
                <a href="https://career.fintego.com/">Careers</a>
            </li>
            <li>
                <a href="/contact-form">Contact Us</a>
            </li>
            <li>
                <a href="/event">Events</a>
            </li>
            <li>
                <a href="/esg">Environmental, Social and Governance</a>
            </li>
            <li>
                <a href="/global-presence">Global Presence</a>
            </li>
            <li>
                <a href="/insights">Insights</a>
            </li>
            <li>
                <a href="/pr">Newsroom</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapsePartnerships"
                                aria-controls="collapsePartnerships"
                                aria-expanded="false">
                                Partnerships
                        </button>
                    </p>
                    <div id="collapsePartnerships" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/partners">Luxoft's partners</a>
                                </li>
                                <li>
                                    <a href="/partners/nasdaq">Nasdaq</a>
                                </li>
                                <li>
                                    <a href="/partners/appian">Appian</a>
                                </li>
                                <li>
                                    <a href="/partners/aws">AWS</a>
                                </li>
                                <li>
                                    <a href="/partners/clm">Fenergo</a>
                                </li>
                                <li>
                                    <a href="/partners/finastra">Finastra</a>
                                </li>
                                <li>
                                    <a href="/partners/goldensource">GoldenSource</a>
                                </li>
                                <li>
                                    <a href="/partners/itrs">ITRS</a>
                                </li>
                                <li>
                                    <a href="/partners/microsoft">Microsoft</a>
                                </li>
                                <li>
                                    <a href="/partners/moodys">Moody's Analytics</a>
                                </li>
                                <li>
                                    <a href="/partners/murex">Murex</a>
                                </li>
                                <li>
                                    <a href="/partners/orchestrade">Orchestrade</a>
                                </li>
                                <li>
                                    <a href="/partners/pega">Pega</a>
                                </li>
                                <li>
                                    <a href="/partners/planixs">Planixs</a>
                                </li>
                                <li>
                                    <a href="/partners/smartstream">SmartStream</a>
                                </li>
                                <li>
                                    <a href="/partners/temenos">Temenos</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/ukraine-updates">Ukraine updates</a>
            </li>
        </ul>
    </div>
</div>
<div class="col-12 col-lg-3 footer__menu mt-0">
    <div class="menu-section">
        <p class="mb-3 overline menu-section--title">
            Services
        </p>
        <ul>
            <li>
                <a href="/services/cloud-solutions">Cloud Solutions</a>
            </li>
            <li>
                <a href="/services/data-to-insights">Data Analytics</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseDesign"
                                aria-controls="collapseDesign"
                                aria-expanded="false">
                                Design
                        </button>
                    </p>
                    <div id="collapseDesign" class="accordion-collapse collapse">
                        <div class="accordion-body smallest">
                            <ul>
                                <li>
                                    <a href="/services/design">Design services</a>
                                </li>
                                <li>
                                    <a href="/services/innovation-strategy">Innovation strategy</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseFrontendDevelopment"
                                aria-controls="collapseFrontendDevelopment"
                                aria-expanded="false">
                            Front-end Development
                        </button>
                    </p>
                    <div id="collapseFrontendDevelopment" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/services/front-end-development">Front-end development services</a>
                                </li>
                                <li>
                                    <a href="/services/mobile-app-development">Mobile Development</a>
                                </li>
                                <li>
                                    <a href="/services/web-development">Web Development</a>
                                </li>
                                <li>
                                    <a href="/services/3d-ar-vr-development">3D, AR and VR Development</a>
                                </li>
                                <li>
                                    <a href="/services/web-architecture">Web/Cloud Architecture</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseIntelligentAutomation"
                                aria-controls="collapseIntelligentAutomation"
                                aria-expanded="false">
                            Intelligent Automation
                        </button>
                    </p>
                    <div id="collapseIntelligentAutomation" class="accordion-collapse collapse">
                        <div class="accordion-body smallest">
                            <ul>
                                <li>
                                    <a href="/services/intelligent-automation">Intelligent automation services</a>
                                </li>
                                <li>
                                    <a href="/services/low-code-development">Low-code development</a>
                                </li>
                                <li>
                                    <a href="/services/robotic-process-automation">Robotic process automation (RPA) services</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseLegacyModernization"
                                aria-controls="collapseLegacyModernization"
                                aria-expanded="false">
                            Legacy Modernization
                        </button>
                    </p>
                    <div id="collapseLegacyModernization" class="accordion-collapse collapse">
                        <div class="accordion-body smallest">
                            <ul>
                                <li>
                                    <a href="/services/legacy-modernization">Legacy modernization services</a>
                                </li>
                                <li>
                                    <a href="/services/mainframe-modernization">Mainframe modernization</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/services/beyond">Luxoft Beyond</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseMachineLearning"
                                aria-controls="collapseMachineLearning"
                                aria-expanded="false">
                                Machine Learning
                        </button>
                    </p>
                    <div id="collapseMachineLearning" class="accordion-collapse collapse">
                        <div class="accordion-body small">
                            <ul>
                                <li>
                                    <a href="/services/machine-learning">Machine learning services</a>
                                </li>
                                <li>
                                    <a href="/services/computer-vision">Computer vision</a>
                                </li>
                                <li>
                                    <a href="/services/natural-language-processing">Natural language processing</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseSoftwareEngineering"
                                aria-controls="collapseSoftwareEngineering"
                                aria-expanded="false">
                                Software Engineering
                        </button>
                    </p>
                    <div id="collapseSoftwareEngineering" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/services/engineering-services">Software engineering services</a>
                                </li>
                                <li>
                                    <a href="/services/financial-software-development">Financial software development</a>
                                </li>
                                <li>
                                    <a href="/services/qa-automation">QA automation</a>
                                </li>
                                <li>
                                    <a href="/services/trading-software-development">Trading software development</a>
                                </li>
                                <li>
                                    <a href="/services/software-development-outsourcing">Software development outsourcing</a>
                                </li>
                                <li>
                                    <a href="/services/custom-software-development">Custom software development</a>
                                </li>
                                <li>
                                    <a href="/services/application-engineering-services">Application engineering services</a>
                                </li>
                                <li>
                                    <a href="/services/bespoke-software-development">Bespoke software development</a>
                                </li>
                                <li>
                                    <a href="/services/product-engineering-services">Product engineering services</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<div class="col-12 col-lg-3 footer__menu mt-0">
    <div class="menu-section">
        <p class="mb-3 overline menu-section--title">
            Industries
        </p>
        <ul>
            <li>
                <a href="/industries/automotive">Automotive</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseBanking"
                                aria-controls="collapseBanking"
                                aria-expanded="false">
                                Banking
                        </button>
                    </p>
                    <div id="collapseBanking" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/industries/banking">IT services for banking</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/boomerang">Boomerang software</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/cloud">Cloud banking services</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/connected-wealth">Wealth management solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/core-banking">Core banking software</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/earlyresolution">EarlyResolution</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/earlyresolution/auto-loan">EarlyResolution auto loan</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/earlyresolution/borrower-portal">EarlyResolution borrower portal</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan">Hogan banking system</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/health-check">Hogan health check</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/hybrid-cloud">Hogan hybrid cloud</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/hogan-io">Hogan io</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/academy">Hogan academy</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/managed-services">Hogan managed services</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/luxoft-banking-transformation-advisory">Banking transformation advisory</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/luxoft-cams">CAMS card processing solution</a>
                                </li>
                                <li>
                                    <a href="/partners/temenos/health-check">Temenos health check</a>
                                </li>
                                <li>
                                    <a href="/partners/temenos/upgrades">Temenos upgrade</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseCapitalMarkets"
                                aria-controls="collapseCapitalMarkets"
                                aria-expanded="false">
                                Capital Markets
                        </button>
                    </p>
                    <div id="collapseCapitalMarkets" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/industries/capital-markets">Capital markets technology solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/clm-consultancy">CLM solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/energy-and-commodity">Energy and commodity trading</a>
                                </li>
                                <li>
                                    <a href="/partners/goldensource">GoldenSource client services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/liquidity-management">Liquidity management services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/reconciliation-solution">Reconciliation solution</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/regtech-solutions">Regtech in financial services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/regulatory-reporting">Regulatory reporting services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/treasury-solutions">Corporate treasury solutions</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/industries/consumer-goods">Consumer Goods</a>
            </li>
            <li>
                <a href="/industries/energy-and-utilities">Energy and Utilities</a>
            </li>
            <li>
                <a href="/industries/healthcare">Healthcare and Life Sciences</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseInsurance"
                                aria-controls="collapseInsurance"
                                aria-expanded="false">
                            Insurance
                        </button>
                    </p>
                    <div id="collapseInsurance" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/industries/insurance">Insurance technology solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/data-analytics-ai">AI and Analytics solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/intelligent-automation">Automation</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/legacy-modernization">Legacy modernization</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/software-engineering">Software development</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/technology-advisory">Technology advisory</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/ui-ux-design">UI / UX Design</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/industries/manufacturing">Manufacturing</a>
            </li>
            <li>
                <a href="/industries/media">Media</a>
            </li>
            <li>
                <a href="/industries/technology-networking">Networking and Technology</a>
            </li>
            <li>
                <a href="/industries/oil">Oil and Gas</a>
            </li>
            <li>
                <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
            </li>
            <li>
                <a href="/industries/telecommunications">Telecommunications</a>
            </li>
            <li>
                <a href="/industries/travel-and-hospitality">Travel and Hospitality</a>
            </li>
            <li>
                <a href="/industries/transportation-and-logistics">Transportation and Logistics</a>
            </li>
        </ul>
    </div>
</div>
<div class="footer__menu-mobile">
    <div class="menu-accordion">
        <div class="accordion-item normal">
            <p class="accordion-header">
                <button class="accordion-button text-20 text-uppercase collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseIndustries"
                        aria-controls="collapseIndustries">
                    Industries
                </button>
            </p>
            <div id="collapseIndustries" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <ul>
                        <li>
                            <a href="/industries/automotive">Automotive</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseBankingMobile"
                                            aria-controls="collapseBankingMobile">
                                            Banking
                                    </button>
                                </p>
                                <div id="collapseBankingMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/industries/banking">IT services for banking</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/boomerang">Boomerang software</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/cloud">Cloud banking services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/connected-wealth">Wealth management solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/core-banking">Core banking software</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/earlyresolution">EarlyResolution</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/earlyresolution/auto-loan">EarlyResolution auto loan</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/earlyresolution/borrower-portal">EarlyResolution borrower portal</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan">Hogan banking system</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/health-check">Hogan health check</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/hybrid-cloud">Hogan hybrid cloud</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/hogan-io">Hogan io</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/academy">Hogan academy</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/managed-services">Hogan managed services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/luxoft-banking-transformation-advisory">Banking transformation advisory</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/luxoft-cams">CAMS card processing solution</a>
                                            </li>
                                            <li>
                                                <a href="/partners/temenos/health-check">Temenos health check</a>
                                            </li>
                                            <li>
                                                <a href="/partners/temenos/upgrades">Temenos upgrade</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseCapitalMobile"
                                            aria-controls="collapseCapitalMobile">
                                            Capital Markets
                                    </button>
                                </p>
                                <div id="collapseCapitalMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/industries/capital-markets">Capital markets technology solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/clm-consultancy">CLM solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/energy-and-commodity">Energy and commodity trading</a>
                                            </li>
                                            <li>
                                                <a href="/partners/goldensource">GoldenSource client services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/liquidity-management">Liquidity management services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/reconciliation-solution">Reconciliation solution</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/regtech-solutions">Regtech in financial services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/regulatory-reporting">Regulatory reporting services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/treasury-solutions">Corporate treasury solutions</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/industries/consumer-goods">Consumer Goods</a>
                        </li>
                        <li>
                            <a href="/industries/energy-and-utilities">Energy and Utilities</a>
                        </li>
                        <li>
                            <a href="/industries/healthcare">Healthcare and Life Sciences</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseInsuranceMobile"
                                            aria-controls="collapseInsuranceMobile">
                                        Insurance
                                    </button>
                                </p>
                                <div id="collapseInsuranceMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/industries/insurance">Insurance technology solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/data-analytics-ai">AI and Analytics solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/intelligent-automation">Automation</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/legacy-modernization">Legacy modernization</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/software-engineering">Software development</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/technology-advisory">Technology advisory</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/ui-ux-design">UI / UX Design</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/industries/manufacturing">Manufacturing</a>
                        </li>
                        <li>
                            <a href="/industries/media">Media</a>
                        </li>
                        <li>
                            <a href="/industries/technology-networking">Networking and Technology</a>
                        </li>
                        <li>
                            <a href="/industries/oil">Oil and Gas</a>
                        </li>
                        <li>
                            <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
                        </li>
                        <li>
                            <a href="/industries/telecommunications">Telecommunications</a>
                        </li>
                        <li>
                            <a href="/industries/travel-and-hospitality">Travel and Hospitality</a>
                        </li>
                        <li>
                            <a href="/industries/transportation-and-logistics">Transportation and Logistics</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="accordion-item normal">
            <p class="accordion-header">
                <button class="accordion-button text-20 text-uppercase collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseServices"
                        aria-controls="collapseServices">
                    Services
                </button>
            </p>
            <div id="collapseServices" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <ul>
                        <li>
                            <a href="/services/cloud-solutions">Cloud Solutions</a>
                        </li>
                        <li>
                            <a href="/services/data-to-insights">Data Analytics</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseDesignMobile"
                                            aria-controls="collapseDesignMobile">
                                            Design
                                    </button>
                                </p>
                                <div id="collapseDesignMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/design">Design services</a>
                                            </li>
                                            <li>
                                                <a href="/services/innovation-strategy">Innovation strategy</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseFrontendDevelopmentMobile"
                                            aria-controls="collapseFrontendDevelopmentMobile">
                                        Front-end Development
                                    </button>
                                </p>
                                <div id="collapseFrontendDevelopmentMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/front-end-development">Front-end development services</a>
                                            </li>
                                            <li>
                                                <a href="/services/mobile-app-development">Mobile Development</a>
                                            </li>
                                            <li>
                                                <a href="/services/web-development">Web Development</a>
                                            </li>
                                            <li>
                                                <a href="/services/3d-ar-vr-development">3D, AR and VR Development</a>
                                            </li>
                                            <li>
                                                <a href="/services/web-architecture">Web/Cloud Architecture</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseIntelligentAutomationMobile"
                                            aria-controls="collapseIntelligentAutomationMobile">
                                        Intelligent Automation
                                    </button>
                                </p>
                                <div id="collapseIntelligentAutomationMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/intelligent-automation">Intelligent automation services</a>
                                            </li>
                                            <li>
                                                <a href="/services/low-code-development">Low-code development</a>
                                            </li>
                                            <li>
                                                <a href="/services/robotic-process-automation">Robotic process automation (RPA) services</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseLegacyModernizationMobile"
                                            aria-controls="collapseLegacyModernizationMobile">
                                            Legacy Modernization
                                    </button>
                                </p>
                                <div id="collapseLegacyModernizationMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/legacy-modernization">Legacy Modernization</a>
                                            </li>
                                            <li>
                                                <a href="/services/mainframe-modernization">Mainframe modernization</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/services/beyond">Luxoft Beyond</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseMachineLearningMobile"
                                            aria-controls="collapseMachineLearningMobile">
                                            Machine Learning
                                    </button>
                                </p>
                                <div id="collapseMachineLearningMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/machine-learning">Machine learning services</a>
                                            </li>
                                            <li>
                                                <a href="/services/computer-vision">Computer vision</a>
                                            </li>
                                            <li>
                                                <a href="/services/natural-language-processing">Natural language processing</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseSoftwareEngineeringMobile"
                                            aria-controls="collapseSoftwareEngineeringMobile">
                                            Software Engineering
                                    </button>
                                </p>
                                <div id="collapseSoftwareEngineeringMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/engineering-services">Software engineering services</a>
                                            </li>
                                            <li>
                                                <a href="/services/financial-software-development">Financial software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/qa-automation">QA automation</a>
                                            </li>
                                            <li>
                                                <a href="/services/trading-software-development">Trading software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/software-development-outsourcing">Software development outsourcing</a>
                                            </li>
                                            <li>
                                                <a href="/services/custom-software-development">Custom software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/application-engineering-services">Application engineering services</a>
                                            </li>
                                            <li>
                                                <a href="/services/bespoke-software-development">Bespoke software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/product-engineering-services">Product engineering services</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="accordion-item normal">
            <p class="accordion-header">
                <button class="accordion-button text-20 text-uppercase collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseDiscoverLuxoft"
                        aria-controls="collapseDiscoverLuxoft">
                    Discover Luxoft
                </button>
            </p>
            <div id="collapseDiscoverLuxoft" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <ul>
                        <li>
                            <a href="/about-us">About Us</a>
                        </li>
                        <li>
                            <a href="https://career.fintego.com/">Careers</a>
                        </li>
                        <li>
                            <a href="/contact-form">Contact Us</a>
                        </li>
                        <li>
                            <a href="/event">Events</a>
                        </li>
                        <li>
                            <a href="/esg">Environmental, Social and Governance</a>
                        </li>
                        <li>
                            <a href="/global-presence">Global Presence</a>
                        </li>
                        <li>
                            <a href="/insights">Insights</a>
                        </li>
                        <li>
                            <a href="/pr">Newsroom</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapsePartnershipsMobile"
                                            aria-controls="collapsePartnershipsMobile">
                                            Partnerships
                                    </button>
                                </p>
                                <div id="collapsePartnershipsMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/partners">Luxoft's partners</a>
                                            </li>
                                            <li>
                                                <a href="/partners/nasdaq">Nasdaq</a>
                                            </li>
                                            <li>
                                                <a href="/partners/appian">Appian</a>
                                            </li>
                                            <li>
                                                <a href="/partners/aws">AWS</a>
                                            </li>
                                            <li>
                                                <a href="/partners/clm">Fenergo</a>
                                            </li>
                                            <li>
                                                <a href="/partners/finastra">Finastra</a>
                                            </li>
                                            <li>
                                                <a href="/partners/goldensource">GoldenSource</a>
                                            </li>
                                            <li>
                                                <a href="/partners/itrs">ITRS</a>
                                            </li>
                                            <li>
                                                <a href="/partners/microsoft">Microsoft</a>
                                            </li>
                                            <li>
                                                <a href="/partners/moodys">Moody's Analytics</a>
                                            </li>
                                            <li>
                                                <a href="/partners/murex">Murex</a>
                                            </li>
                                            <li>
                                                <a href="/partners/orchestrade">Orchestrade</a>
                                            </li>
                                            <li>
                                                <a href="/partners/pega">Pega</a>
                                            </li>
                                            <li>
                                                <a href="/partners/planixs">Planixs</a>
                                            </li>
                                            <li>
                                                <a href="/partners/smartstream">SmartStream</a>
                                            </li>
                                            <li>
                                                <a href="/partners/temenos">Temenos</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/ukraine-updates">Ukraine updates</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
        </div>
    </div>
    <div class="container border-top">
        <div class="row footer__sub-footer pt-3 pb-3">
            <div class="col-12 col-lg-5 text-uppercase order-lg-first order-sm-last copy-right mt-sm-3 pt-sm-3 pt-lg-0 mt-lg-0">
                <p>© 2025 LUXOFT, A DXC TECHNOLOGY COMPANY. ALL RIGHTS RESERVED.</p>
            </div>
            <div class="col-12 col-lg-7 order-lg-last order-sm-first">
                <ul class="list-group list-group-horizontal-lg float-lg-end text-uppercase">
                    <li>
                        <a href="/procurement">Procurement</a>
                    </li>
                    <li>
                        <a href="/corporate-policies">Corporate Policies</a>
                    </li>
                    <li>
                        <a href="/online-privacy-policy">Privacy Policy</a>
                    </li>
                    <li>
                        <a href="/terms-of-use">Terms of Use</a>
                    </li>
                    <li>
                        <a href="/contact-form#copyrights">Report Copyright Violation</a>
                    </li>
                    <li>
                        <a href="/sitemap">Sitemap</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
        <script crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
        <script src="/theme/fintego/assets/bootstrap.bundle.min.js"></script>
        <script src="/theme/fintego/assets/tiny-slider.min.js"></script>
                <script src="/theme/fintego/assets/app.min.0ae706d0b4e4289536f7.js"></script>
    </body>
</html>
