<!doctype html>
<html lang="en">
    <head>
        <!-- OneTrust Cookies Consent Notice start for fintego.com -->
        <script refer async type="text/javascript">
            function OptanonWrapper() { }
        </script>
        <!-- OneTrust Cookies Consent Notice end for fintego.com -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script refer async>
            document.addEventListener('DOMContentLoaded', e => {
                window.dataLayer = window.dataLayer || []
                if (document.getElementById('page-industries')) {
                    const industriesList = Array.from(document.getElementById('page-industries').classList)
                    industriesList.forEach(industry => {
                        window.dataLayer.push ({"event": "page-load", "PageGrouping": industry});
                    })
                }
                if (document.getElementById('page-services')) {
                    const servicesList = Array.from(document.getElementById('page-services').classList)
                    servicesList.forEach(service => {
                        window.dataLayer.push ({"event": "page-load", "PageGrouping": service});
                    })
                }
            })
        </script>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
        {'gtm.start': new Date().getTime(),event:'gtm.js'}
        );var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','');</script>
        <!-- End Google Tag Manager -->
        <!-- Google tag (gtag.js) -->
        <script refer async src="https://www.googletagmanager.com/gtag/js?id="></script>
        <link rel="shortcut icon" type="image/x-icon" href="/theme/fintego/static/images/favicon/favicon.svg" />
        <script refer src="https://code.jquery.com/jquery-3.7.1.min.js"crossorigin="anonymous"></script>
        <link rel="manifest" href="/theme/fintego/static/images/favicon/site.webmanifest">
        <script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BreadcrumbList","itemListElement":[[{"@type":"ListItem","position":1,"item":"https:\/\/www.fintego.com\/","name":"Home"},{"@type":"ListItem","position":2,"item":"https:\/\/www.fintego.com\/blog","name":"Blog"},{"@type":"ListItem","position":3,"name":"ML\/AI algorithms for room layout editing "}]]}</script>
        <title>
        Revolutionizing room layout editing with ML/AI Algorithms on AMD GPUs 
        </title>
        <script refer async type="text/javascript" src="//cdn-4.convertexperiments.com/js/10041441-10041537.js"></script>
        <link rel="stylesheet" href="/theme/fintego/assets/app.min.41025cec95a71e1b0698.css">
        <link rel="preload" href="/theme/fintego/assets/swiper-bundle.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
                <script refer src="//offer.fintego.com/js/forms2/js/forms2.min.js"></script>
    <meta property="og:locale" content="en" />
        <meta property="og:title" content="Revolutionizing room layout editing with ML/AI algorithms on AMD GPUs " />
        <meta property="og:description" content="Discover ML on AMD GPUs with the latest ROCm release. Explore our journey implementing a smart interior editor using PyTorch. " />
        <meta name="description" content="Discover ML on AMD GPUs with the latest ROCm release. Explore our journey implementing a smart interior editor using PyTorch. " />
                    <meta property="og:url" content="/blog/ml-ai-algorithms-room-layout-editing-amd-gpus" />
                    <meta property="og:image:width" content="960">
        <meta property="og:image:height" content="960">
        <meta property="og:image" content="/files/blog/2023/09/1695977770_960x960-GEMS4blog.jpg" />
        <meta name="twitter:image" content="/files/blog/2023/09/1695977770_960x960-GEMS4blog.jpg" />
        <meta name="twitter:description" content="Discover ML on AMD GPUs with the latest ROCm release. Explore our journey implementing a smart interior editor using PyTorch. " />
        <meta name="twitter:title" content="Revolutionizing room layout editing with ML/AI algorithms on AMD GPUs " />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@luxoft" />
        <script id="imageMarkUpData" type="application/ld+json"></script>
                            <link rel="canonical" href="/blog/ml-ai-algorithms-room-layout-editing-amd-gpus">
<meta name="generator" content="Bolt">
</head>
    <body class="  bd-white
">
        <a href="#main-content" class="skip-link">Skip to main content</a>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
<header class="header ">
    <div class="container--wide">
        <div class="header__nav">
            <div class="switch" id="menu-switcher">
                <div class="item"></div>
                <div class="item"></div>
                <div class="item"></div>
                <div class="text">
                    <span>Menu</span>
                </div>
            </div>
            <div class="logo">
                <a href="/">
                    <img src="/theme/fintego/assets/images/logo/fintego-new-white.svg"
                         class="img img--white"
                         alt="Luxoft | A leading IT company for cutting-edge software engineering and digital transformation services"
                         style="width:110px" />
                </a>
            </div>
            <div class="lux-menu">
                <nav class="lux-menu__nav">
                    <div class="lux-menu__line"></div>
                    <ul>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">Industries</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>Industries
                                        </a>
                                    </li>
                                    <li><a href="/industries/automotive">Automotive</a></li>
                                    <li><a href="/industries/banking">Banking</a></li>
                                    <li>
                                        <a href="/industries/capital-markets">Capital Markets</a>
                                    </li>
                                    <li><a href="/industries/consumer-goods">Consumer Goods</a></li>
                                    <li>
                                        <a href="/industries/energy-and-utilities">Energy and Utilities</a>
                                    </li>
                                    <li>
                                        <a href="/industries/healthcare">
                                            Healthcare and Life Sciences
                                        </a>
                                    </li>
                                    <li><a href="/industries/insurance">Insurance</a></li>
                                    <li>
                                        <a href="/industries/manufacturing">Manufacturing</a>
                                    </li>
                                    <li><a href="/industries/media">Media</a></li>
                                    <li>
                                        <a href="/industries/technology-networking">
                                            Networking and Technology
                                        </a>
                                    </li>
                                    <li><a href="/industries/oil">Oil and Gas</a></li>
                                    <li>
                                        <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
                                    </li>
                                    <li>
                                        <a href="/industries/telecommunications">
                                            Telecommunications
                                        </a>
                                    </li>
                                    <li><a href="/industries/travel-and-hospitality">Travel and Hospitality</a></li>
                                    <li>
                                        <a href="/industries/transportation-and-logistics">
                                            Transportation and Logistics
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">Services</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>Services
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/cloud-solutions">Cloud Solutions</a>
                                    </li>
                                    <li>
                                        <a href="/services/data-to-insights">Data Analytics</a>
                                    </li>
                                    <li><a href="/services/design">Design</a></li>
                                    <li>
                                        <a href="/services/engineering-services">Engineering</a>
                                    </li>
                                    <li>
                                        <a href="/services/front-end-development">Front-end Development</a>
                                    </li>
                                    <li>
                                        <a href="/services/innovation-strategy">
                                            Innovation Strategy
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/intelligent-automation">
                                            Intelligent Automation
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/legacy-modernization">
                                            Legacy Modernization
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/services/beyond">Luxoft Beyond</a>
                                    </li>
                                    <li>
                                        <a href="/services/machine-learning">Machine Learning</a>
                                    </li>
                                    <li><a href="/services/qa-automation">QA Automation</a></li>
                                </ul>
                            </div>
                        </li>
                        <li class="firstLvl">
                            <a href="/case-studies">Case studies</a>
                        </li>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">Insights</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>Insights
                                        </a>
                                    </li>
                                    <li><a href="/insights">Insights and Resource Hub</a></li>
                                    <li><a href="/insights/automotive">Automotive Insights</a></li>
                                    <li><a href="/insights/financial-services">Financial Services Insights</a></li>
                                    <li><a href="/insights/cross-industry-solutions">Cross-Industry Solutions Insights</a></li>
                                    <li><a href="/insights/technology-and-engineering">Technology and Engineering Insights</a></li>
                                </ul>
                            </div>
                        </li>
                        <li class="firstLvl">
                            <a href="https://career.fintego.com/">
                                Careers
                            </a>
                        </li>
                        <li class="has-children firstLvl">
                            <a href="javascript:" class="root-link">About us</a>
                            <div class="lux-menu__submenuLvlTwo">
                                <ul>
                                    <li>
                                        <a href="javascript:" class="back-mobile back-mobileLvlOne">
                                            <i class="arr-left"></i>About us
                                        </a>
                                    </li>
                                    <li><a href="/about-us">About Luxoft</a></li>
                                    <li><a href="/esg">Environmental, Social and Governance</a></li>
                                    <li><a href="/event">Events</a></li>
                                    <li><a href="/global-presence">Global Presence</a></li>
                                    <li><a href="/pr">Newsroom</a></li>
                                    <li><a href="/partners">Partnerships</a></li>
                                    <li><a href="/ukraine-updates">Ukraine updates</a></li>
                                </ul>
                            </div>
                        </li>
                                                <li class="firstLvl"><a href="/contact-form">Contact us</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="header__new-menu">
            <ul>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">Industries</a>
                    <div class="header__new-menu--sub-menu industry-expertise">
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/automotive">Automotive</a>
                            </div>
                            <div class="single">
                                <a href="/industries/healthcare">
                                    Healthcare and Life Sciences
                                </a>
                            </div>
                            <div class="single">
                                <a href="/industries/oil">Oil and Gas</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/banking">Banking</a>
                            </div>
                            <div class="single">
                                <a href="/industries/insurance">Insurance</a>
                            </div>
                            <div class="single">
                                <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/capital-markets">Capital Markets</a>
                            </div>
                            <div class="single">
                                <a href="/industries/manufacturing">Manufacturing</a>
                            </div>
                            <div class="single">
                                <a href="/industries/telecommunications">Telecommunications</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/consumer-goods">Consumer Goods</a>
                            </div>
                            <div class="single">
                                <a href="/industries/media">Media</a>
                            </div>
                            <div class="single">
                                <a href="/industries/travel-and-hospitality">Travel and Hospitality</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/industries/energy-and-utilities">Energy and Utilities</a>
                            </div>
                            <div class="single">
                                <a href="/industries/technology-networking">
                                    Networking and Technology
                                </a>
                            </div>
                            <div class="single">
                                <a href="/industries/transportation-and-logistics">
                                    Transportation and Logistics
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">Services</a>
                    <div class="header__new-menu--sub-menu our-services">
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/services/cloud-solutions">Cloud Solutions</a>
                            </div>
                            <div class="single">
                                <a href="/services/engineering-services">Engineering</a>
                            </div>
                            <div class="single">
                                <a href="/services/intelligent-automation">
                                    Intelligent Automation
                                </a>
                            </div>
                            <div class="single">
                                <a href="/services/machine-learning">Machine Learning</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/services/data-to-insights">Data Analytics</a>
                            </div>
                            <div class="single">
                                <a href="/services/front-end-development">Front-end Development</a>
                            </div>
                            <div class="single">
                                <a href="/services/legacy-modernization">
                                    Legacy Modernization
                                </a>
                            </div>
                            <div class="single">
                                <a href="/services/qa-automation">QA Automation</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/services/design">Design</a>
                            </div>
                            <div class="single">
                                <a href="/services/innovation-strategy">
                                    Innovation Strategy
                                </a>
                            </div>
                            <div class="single">
                                <a href="/services/beyond">Luxoft Beyond</a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="/case-studies" class="element">Case studies</a>
                </li>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">Insights</a>
                    <div class="header__new-menu--sub-menu insights-menu">
                        <div class="header__new-menu--sub-menu--item align-items-center">
                            <div class="single">
                                <a href="/insights">Insights and Resource Hub</a>
                            </div>
                            <div class="single">
                                <a href="/insights/automotive">Automotive Insights</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/insights/financial-services">Financial Services Insights</a>
                            </div>
                            <div class="single">
                                <a href="/insights/cross-industry-solutions">Cross-Industry Solutions Insights</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/insights/technology-and-engineering">Technology and Engineering Insights</a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://career.fintego.com/" class="element">Careers</a>
                </li>
                <li>
                    <a href="javascript:" class="element" aria-expanded="false" aria-haspopup="true">About us</a>
                    <div class="header__new-menu--sub-menu about-us">
                        <div class="header__new-menu--sub-menu--item align-items-center">
                            <div class="single">
                                <a href="/about-us">About Luxoft</a>
                            </div>
                            <div class="single">
                                <a href="/esg">Environmental, Social and Governance</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/event">Events</a>
                            </div>
                            <div class="single">
                                <a href="/pr">Newsroom</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/global-presence">Global Presence</a>
                            </div>
                            <div class="single">
                                <a href="/partners">Partnerships</a>
                            </div>
                        </div>
                        <div class="header__new-menu--sub-menu--item">
                            <div class="single">
                                <a href="/ukraine-updates">Ukraine updates</a>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <a class="contact" href="/contact-form" aria-label="Contact us">
                        <div class="contact--image"></div>
                    </a>
                </li>
            </ul>
        </div>
                <div class="header__contact">
            <ul>
                <li>
                    <a href="#" class="search-btn" id="search-btn">
                        <img src="/theme/fintego/assets/images/icons/search.svg"
                             alt="search icon" />
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="header__contact--square" id="header--square"></div>
    <div class="header__search-open">
        <div class="header__search-open__panel">
            <div class="header__search-open__top">
                <div class="close" id="close-search">
                    &times;
                </div>
            </div>
            <div class="header__search-open__form">
                <form id="global-search" method="GET" action="/search">
                    <input id="input-search" type="text" name="q" placeholder="Search..." />
                </form>
            </div>
        </div>
    </div>
</header>
      <script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"ML\/AI algorithms for room layout editing ","description":"Discover ML on AMD GPUs with the latest ROCm release. Explore our journey implementing a smart interior editor using PyTorch. ","name":"Blog","url":"https:\/\/www.fintego.com\/blog\/ml-ai-algorithms-room-layout-editing-amd-gpus","inLanguage":"en","articleBody":"<p>{​{light_breadcrumbs(record)}​}<\/p>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<section class=\"blog-in-brief\">\r\n<p class=\"blog-in-brief__heading text-20 unscaled\">\r\n    In brief\r\n<\/p>\r\n<ul class=\"text-18 default-ul unscaled\"><li><b><\/b><b><\/b><b><\/b><span data-contrast=\"auto\"><\/span><span data-contrast=\"none\"><\/span><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">R<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">unning <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">machine learning (<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ML<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">)<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> algorithms and neural networks <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">(NNs) <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">on AMD GPUs has <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">long <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">been a non-trivial task for <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">typical <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">developer.<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">But the latest AMD <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ROCm<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> release introduced <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">a number of<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> new features and improvements to <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"><\/span><\/span>ease the work of ML engineers<span data-contrast=\"none\"><\/span><\/li>\r\n    <li><b><\/b><b><\/b><b><\/b><span data-contrast=\"auto\"><\/span><span data-contrast=\"none\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">As part of our research work<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">,<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> we <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">decided to try running our ML inference on AMD GPUs. In this article, we share our journey about how we applied new ML approaches in our project and used those to run ML models with AMD<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span> <\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\"><\/span><\/li><li><b><\/b><b><\/b><span data-contrast=\"none\"><\/span><span data-contrast=\"none\"><\/span><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">The core project <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">idea <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">was<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> to<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> implement a smart interior editor that would allow users <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">to <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">chang<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">e<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> their room layout and design in just a <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">few <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">clicks. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">Read on to find out how we <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">buil<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">t <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the models with <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">PyTorch<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> and <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">r<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">a<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">n <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the code with little <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">additional<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> porting work<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559740\":276}\"=\"\"><\/span><\/li>\r\n<\/ul>\r\n<\/section>\r\n<p>\r\n    &nbsp;&nbsp;\r\n<\/p>\r\n<div><div><div><div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">In the past<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">, running ML algorithms and neural networks on AMD GPUs <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">was<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> a non-trivial task for <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ordinary developer. As part of the GEMS AI\/ML team at <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">Luxoft<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">, we spend a lot of time working on computer vision and machine learning algorithms. Among other projects, we do internal research and development for AMD — one of our <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">biggest<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">customers.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">Our close collaboration with AMD provides us with <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">early access<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> to versatile AMD video cards that we use in our research work. Compared to competing hardware, AMD GPUs have <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">numerous<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> significant advantages in floating-point calculations. And what is more, the latest release of the <\/span><\/span><a href=\"https:\/\/github.com\/RadeonOpenCompute\/ROCm\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">AMD <\/span><span data-ccp-charstyle=\"Hyperlink\">ROCm<\/span><span data-ccp-charstyle=\"Hyperlink\">™ open software platform<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> introduced support for new features and offered <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">a great number<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> of improvements<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">&nbsp;<\/span><\/span><span data-contrast=\"auto\">to ease the work of ML engineers.<\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\"><\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">Th<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">is<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> is why, at some point, we decided to try running our ML inference on AMD GPUs. In this article, we want to share our journey about how we applied new ML approaches in our project and used <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">th<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">em<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">to run ML models with AMD.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div>\r\n\r\n\r\n\r\n<\/div>\r\n\r\n<\/div>\r\n\r\n<\/div>\r\n<p>&nbsp; &nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">\r\n    Challenge for room layout editing  \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div>\r\n    <div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">The core idea for our latest large project was implementing a smart interior editor that would allow users <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">to <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">chang<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">e<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> their room layout and design in just a couple of clicks. At <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">a<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">fundamental level, we needed to automate the following processes: <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">P<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">erforming image segmentation, finding frame perspective, <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">determining<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> room geometry, removing objects within the <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">frame<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> and adding new 3D models. Additionally, we needed to develop an algorithm that would apply new material texture<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">s<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> with light and shade effects.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n\r\n<\/div>\r\n\r\n\r\n<\/div>\r\n<div>\r\n    \r\n<p>&nbsp;<\/p>\r\n<\/div>\r\n<h2 class=\"text-24 unscaled\">\r\n   Solution brief  \r\n<\/h2>\r\n<p>\r\n    &nbsp;\r\n<\/p>\r\n<div>\r\n    <div><div><div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">After studying the subject area and running the first tests, we <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">came up with<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the following pipeline for our smart editor:<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ol class=\"text-18 unscaled\"><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"7\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|10\",\"classid\":1073872969,\"properties\":[469775450,\"mi\",201340122,\"2\",134233614,\"true\",469778129,\"mi\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">First, we should <\/span><span data-ccp-parastyle=\"mi\">determine<\/span><span data-ccp-parastyle=\"mi\"> the parameters of the room: <\/span><span data-ccp-parastyle=\"mi\">C<\/span><span data-ccp-parastyle=\"mi\">onsider the segmentation mask, layout mask (room geometry) and vanishing points (room perspective)<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"7\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Next, we should find individual objects on the segmentation mask for <\/span><span data-ccp-parastyle=\"mi\">subsequent<\/span><span data-ccp-parastyle=\"mi\"> <\/span><span data-ccp-parastyle=\"mi\">removal<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"7\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Then we can remove existing objects<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"7\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">After that, we need to apply new textures, materials to the floor and <\/span><span data-ccp-parastyle=\"mi\">walls<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"7\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"5\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Our next step is transferring shadows from the original image and applying <\/span><span data-ccp-parastyle=\"mi\">them<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"%1.\" data-font=\"Calibri\" data-listid=\"7\" data-list-defn-props=\"{\" 335552541\":0,\"335559684\":-1,\"335559685\":720,\"335559991\":360,\"469769242\":[65533,0],\"469777803\":\"left\",\"469777804\":\"%1.\",\"469777815\":\"hybridmultilevel\"}\"=\"\" data-aria-posinset=\"6\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">And finally, we can calibrate the 3D camera by the vanishing point and add new <\/span><span data-ccp-parastyle=\"mi\">objects<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ol><\/div><\/div>\r\n\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">To implement this pipeline, we used machine learning models. In the following <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">portion<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> of the article, we will describe our network in more detail<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div>\r\n\r\n<\/div>\r\n\r\n\r\n\r\n\r\n<\/div>\r\n<p>&nbsp;&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">1. Machine learning algorithms   <\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><div><div><p><b><span data-ccp-charstyle=\"Strong\">1.1 Segmentation<\/span><\/b><\/p><\/div>\r\n<div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Segmentation is a well<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">-<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">studied task, so there are <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">a great number<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> of canned solutions. To compare models for segmentation, we used the <\/span><\/span><a href=\"https:\/\/github.com\/open-mmlab\/mmsegmentation\/tree\/master\/configs\/swin%22%20\/t%20%22_blank\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">mmseg<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> framework. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">It includes a great number of models for segmentation and weights for various datasets.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">For training and testing models, we used the configuration file approach. This approach allowed us to unify work with different models and datasets. We chose the ADE20K dataset because it <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">contains<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the largest number of indoor scenes available in open source.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">As a model for segmentation, we chose the <\/span><\/span><a href=\"https:\/\/arxiv.org\/pdf\/2103.14030.pdf\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">Swin-Transformer<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">,<\/span><\/span><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> introduced in 2021. The transformer<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">’<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">s architecture has shown <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">good results<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> on <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">n<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">a<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">tural <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">l<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">anguage <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">p<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">rocessing (<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">NLP<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">)<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> tasks, and it is also good for processing images. Our tests on the floor class showed <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">an<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">accuracy of 77.8%.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-01.jpg\" id=\"e5vt29apt9jo\" data-image=\"e5vt29apt9jo\" alt=\"Segmentation\"><\/figure><p>&nbsp;<\/p><\/div><\/div>\r\n<\/div>\r\n<\/div>\r\n<div>\r\n<p><b><span data-ccp-charstyle=\"Strong\">1.2 Room layout<\/span><\/b><\/p><p><span data-ccp-charstyle=\"Strong\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">To replace the wall texture, it was necessary to split the wall segmentation mask into segments and <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">determine<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the wall type (front, left or right), since the perspective depended on it. We did this using the layout model. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">This stage was actually a bottleneck because the model often made mistakes.<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> To reduce the amount of these mistakes, we tried all <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">models available in the open-source domain, and finally decided on<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><\/span><a href=\"https:\/\/ieeexplore.ieee.org\/document\/8546278\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">lsun<\/span><span data-ccp-charstyle=\"Hyperlink\">-room<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">.<\/span><\/span><\/span>&nbsp;<\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-02.jpg\" id=\"r7ja3r9jtklf\" data-image=\"r7ja3r9jtklf\" alt=\"Room layout\"><\/figure><p>&nbsp;<\/p><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">The architecture of the model was <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">similar to<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the segmentation model. For a better result, the authors used an adaptive edge penalty in the loss function, which penalized the model for distorted edges.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-03-2.jpg\" id=\"jtx9hjnvbwv4\" data-image=\"jtx9hjnvbwv4\" alt=\"The architecture of the model\"><\/figure><p>&nbsp;<\/p><p><b><span data-ccp-charstyle=\"Strong\">1.3 Vanishing points<\/span><\/b>&nbsp;<br><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">The perspective algorithm was based on finding vanishing points on the image plane. These are the points at which receding parallel lines <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">seem to be<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> meeting when represented in the linear perspective.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-04.jpg\" id=\"vannanm0rl6s\" data-image=\"vannanm0rl6s\" alt=\"Vanishing points\"><\/figure><p>&nbsp;<\/p><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">To search for vanishing points, we tried several algorithms. For example, <\/span><\/span><a href=\"https:\/\/xiaohulugo.github.io\/papers\/Vanishing_Point_Detection_WACV2017.pdf\" target=\"_blank\">XiaohuLuVPDetection<\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> detects lines in the image, and then clusters these lines to get <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">three<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> points. However,<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">problem of false lines<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">still exists<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">, which often results in <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">poor quality<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">So<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> we decided to use an algorithm based on the <\/span><\/span><a href=\"https:\/\/arxiv.org\/pdf\/1910.06316.pdf%22%20\/t%20%22_blank\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">neurvps<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> neural network.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-05.jpg\" id=\"giiu41unpz2t\" data-image=\"giiu41unpz2t\" alt=\"lu-vp-detect \/ neurvps\"><\/figure><p>&nbsp;<\/p><p><i><span data-ccp-charstyle=\"Emphasis\">lu<\/span><span data-ccp-charstyle=\"Emphasis\">-<\/span><span data-ccp-charstyle=\"Emphasis\">vp<\/span><span data-ccp-charstyle=\"Emphasis\">-detect \/ <\/span><span data-ccp-charstyle=\"Emphasis\">neurvps<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/i><\/p><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">The diagram below illustrates the overall structure of the <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">NeurVPS<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> network. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">Tak<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ing<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">an image and a vanishing point as <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">input, the network predicts the probability of a candidate being near a ground-truth vanishing point.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">The network has two parts: a backbone feature extraction network and a conic convolution sub-network. The backbone is a conventional <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">c<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">onvolutional <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">n<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">eural <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">n<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">etwork (<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">CNN<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">)<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> that extracts semantic features from images.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/Luxoft-Charts-Tables-layouts-02-06.jpg\" id=\"o01c4wze0xb8\" data-image=\"o01c4wze0xb8\" alt=\"The overall structure of the NeurVPS network diagram\"><\/figure><p>&nbsp;<\/p><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">On the inference, we had the following algorithm:<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">First<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">,<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> sample N points on the unit sphere and calculate their likelihoods of being the line direction of a vanishing point using the trained neural network classifier. Then pick the top K candidates and sample other N points around each of their neighbors. This step is repeated until we reach the desired resolution.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">The following figure shows unit spheres with candidates. The algorithm gives a good result with<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">in<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">three<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> iterations.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-06.jpg\" id=\"o01c4wze0xb8\" data-image=\"o01c4wze0xb8\" alt=\"algorithm graph\"><\/figure><p>&nbsp;<\/p><p><b><span data-ccp-charstyle=\"Strong\">1.4 Object removal<\/span><\/b>&nbsp;<br><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">To delete objects, at first<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">,<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> we simply replaced them with a new texture. However, there was a problem with <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">shadows, since<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> we could not apply shadows to the objects from the original image.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-07.jpg\" id=\"qu55y7nhsyf3\" data-image=\"qu55y7nhsyf3\" alt=\"Object removal\"><\/figure><p>&nbsp;<\/p><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">So<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> we started looking for other algorithms and finally found <\/span><\/span><a href=\"https:\/\/arxiv.org\/pdf\/2109.07161.pdf%22%20\/t%20%22_blank\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">LaMa<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">. It allows <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">you <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">to <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">highlight objects that need to be removed with a mask and replaces them with a background.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-08.jpg\" id=\"aq3x4o138xh5\" data-image=\"aq3x4o138xh5\" alt=\"LaMa\"><\/figure><p>&nbsp;<\/p>\r\n\r\n<\/div><\/div><\/div>\r\n<h2 class=\"text-24 unscaled\">2. Algorithm    <\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><p><b><span data-ccp-charstyle=\"Strong\">2.1 Texture transfer<\/span><\/b>&nbsp;<br><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Now <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">let’s<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> take a closer look at the algorithm for replacing the surface material using the models described in the <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">previous<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> part.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">At this point, we have found the vanishing points, and now we can <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">apply<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> lines from these points to the floor area to find the bounding lines from each point. We need <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">four<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> points <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">of<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the line intersection<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">s<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">. Now<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">,<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> knowing these points, we feed them to the input of the function that will create a transformation matrix for the texture.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-09.jpg\" id=\"c3j2qsn04oe2\" data-image=\"c3j2qsn04oe2\" alt=\"Texture transfer\"><\/figure><p>&nbsp;<\/p><\/div>\r\n<div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Now we can apply the transformation to the texture. In Perspective Transformation, we need to <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">provide<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the points on the image from which <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">we <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">want to gather information by changing the perspective. <span data-contrast=\"auto\">We also need to provide the points inside which we calculated on the previous step<\/span><\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">. We get the 3×3 matrix of a perspective transform<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ation<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> with <\/span><\/span><i><span data-ccp-charstyle=\"Emphasis\">cv2.getPerspectiveTransform<\/span><\/i><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">At the next step, we apply the resulting transformation matrix to the texture using the <\/span><\/span><i><span data-ccp-charstyle=\"Emphasis\">cv2.warpPerspective<\/span><\/i><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> function.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">And <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">finally<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">, we cut off the excess area <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">using<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the segmentation mask.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-10.jpg\" id=\"wh13h0e1ni8o\" data-image=\"wh13h0e1ni8o\" alt=\"cv2.warpPerspective function\"><\/figure><p>&nbsp;<\/p><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">The wall material is replaced for each wall segment independently:<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"3\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|10\",\"classid\":1073872969,\"properties\":[469775450,\"mi\",201340122,\"2\",134233614,\"true\",469778129,\"mi\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">On the segmentation mask, we separate the wall segment obtained from the layout <\/span><span data-ccp-parastyle=\"mi\">mask<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"3\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">We choose the desired vanishing points, depending on the wall type (left, front, right)<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"3\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">The texture replacement procedure is <\/span><span data-ccp-parastyle=\"mi\">similar to<\/span><span data-ccp-parastyle=\"mi\"> the one used for the <\/span><span data-ccp-parastyle=\"mi\">floor<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><p><b><span data-ccp-charstyle=\"Strong\">2.2 Shadow transfer<\/span><\/b>&nbsp;<br><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">To make the new floor texture realistic, we need to apply shadows and lights from the original image. To <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">do this, we first <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">get<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the floor using a segmentation mask and convert the image to grayscale. Then we apply a blur to remove the texture of the floor and keep only the shadows and lights.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-11.jpg\" id=\"8dvylm7kkvze\" data-image=\"8dvylm7kkvze\" alt=\"Shadow transfer\"><\/figure><p>&nbsp;<\/p><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Using the resulting image, we build a histogram and find the most common shade of gray. We believe that this is the real color of the floor.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/Luxoft-Charts-Tables-layouts-02-04.jpg\" id=\"73cd3kijakse\" data-image=\"73cd3kijakse\" alt=\"Pixel intensity graph\"><\/figure><p>&nbsp;<\/p><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Now we can find the threshold of dark and light areas on the floor. We will assume that a decrease in brightness by 1.5 times will be a shadow, and an increase will be light. We get masks of light and shadow. The figure on the left shows an example of a shadow mask.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">As you can see, we got too sharp an edge, so we need to apply the blur again. To do this, we fill the dark areas inside the floor with the maximum brightness value and apply a blur. For the light mask, the algorithm is the same, but we do not fill in the dark areas.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-12.jpg\" id=\"kersppufnlp3\" data-image=\"kersppufnlp3\" alt=\"graph\"><\/figure><p>&nbsp;<\/p><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">We can now apply masks to the target image.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">First, we will apply a shadow mask. To do this, we convert the shadow mask from grey to RGBA. Next, we put zero in the alpha channel if the pixel is not a shadow. And blend with <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">original image <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">using<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">the multiply <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">blend mode<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">. For a light mask, the algorithm is the same.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-13.jpg\" id=\"im0ldcqtk7xi\" data-image=\"im0ldcqtk7xi\" alt=\"final picture\"><\/figure><p>&nbsp;<\/p><div><div><p><b><span data-ccp-charstyle=\"Strong\">2.1 Adding 3D objects<\/span><\/b>&nbsp;<br><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">To add new objects, we used the <\/span><\/span><a href=\"https:\/\/github.com\/mrdoob\/three.js\/\" target=\"_blank\"><span data-contrast=\"none\"><span data-ccp-charstyle=\"Hyperlink\">Three library.js<\/span><\/span><\/a><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">. Its functionality is <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">similar to<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> conventional 3D editors: adding background, 3D camera, light, 3D objects.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">To add 3D objects to an image, we used the following approach:<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|10\",\"classid\":1073872969,\"properties\":[469775450,\"mi\",201340122,\"2\",134233614,\"true\",469778129,\"mi\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Create a <\/span><span data-ccp-parastyle=\"mi\">scene<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Add an image to the <\/span><span data-ccp-parastyle=\"mi\">background<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Calibrate the 3D camera for images, to preserve the <\/span><span data-ccp-parastyle=\"mi\">perspective<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Add a light <\/span><span data-ccp-parastyle=\"mi\">source<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"4\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\"><span data-ccp-parastyle=\"mi\">Add 3D objects from the <\/span><span data-ccp-parastyle=\"mi\">user<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559685\":1170,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div>\r\n<div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">Using the above algorithm, we faced difficulties in calibrating the camera, since it <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">required<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">additional<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> parameters. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">In<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> the end, we successfully automated this stage.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\">We <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">didn’t<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> find a canned solution for camera calibration, so we had to do it ourselves. After researching camera calibration methods, we found the <\/span><\/span><i><span data-ccp-charstyle=\"Emphasis\">fspy<\/span><\/i><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\"> application. This application allows users to manually set parallel lines, and then export the camera parameters.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-14.jpg\" id=\"7lnimikskyho\" data-image=\"7lnimikskyho\" alt=\"Adding 3D objects\"><\/figure><p>&nbsp;<\/p><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">We managed to find out how the algorithm for calculating camera parameters works, using vanishing points. Since we could calculate the points automatically from the image, user participation was no longer <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">required<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/1696230625_ML-AIgalgorithms-article-05.jpg\" id=\"wjtx95ue4o30\" data-image=\"wjtx95ue4o30\" alt=\"Adding 3D objects graph\"><\/figure><p>&nbsp;<\/p><p><\/p><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">Bringing all the pieces together, we achieved the following results for the interior redesign.<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><p>&nbsp;<\/p><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-15.jpg\" id=\"nj2i6kmsj8nd\" data-image=\"nj2i6kmsj8nd\" alt=\"interior redesign\"><\/figure><figure><img src=\"https:\/\/www.fintego.com\/files\/blog-posts\/2023\/09\/ML\/ML-AIgalgorithms-pic-16.jpg\" id=\"vd3p3ai96p5t\" data-image=\"vd3p3ai96p5t\"><\/figure><\/div><\/div><\/div><\/div><\/div><\/div><\/div>\r\n\r\n<\/div>\r\n<p>&nbsp;<\/p>\r\n<h2 class=\"text-24 unscaled\">Running ML inference with AMD GPU and ROCm     <\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><div><p><span data-contrast=\"none\"><span data-ccp-parastyle=\"pw-post-body-paragraph\" data-ccp-parastyle-defn=\"{\" objectid\":\"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9\",\"classid\":1073872969,\"properties\":[469775450,\"pw-post-body-paragraph\",201340122,\"2\",134233614,\"true\",469778129,\"pw-post-body-paragraph\",335572020,\"1\",469777841,\"times=\"\" new=\"\" roman\",469777842,\"times=\"\" roman\",469777843,\"times=\"\" roman\",469777844,\"times=\"\" roman\",469769226,\"times=\"\" roman\",268442635,\"24\",335559705,\"2057\",335559740,\"240\",201341983,\"0\",134233118,\"true\",134233117,\"true\",469778324,\"normal\"]}\"=\"\">As we mentioned earlier in the article<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">,<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">we <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">had <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">decided to try running our ML inference on AMD GPUs. <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">The following section of <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">this article<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> goes into some detail about that journey an<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">d how using AMD’s GPUs as well as their new <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ROCm<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> capabilities made this <\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\">ML application for room layout editing<\/span><span data-ccp-parastyle=\"pw-post-body-paragraph\"> far more approachable and achievable.&nbsp;<\/span><\/span><span data-ccp-props=\"{\" 134233117\":false,\"134233118\":false,\"201341983\":0,\"335559738\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><div><p><b>System configuration<\/b><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">Our test environment included a single PC with the following configuration:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"8\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\">AMD Ryzen 7<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"8\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\">Vega 20 [Radeon VII]<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"8\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\">Ubuntu 20.04<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><div><p><b>1. Installing required libraries<\/b><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">In Firstly, we installed the ROCm v5.2 library following the <\/span><a href=\"https:\/\/docs.amd.com\/bundle\/ROCm-Installation-Guide-v5.2\/page\/How_to_Install_ROCm.html\" target=\"_blank\"><span data-contrast=\"none\">official instructions<\/span><\/a><span data-contrast=\"none\">:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><pre>sudo apt-get update \r\nwget https:\/\/repo.radeon.com\/amdgpu-install\/22.20\/ubuntu\/focal\/amdgpu-install_22.20.50200-1_all.deb \r\nsudo apt-get install .\/amdgpu-install_22.20.50200–1_all.deb \r\nsudo apt-get update \r\nsudo amdgpu-install - usecase=rocm \r\nsudo reboot <\/pre><div><p><span data-contrast=\"none\">Next, we installed PyTorch as described in <\/span><a href=\"https:\/\/pytorch.org\/get-started\/locally\/\" target=\"_blank\"><span data-contrast=\"none\">their documentation<\/span><\/a><span data-contrast=\"none\">.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">We planned to deploy everything in a Docker container. So, we chose a Docker with pre-installed ROCm libraries and the required version of PyTorch from the official <\/span><a href=\"https:\/\/hub.docker.com\/r\/rocm\/pytorch\" target=\"_blank\">ROCm Docker Hub<\/a><span data-contrast=\"none\">.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">To start the Docker, we followed these steps:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">1.​ ​ ​​Got the image with the required torch=1.11 version from the ROCm Docker hub:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><pre>docker pull rocm\/pytorch:rocm5.2_ubuntu20.04_py3.7_pytorch_1.11.0<\/pre><div><p><span data-contrast=\"none\">​​​Unlike NVIDIA and CUDA, ROCm did not require us to install additional plug-ins for Docker.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">2. After confirming the correctness of the Docker image, we created a custom Docker file inside the project:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><pre>FROM rocm\/pytorch:rocm5.2_ubuntu20.04_py3.7_pytorch_1.11.0  \r\nARG APP_DIR=\/app  \r\nWORKDIR \"$APP_DIR\"  \r\nCOPY . $APP_DIR\/ <\/pre><p><span data-contrast=\"none\">3. Next, we built and started a Docker container using the following command:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><pre>sudo docker run -it --cap-add=SYS_PTRACE --security-opt seccomp=unconfined --device=\/dev\/kfd --device=\/dev\/dri --group-add video --ipc=host --shm-size 8G my_project\/rocm <\/pre><div><p><b>2. Testing models with AMD graphics cards<\/b><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">Now that we had the necessary environment, we were able to load the models and run the inference. For the most part, the process was quite straightforward and smooth. You can find a brief report with our test results, below.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><div><p><b>2.1 <\/b><span data-contrast=\"none\">Vanishing points model<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"9\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Model source<\/b><span data-contrast=\"none\">: <\/span><a href=\"https:\/\/github.com\/zhou13\/neurvps\" target=\"_blank\"><span data-contrast=\"none\">https:\/\/github.com\/zhou13\/neurvps<\/span><\/a><span data-contrast=\"none\"><\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"9\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><b>Details<\/b><span data-contrast=\"none\">: The model uses a custom Deformable Convolution layer loaded via <\/span><i>torch.utils.cpp_extension<\/i><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"9\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><b>Status<\/b><span data-contrast=\"none\">: [Success]<\/span>&nbsp;<br><span data-contrast=\"none\">The model is successfully initialized with the weights loaded. Forward pass does not raise an error<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><div><p><b>2.2 <\/b><span data-contrast=\"none\">Object removal model<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"10\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><b>Model source<\/b><span data-contrast=\"none\">: <\/span><a href=\"https:\/\/github.com\/saic-mdal\/lama\" target=\"_blank\"><span data-contrast=\"none\">https:\/\/github.com\/saic-mdal\/lama<\/span><\/a><span data-contrast=\"none\"><\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"10\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Details<\/b><span data-contrast=\"none\">: The model uses default torch layers<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"10\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><b>Status<\/b><span data-contrast=\"none\">: [Success]<\/span>&nbsp;<br><span data-contrast=\"none\">The model is successfully initialized with the weights loaded. Forward pass does not raise an error<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div>\r\n<div><div><p><b>2.3 <\/b><span data-contrast=\"none\">Room layout model<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"11\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><b>Model source<\/b><span data-contrast=\"none\">: <\/span><a href=\"https:\/\/github.com\/leVirve\/lsun-room\" target=\"_blank\"><span data-contrast=\"none\">https:\/\/github.com\/leVirve\/lsun-room<\/span><\/a><span data-contrast=\"none\"><\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"11\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><b>Details<\/b><span data-contrast=\"none\">: The model uses default torch layers<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"11\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Status<\/b><span data-contrast=\"none\">: [Success]<\/span>&nbsp;<br><span data-contrast=\"none\">The model is successfully initialized with the weights loaded. Forward pass does not raise an error<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div>\r\n<div><div><p><b>2.4 <\/b><span data-contrast=\"none\">Segmentation model<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"12\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><b>Model source<\/b><span data-contrast=\"none\">: <\/span><a href=\"https:\/\/github.com\/open-mmlab\/mmsegmentation\" target=\"_blank\"><span data-contrast=\"none\">https:\/\/github.com\/open-mmlab\/mmsegmentation<\/span><\/a><span data-contrast=\"none\"> [Success]<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"12\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><b>Details<\/b><span data-contrast=\"none\">: We used the SWIN transformer architecture, which showed the best results on indoor segmentation. This model is based on the mmcv framework (3.7k stars) from open-mmlab<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><div><p><span data-contrast=\"none\">The major mmcv features:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div>\r\n<div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"13\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><span data-contrast=\"none\">Various backbones and pre-trained models<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"13\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\">Bag of training tricks<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"13\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"3\" data-aria-level=\"1\"><span data-contrast=\"none\">Large-scale training configs<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"13\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"4\" data-aria-level=\"1\"><span data-contrast=\"none\">High efficiency and extensibility<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"13\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"5\" data-aria-level=\"1\"><span data-contrast=\"none\">Powerful toolkits<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"13\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"1\" data-aria-level=\"1\"><b>Status<\/b><span data-contrast=\"none\">: [Success]<\/span>&nbsp;<br><span data-contrast=\"none\">This model was the hardest task of all because of mmcv<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><\/div><\/div>\r\n<div><div><p><span data-contrast=\"none\">There are two known ways to install mmcv:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><div><ul class=\"unscaled default-ul\"><li data-leveltext=\"\" data-font=\"Symbol\" data-listid=\"14\" data-list-defn-props=\"{\" 335552541\":1,\"335559684\":-2,\"335559685\":720,\"335559991\":360,\"469769226\":\"symbol\",\"469769242\":[8226],\"469777803\":\"left\",\"469777804\":\"\",\"469777815\":\"multilevel\"}\"=\"\" data-aria-posinset=\"2\" data-aria-level=\"1\"><span data-contrast=\"none\">Building mmcv from source. This approach caused an error:<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><pre>File \"\/opt\/conda\/lib\/python3.7\/site-packages\/torch\/utils\/cpp_extension.py\", line 566, in unix_wrap_ninja_compilewith_cuda=with_cuda)File \"\/opt\/conda\/lib\/python3.7\/site-packages\/torch\/utils\/cpp_extension.py\", line 1418, in _write_ninja_file_and_compile_objectserror_prefix='Error compiling objects for extension')File \"\/opt\/conda\/lib\/python3.7\/site-packages\/torch\/utils\/cpp_extension.py\", line 1747, in _run_ninja_buildraise RuntimeError(message) from eRuntimeError: Error compiling objects for extension<\/pre><ul class=\"unscaled default-ul\"><li><span data-contrast=\"none\">Installing pre-built mmcv packages built for a specified CUDA version or CPU only<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559685\":1170,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/li><\/ul><div><p><span data-contrast=\"none\">Since this was the only option left, we decided to use a TorchScript on a PC with CUDA libraries. TorchScript is a good solution for creating serializable and optimizable models from PyTorch code. Any TorchScript can be saved from a Python process and then loaded into a process where there is no Python dependency.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">So, we ended up with an approach that would allow us to port the model code from one PC to another. First, we initialized the model on a PC with an NVIDIA GPU. Next, we generated the model code using <\/span><i>torch.jit.trace<\/i><span data-contrast=\"none\">. And after that, we uploaded the code to the PC with ROCm, so there was no need to install mmcv.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">As a result of our tests, the model was successfully initialized. Forward pass did not raise an error and was the same as on a PC with CUDA.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div><\/div><\/div><\/div><\/div><\/div><\/div><\/div><\/div>\r\n<\/div>\r\n<div>\r\n<p>&nbsp;&nbsp;<\/p>\r\n\r\n<\/div>\r\n<h2 class=\"text-24 unscaled\">Summary      <\/h2>\r\n<p>&nbsp;<\/p>\r\n<div><p><span data-contrast=\"none\">Our research proved that ROCm library covers all the needs for running ML models on AMD GPUs. The standard and custom layers of the PyTorch framework work with no additional changes, which allows experimenting with models and deploying them.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<div><p><span data-contrast=\"none\">Of course, there’s no single solution for all cases, as each project and each model has its own merits. Even though the mmcv framework does not yet include support for ROCm and we faced some difficulties with it, there’re still ways to successfully circumvent these limitations and get the models running.<\/span><span data-ccp-props=\"{\" 201341983\":0,\"335559739\":120,\"335559740\":276}\"=\"\">&nbsp;<\/span><\/p><\/div>\r\n<p>&nbsp;<\/p>\r\n<p>\r\n    &nbsp;\r\n<\/p>","image":{"@type":"ImageObject","url":"https:\/\/www.fintego.com\/files\/blog\/2023\/09\/960x960-GEMS4blog.jpg","width":960,"height":960},"publisher":{"@type":"Organization","url":"https:\/\/www.fintego.com\/","name":"Luxoft","logo":{"@type":"ImageObject","url":"https:\/\/www.fintego.com\/theme\/luxoft\/assets\/images\/logo\/fintego-new-white.svg","width":"188","height":"50"}},"author":[{"@type":"Person","name":"Arthur Shaikhatarov","image":"https:\/\/www.fintego.com\/files\/people\/2023\/09\/Arthur-Shaikhatarov.jpg","url":"https:\/\/www.linkedin.com\/in\/arthur-shaikhatarov-1b358b211\/","jobTitle":"AI\/ML Project Manager, Automotive, Luxoft"}],"datePublished":"2023-10-03T08:39:16+00:00","dateModified":"2025-03-27T11:56:41+00:00"}</script>
    <section class="blog-post-right-column blog-post-right-column__banner">
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-8 col-lg-7 offset-lg-1">
                <h1>ML/AI algorithms for room layout editing </h1>
                <p>Oct 3, 2023
                                             by  <b>Arthur Shaikhatarov</b>                                    </p>
            </div>
            <div class="col-12 col-md-4 col-lg-3 pl-70">
                <div class="blog-post-right-column__banner--social">
                    <ul>
                        <li>
                            <a href="#" class="social-share" data-network="linkedin">
                                <img src="/theme/fintego/assets/images/icons/linkedin.svg" alt="linkedin icon">
                            </a>
                        </li>
                        <li>
                            <a href="#" class="social-share" data-network="fb">
                                <img src="/theme/fintego/assets/images/icons/fb-square.svg" alt="facebook icon">
                            </a>
                        </li>
                        <li>
                            <a href="#" class="social-share" data-network="twitter">
                                <img src="/theme/fintego/assets/images/logo-tw.svg" alt="twitter icon">
                            </a>
                        </li>
                                            </ul>
                </div>
            </div>
        </div>
    </div>
</section>
    <div class="container blog-post-right-column blog-post-right-column__content" id="main-content">
      <div class="row">
        <div class="col-12 col-md-8 col-lg-7 offset-lg-1 text-content">
        <p><section class="container-breadcrumbs--light"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="/"><span>Home</span></a></li><li class="breadcrumb-item"><a href="/blog"><span>Blog</span></a></li><li class="breadcrumb-item active"><span>ML/AI algorithms for room layout editing </span></li></ol></section></p>
<p>
    &nbsp;
</p>
<section class="blog-in-brief">
<p class="blog-in-brief__heading text-20 unscaled">
    In brief
</p>
<ul class="text-18 default-ul unscaled"><li><b></b><b></b><b></b><span data-contrast="auto"></span><span data-contrast="none"></span><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">R</span><span data-ccp-parastyle="pw-post-body-paragraph">unning </span><span data-ccp-parastyle="pw-post-body-paragraph">machine learning (</span><span data-ccp-parastyle="pw-post-body-paragraph">ML</span><span data-ccp-parastyle="pw-post-body-paragraph">)</span><span data-ccp-parastyle="pw-post-body-paragraph"> algorithms and neural networks </span><span data-ccp-parastyle="pw-post-body-paragraph">(NNs) </span><span data-ccp-parastyle="pw-post-body-paragraph">on AMD GPUs has </span><span data-ccp-parastyle="pw-post-body-paragraph">long </span><span data-ccp-parastyle="pw-post-body-paragraph">been a non-trivial task for </span><span data-ccp-parastyle="pw-post-body-paragraph">the </span><span data-ccp-parastyle="pw-post-body-paragraph">typical </span><span data-ccp-parastyle="pw-post-body-paragraph">developer.</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">But the latest AMD </span><span data-ccp-parastyle="pw-post-body-paragraph">ROCm</span><span data-ccp-parastyle="pw-post-body-paragraph"> release introduced </span><span data-ccp-parastyle="pw-post-body-paragraph">a number of</span><span data-ccp-parastyle="pw-post-body-paragraph"> new features and improvements to </span><span data-ccp-parastyle="pw-post-body-paragraph"></span></span>ease the work of ML engineers<span data-contrast="none"></span></li>
    <li><b></b><b></b><b></b><span data-contrast="auto"></span><span data-contrast="none"><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">As part of our research work</span><span data-ccp-parastyle="pw-post-body-paragraph">,</span><span data-ccp-parastyle="pw-post-body-paragraph"> we </span><span data-ccp-parastyle="pw-post-body-paragraph">decided to try running our ML inference on AMD GPUs. In this article, we share our journey about how we applied new ML approaches in our project and used those to run ML models with AMD</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span> </span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span><span data-ccp-props="{" 201341983":0,"335559740":276}"=""></span></li><li><b></b><b></b><span data-contrast="none"></span><span data-contrast="none"></span><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">The core project </span><span data-ccp-parastyle="pw-post-body-paragraph">idea </span><span data-ccp-parastyle="pw-post-body-paragraph">was</span><span data-ccp-parastyle="pw-post-body-paragraph"> to</span><span data-ccp-parastyle="pw-post-body-paragraph"> implement a smart interior editor that would allow users </span><span data-ccp-parastyle="pw-post-body-paragraph">to </span><span data-ccp-parastyle="pw-post-body-paragraph">chang</span><span data-ccp-parastyle="pw-post-body-paragraph">e</span><span data-ccp-parastyle="pw-post-body-paragraph"> their room layout and design in just a </span><span data-ccp-parastyle="pw-post-body-paragraph">few </span><span data-ccp-parastyle="pw-post-body-paragraph">clicks. </span><span data-ccp-parastyle="pw-post-body-paragraph">Read on to find out how we </span><span data-ccp-parastyle="pw-post-body-paragraph">buil</span><span data-ccp-parastyle="pw-post-body-paragraph">t </span><span data-ccp-parastyle="pw-post-body-paragraph">the models with </span><span data-ccp-parastyle="pw-post-body-paragraph">PyTorch</span><span data-ccp-parastyle="pw-post-body-paragraph"> and </span><span data-ccp-parastyle="pw-post-body-paragraph">r</span><span data-ccp-parastyle="pw-post-body-paragraph">a</span><span data-ccp-parastyle="pw-post-body-paragraph">n </span><span data-ccp-parastyle="pw-post-body-paragraph">the code with little </span><span data-ccp-parastyle="pw-post-body-paragraph">additional</span><span data-ccp-parastyle="pw-post-body-paragraph"> porting work</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span><span data-ccp-props="{" 201341983":0,"335559740":276}"=""></span></li>
</ul>
</section>
<p>
    &nbsp;&nbsp;
</p>
<div><div><div><div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">In the past</span><span data-ccp-parastyle="pw-post-body-paragraph">, running ML algorithms and neural networks on AMD GPUs </span><span data-ccp-parastyle="pw-post-body-paragraph">was</span><span data-ccp-parastyle="pw-post-body-paragraph"> a non-trivial task for </span><span data-ccp-parastyle="pw-post-body-paragraph">the</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">ordinary developer. As part of the GEMS AI/ML team at </span><span data-ccp-parastyle="pw-post-body-paragraph">Luxoft</span><span data-ccp-parastyle="pw-post-body-paragraph">, we spend a lot of time working on computer vision and machine learning algorithms. Among other projects, we do internal research and development for AMD — one of our </span><span data-ccp-parastyle="pw-post-body-paragraph">biggest</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">customers.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">Our close collaboration with AMD provides us with </span><span data-ccp-parastyle="pw-post-body-paragraph">early access</span><span data-ccp-parastyle="pw-post-body-paragraph"> to versatile AMD video cards that we use in our research work. Compared to competing hardware, AMD GPUs have </span><span data-ccp-parastyle="pw-post-body-paragraph">numerous</span><span data-ccp-parastyle="pw-post-body-paragraph"> significant advantages in floating-point calculations. And what is more, the latest release of the </span></span><a href="https://github.com/RadeonOpenCompute/ROCm" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">AMD </span><span data-ccp-charstyle="Hyperlink">ROCm</span><span data-ccp-charstyle="Hyperlink">™ open software platform</span></span></a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> introduced support for new features and offered </span><span data-ccp-parastyle="pw-post-body-paragraph">a great number</span><span data-ccp-parastyle="pw-post-body-paragraph"> of improvements</span><span data-ccp-parastyle="pw-post-body-paragraph">&nbsp;</span></span><span data-contrast="auto">to ease the work of ML engineers.</span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"=""></span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">Th</span><span data-ccp-parastyle="pw-post-body-paragraph">is</span><span data-ccp-parastyle="pw-post-body-paragraph"> is why, at some point, we decided to try running our ML inference on AMD GPUs. In this article, we want to share our journey about how we applied new ML approaches in our project and used </span><span data-ccp-parastyle="pw-post-body-paragraph">th</span><span data-ccp-parastyle="pw-post-body-paragraph">em</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">to run ML models with AMD.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div>
</div>
</div>
</div>
<p>&nbsp; &nbsp;</p>
<h2 class="text-24 unscaled">
    Challenge for room layout editing  
</h2>
<p>
    &nbsp;
</p>
<div>
    <div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">The core idea for our latest large project was implementing a smart interior editor that would allow users </span><span data-ccp-parastyle="pw-post-body-paragraph">to </span><span data-ccp-parastyle="pw-post-body-paragraph">chang</span><span data-ccp-parastyle="pw-post-body-paragraph">e</span><span data-ccp-parastyle="pw-post-body-paragraph"> their room layout and design in just a couple of clicks. At </span><span data-ccp-parastyle="pw-post-body-paragraph">a</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">fundamental level, we needed to automate the following processes: </span><span data-ccp-parastyle="pw-post-body-paragraph">P</span><span data-ccp-parastyle="pw-post-body-paragraph">erforming image segmentation, finding frame perspective, </span><span data-ccp-parastyle="pw-post-body-paragraph">determining</span><span data-ccp-parastyle="pw-post-body-paragraph"> room geometry, removing objects within the </span><span data-ccp-parastyle="pw-post-body-paragraph">frame</span><span data-ccp-parastyle="pw-post-body-paragraph"> and adding new 3D models. Additionally, we needed to develop an algorithm that would apply new material texture</span><span data-ccp-parastyle="pw-post-body-paragraph">s</span><span data-ccp-parastyle="pw-post-body-paragraph"> with light and shade effects.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
</div>
</div>
<div>
<p>&nbsp;</p>
</div>
<h2 class="text-24 unscaled">
   Solution brief  
</h2>
<p>
    &nbsp;
</p>
<div>
    <div><div><div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">After studying the subject area and running the first tests, we </span><span data-ccp-parastyle="pw-post-body-paragraph">came up with</span><span data-ccp-parastyle="pw-post-body-paragraph"> the following pipeline for our smart editor:</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ol class="text-18 unscaled"><li data-leveltext="%1." data-font="Calibri" data-listid="7" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|10","classid":1073872969,"properties":[469775450,"mi",201340122,"2",134233614,"true",469778129,"mi",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">First, we should </span><span data-ccp-parastyle="mi">determine</span><span data-ccp-parastyle="mi"> the parameters of the room: </span><span data-ccp-parastyle="mi">C</span><span data-ccp-parastyle="mi">onsider the segmentation mask, layout mask (room geometry) and vanishing points (room perspective)</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="7" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Next, we should find individual objects on the segmentation mask for </span><span data-ccp-parastyle="mi">subsequent</span><span data-ccp-parastyle="mi"> </span><span data-ccp-parastyle="mi">removal</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="7" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Then we can remove existing objects</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="7" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="4" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">After that, we need to apply new textures, materials to the floor and </span><span data-ccp-parastyle="mi">walls</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="7" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="5" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Our next step is transferring shadows from the original image and applying </span><span data-ccp-parastyle="mi">them</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="%1." data-font="Calibri" data-listid="7" data-list-defn-props="{" 335552541":0,"335559684":-1,"335559685":720,"335559991":360,"469769242":[65533,0],"469777803":"left","469777804":"%1.","469777815":"hybridmultilevel"}"="" data-aria-posinset="6" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">And finally, we can calibrate the 3D camera by the vanishing point and add new </span><span data-ccp-parastyle="mi">objects</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ol></div></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">To implement this pipeline, we used machine learning models. In the following </span><span data-ccp-parastyle="pw-post-body-paragraph">portion</span><span data-ccp-parastyle="pw-post-body-paragraph"> of the article, we will describe our network in more detail</span><span data-ccp-parastyle="pw-post-body-paragraph">.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div>
</div>
</div>
<p>&nbsp;&nbsp;</p>
<h2 class="text-24 unscaled">1. Machine learning algorithms   </h2>
<p>&nbsp;</p>
<div><div><div><p><b><span data-ccp-charstyle="Strong">1.1 Segmentation</span></b></p></div>
<div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Segmentation is a well</span><span data-ccp-parastyle="pw-post-body-paragraph">-</span><span data-ccp-parastyle="pw-post-body-paragraph">studied task, so there are </span><span data-ccp-parastyle="pw-post-body-paragraph">a great number</span><span data-ccp-parastyle="pw-post-body-paragraph"> of canned solutions. To compare models for segmentation, we used the </span></span><a href="https://github.com/open-mmlab/mmsegmentation/tree/master/configs/swin%22%20/t%20%22_blank" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">mmseg</span></span></a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> framework. </span><span data-ccp-parastyle="pw-post-body-paragraph">It includes a great number of models for segmentation and weights for various datasets.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">For training and testing models, we used the configuration file approach. This approach allowed us to unify work with different models and datasets. We chose the ADE20K dataset because it </span><span data-ccp-parastyle="pw-post-body-paragraph">contains</span><span data-ccp-parastyle="pw-post-body-paragraph"> the largest number of indoor scenes available in open source.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">As a model for segmentation, we chose the </span></span><a href="https://arxiv.org/pdf/2103.14030.pdf" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">Swin-Transformer</span></span></a><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">,</span></span><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> introduced in 2021. The transformer</span><span data-ccp-parastyle="pw-post-body-paragraph">’</span><span data-ccp-parastyle="pw-post-body-paragraph">s architecture has shown </span><span data-ccp-parastyle="pw-post-body-paragraph">good results</span><span data-ccp-parastyle="pw-post-body-paragraph"> on </span><span data-ccp-parastyle="pw-post-body-paragraph">n</span><span data-ccp-parastyle="pw-post-body-paragraph">a</span><span data-ccp-parastyle="pw-post-body-paragraph">tural </span><span data-ccp-parastyle="pw-post-body-paragraph">l</span><span data-ccp-parastyle="pw-post-body-paragraph">anguage </span><span data-ccp-parastyle="pw-post-body-paragraph">p</span><span data-ccp-parastyle="pw-post-body-paragraph">rocessing (</span><span data-ccp-parastyle="pw-post-body-paragraph">NLP</span><span data-ccp-parastyle="pw-post-body-paragraph">)</span><span data-ccp-parastyle="pw-post-body-paragraph"> tasks, and it is also good for processing images. Our tests on the floor class showed </span><span data-ccp-parastyle="pw-post-body-paragraph">an</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">accuracy of 77.8%.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-01.jpg" id="e5vt29apt9jo" data-image="e5vt29apt9jo" alt="Segmentation"></figure><p>&nbsp;</p></div></div>
</div>
</div>
<div>
<p><b><span data-ccp-charstyle="Strong">1.2 Room layout</span></b></p><p><span data-ccp-charstyle="Strong"><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">To replace the wall texture, it was necessary to split the wall segmentation mask into segments and </span><span data-ccp-parastyle="pw-post-body-paragraph">determine</span><span data-ccp-parastyle="pw-post-body-paragraph"> the wall type (front, left or right), since the perspective depended on it. We did this using the layout model. </span><span data-ccp-parastyle="pw-post-body-paragraph">This stage was actually a bottleneck because the model often made mistakes.</span><span data-ccp-parastyle="pw-post-body-paragraph"> To reduce the amount of these mistakes, we tried all </span><span data-ccp-parastyle="pw-post-body-paragraph">the </span><span data-ccp-parastyle="pw-post-body-paragraph">models available in the open-source domain, and finally decided on</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span></span><a href="https://ieeexplore.ieee.org/document/8546278" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">lsun</span><span data-ccp-charstyle="Hyperlink">-room</span></span></a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">.</span></span></span>&nbsp;</p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-02.jpg" id="r7ja3r9jtklf" data-image="r7ja3r9jtklf" alt="Room layout"></figure><p>&nbsp;</p><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">The architecture of the model was </span><span data-ccp-parastyle="pw-post-body-paragraph">similar to</span><span data-ccp-parastyle="pw-post-body-paragraph"> the segmentation model. For a better result, the authors used an adaptive edge penalty in the loss function, which penalized the model for distorted edges.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-03-2.jpg" id="jtx9hjnvbwv4" data-image="jtx9hjnvbwv4" alt="The architecture of the model"></figure><p>&nbsp;</p><p><b><span data-ccp-charstyle="Strong">1.3 Vanishing points</span></b>&nbsp;<br><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">The perspective algorithm was based on finding vanishing points on the image plane. These are the points at which receding parallel lines </span><span data-ccp-parastyle="pw-post-body-paragraph">seem to be</span><span data-ccp-parastyle="pw-post-body-paragraph"> meeting when represented in the linear perspective.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-04.jpg" id="vannanm0rl6s" data-image="vannanm0rl6s" alt="Vanishing points"></figure><p>&nbsp;</p><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">To search for vanishing points, we tried several algorithms. For example, </span></span><a href="https://xiaohulugo.github.io/papers/Vanishing_Point_Detection_WACV2017.pdf" target="_blank">XiaohuLuVPDetection</a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> detects lines in the image, and then clusters these lines to get </span><span data-ccp-parastyle="pw-post-body-paragraph">three</span><span data-ccp-parastyle="pw-post-body-paragraph"> points. However,</span><span data-ccp-parastyle="pw-post-body-paragraph"> the</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">problem of false lines</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">still exists</span><span data-ccp-parastyle="pw-post-body-paragraph">, which often results in </span><span data-ccp-parastyle="pw-post-body-paragraph">poor quality</span><span data-ccp-parastyle="pw-post-body-paragraph">. </span><span data-ccp-parastyle="pw-post-body-paragraph">So</span><span data-ccp-parastyle="pw-post-body-paragraph"> we decided to use an algorithm based on the </span></span><a href="https://arxiv.org/pdf/1910.06316.pdf%22%20/t%20%22_blank" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">neurvps</span></span></a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> neural network.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-05.jpg" id="giiu41unpz2t" data-image="giiu41unpz2t" alt="lu-vp-detect / neurvps"></figure><p>&nbsp;</p><p><i><span data-ccp-charstyle="Emphasis">lu</span><span data-ccp-charstyle="Emphasis">-</span><span data-ccp-charstyle="Emphasis">vp</span><span data-ccp-charstyle="Emphasis">-detect / </span><span data-ccp-charstyle="Emphasis">neurvps</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></i></p><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">The diagram below illustrates the overall structure of the </span><span data-ccp-parastyle="pw-post-body-paragraph">NeurVPS</span><span data-ccp-parastyle="pw-post-body-paragraph"> network. </span><span data-ccp-parastyle="pw-post-body-paragraph">Tak</span><span data-ccp-parastyle="pw-post-body-paragraph">ing</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">an image and a vanishing point as </span><span data-ccp-parastyle="pw-post-body-paragraph">the</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">input, the network predicts the probability of a candidate being near a ground-truth vanishing point.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">The network has two parts: a backbone feature extraction network and a conic convolution sub-network. The backbone is a conventional </span><span data-ccp-parastyle="pw-post-body-paragraph">c</span><span data-ccp-parastyle="pw-post-body-paragraph">onvolutional </span><span data-ccp-parastyle="pw-post-body-paragraph">n</span><span data-ccp-parastyle="pw-post-body-paragraph">eural </span><span data-ccp-parastyle="pw-post-body-paragraph">n</span><span data-ccp-parastyle="pw-post-body-paragraph">etwork (</span><span data-ccp-parastyle="pw-post-body-paragraph">CNN</span><span data-ccp-parastyle="pw-post-body-paragraph">)</span><span data-ccp-parastyle="pw-post-body-paragraph"> that extracts semantic features from images.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/Luxoft-Charts-Tables-layouts-02-06.jpg" id="o01c4wze0xb8" data-image="o01c4wze0xb8" alt="The overall structure of the NeurVPS network diagram"></figure><p>&nbsp;</p><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">On the inference, we had the following algorithm:</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">First</span><span data-ccp-parastyle="pw-post-body-paragraph">,</span><span data-ccp-parastyle="pw-post-body-paragraph"> sample N points on the unit sphere and calculate their likelihoods of being the line direction of a vanishing point using the trained neural network classifier. Then pick the top K candidates and sample other N points around each of their neighbors. This step is repeated until we reach the desired resolution.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">The following figure shows unit spheres with candidates. The algorithm gives a good result with</span><span data-ccp-parastyle="pw-post-body-paragraph">in</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">three</span><span data-ccp-parastyle="pw-post-body-paragraph"> iterations.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-06.jpg" id="o01c4wze0xb8" data-image="o01c4wze0xb8" alt="algorithm graph"></figure><p>&nbsp;</p><p><b><span data-ccp-charstyle="Strong">1.4 Object removal</span></b>&nbsp;<br><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">To delete objects, at first</span><span data-ccp-parastyle="pw-post-body-paragraph">,</span><span data-ccp-parastyle="pw-post-body-paragraph"> we simply replaced them with a new texture. However, there was a problem with </span><span data-ccp-parastyle="pw-post-body-paragraph">shadows, since</span><span data-ccp-parastyle="pw-post-body-paragraph"> we could not apply shadows to the objects from the original image.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-07.jpg" id="qu55y7nhsyf3" data-image="qu55y7nhsyf3" alt="Object removal"></figure><p>&nbsp;</p><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">So</span><span data-ccp-parastyle="pw-post-body-paragraph"> we started looking for other algorithms and finally found </span></span><a href="https://arxiv.org/pdf/2109.07161.pdf%22%20/t%20%22_blank" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">LaMa</span></span></a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">. It allows </span><span data-ccp-parastyle="pw-post-body-paragraph">you </span><span data-ccp-parastyle="pw-post-body-paragraph">to </span><span data-ccp-parastyle="pw-post-body-paragraph">highlight objects that need to be removed with a mask and replaces them with a background.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-08.jpg" id="aq3x4o138xh5" data-image="aq3x4o138xh5" alt="LaMa"></figure><p>&nbsp;</p>
</div></div></div>
<h2 class="text-24 unscaled">2. Algorithm    </h2>
<p>&nbsp;</p>
<div><p><b><span data-ccp-charstyle="Strong">2.1 Texture transfer</span></b>&nbsp;<br><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Now </span><span data-ccp-parastyle="pw-post-body-paragraph">let’s</span><span data-ccp-parastyle="pw-post-body-paragraph"> take a closer look at the algorithm for replacing the surface material using the models described in the </span><span data-ccp-parastyle="pw-post-body-paragraph">previous</span><span data-ccp-parastyle="pw-post-body-paragraph"> part.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">At this point, we have found the vanishing points, and now we can </span><span data-ccp-parastyle="pw-post-body-paragraph">apply</span><span data-ccp-parastyle="pw-post-body-paragraph"> lines from these points to the floor area to find the bounding lines from each point. We need </span><span data-ccp-parastyle="pw-post-body-paragraph">four</span><span data-ccp-parastyle="pw-post-body-paragraph"> points </span><span data-ccp-parastyle="pw-post-body-paragraph">of</span><span data-ccp-parastyle="pw-post-body-paragraph"> the line intersection</span><span data-ccp-parastyle="pw-post-body-paragraph">s</span><span data-ccp-parastyle="pw-post-body-paragraph">. Now</span><span data-ccp-parastyle="pw-post-body-paragraph">,</span><span data-ccp-parastyle="pw-post-body-paragraph"> knowing these points, we feed them to the input of the function that will create a transformation matrix for the texture.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-09.jpg" id="c3j2qsn04oe2" data-image="c3j2qsn04oe2" alt="Texture transfer"></figure><p>&nbsp;</p></div>
<div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Now we can apply the transformation to the texture. In Perspective Transformation, we need to </span><span data-ccp-parastyle="pw-post-body-paragraph">provide</span><span data-ccp-parastyle="pw-post-body-paragraph"> the points on the image from which </span><span data-ccp-parastyle="pw-post-body-paragraph">we </span><span data-ccp-parastyle="pw-post-body-paragraph">want to gather information by changing the perspective. <span data-contrast="auto">We also need to provide the points inside which we calculated on the previous step</span></span><span data-ccp-parastyle="pw-post-body-paragraph">. We get the 3×3 matrix of a perspective transform</span><span data-ccp-parastyle="pw-post-body-paragraph">ation</span><span data-ccp-parastyle="pw-post-body-paragraph"> with </span></span><i><span data-ccp-charstyle="Emphasis">cv2.getPerspectiveTransform</span></i><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">At the next step, we apply the resulting transformation matrix to the texture using the </span></span><i><span data-ccp-charstyle="Emphasis">cv2.warpPerspective</span></i><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> function.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">And </span><span data-ccp-parastyle="pw-post-body-paragraph">finally</span><span data-ccp-parastyle="pw-post-body-paragraph">, we cut off the excess area </span><span data-ccp-parastyle="pw-post-body-paragraph">using</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">the segmentation mask.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-10.jpg" id="wh13h0e1ni8o" data-image="wh13h0e1ni8o" alt="cv2.warpPerspective function"></figure><p>&nbsp;</p><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">The wall material is replaced for each wall segment independently:</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="3" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|10","classid":1073872969,"properties":[469775450,"mi",201340122,"2",134233614,"true",469778129,"mi",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">On the segmentation mask, we separate the wall segment obtained from the layout </span><span data-ccp-parastyle="mi">mask</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="3" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">We choose the desired vanishing points, depending on the wall type (left, front, right)</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="3" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">The texture replacement procedure is </span><span data-ccp-parastyle="mi">similar to</span><span data-ccp-parastyle="mi"> the one used for the </span><span data-ccp-parastyle="mi">floor</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul><p><b><span data-ccp-charstyle="Strong">2.2 Shadow transfer</span></b>&nbsp;<br><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">To make the new floor texture realistic, we need to apply shadows and lights from the original image. To </span><span data-ccp-parastyle="pw-post-body-paragraph">do this, we first </span><span data-ccp-parastyle="pw-post-body-paragraph">get</span><span data-ccp-parastyle="pw-post-body-paragraph"> the floor using a segmentation mask and convert the image to grayscale. Then we apply a blur to remove the texture of the floor and keep only the shadows and lights.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-11.jpg" id="8dvylm7kkvze" data-image="8dvylm7kkvze" alt="Shadow transfer"></figure><p>&nbsp;</p><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Using the resulting image, we build a histogram and find the most common shade of gray. We believe that this is the real color of the floor.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/Luxoft-Charts-Tables-layouts-02-04.jpg" id="73cd3kijakse" data-image="73cd3kijakse" alt="Pixel intensity graph"></figure><p>&nbsp;</p><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Now we can find the threshold of dark and light areas on the floor. We will assume that a decrease in brightness by 1.5 times will be a shadow, and an increase will be light. We get masks of light and shadow. The figure on the left shows an example of a shadow mask.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">As you can see, we got too sharp an edge, so we need to apply the blur again. To do this, we fill the dark areas inside the floor with the maximum brightness value and apply a blur. For the light mask, the algorithm is the same, but we do not fill in the dark areas.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-12.jpg" id="kersppufnlp3" data-image="kersppufnlp3" alt="graph"></figure><p>&nbsp;</p><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">We can now apply masks to the target image.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">First, we will apply a shadow mask. To do this, we convert the shadow mask from grey to RGBA. Next, we put zero in the alpha channel if the pixel is not a shadow. And blend with </span><span data-ccp-parastyle="pw-post-body-paragraph">the </span><span data-ccp-parastyle="pw-post-body-paragraph">original image </span><span data-ccp-parastyle="pw-post-body-paragraph">using</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">the multiply </span><span data-ccp-parastyle="pw-post-body-paragraph">blend mode</span><span data-ccp-parastyle="pw-post-body-paragraph">. For a light mask, the algorithm is the same.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-13.jpg" id="im0ldcqtk7xi" data-image="im0ldcqtk7xi" alt="final picture"></figure><p>&nbsp;</p><div><div><p><b><span data-ccp-charstyle="Strong">2.1 Adding 3D objects</span></b>&nbsp;<br><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">To add new objects, we used the </span></span><a href="https://github.com/mrdoob/three.js/" target="_blank"><span data-contrast="none"><span data-ccp-charstyle="Hyperlink">Three library.js</span></span></a><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">. Its functionality is </span><span data-ccp-parastyle="pw-post-body-paragraph">similar to</span><span data-ccp-parastyle="pw-post-body-paragraph"> conventional 3D editors: adding background, 3D camera, light, 3D objects.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">To add 3D objects to an image, we used the following approach:</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="4" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|10","classid":1073872969,"properties":[469775450,"mi",201340122,"2",134233614,"true",469778129,"mi",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Create a </span><span data-ccp-parastyle="mi">scene</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="4" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Add an image to the </span><span data-ccp-parastyle="mi">background</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="4" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Calibrate the 3D camera for images, to preserve the </span><span data-ccp-parastyle="mi">perspective</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="4" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Add a light </span><span data-ccp-parastyle="mi">source</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="4" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none"><span data-ccp-parastyle="mi">Add 3D objects from the </span><span data-ccp-parastyle="mi">user</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559685":1170,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div>
<div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">Using the above algorithm, we faced difficulties in calibrating the camera, since it </span><span data-ccp-parastyle="pw-post-body-paragraph">required</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">additional</span><span data-ccp-parastyle="pw-post-body-paragraph"> parameters. </span><span data-ccp-parastyle="pw-post-body-paragraph">In</span><span data-ccp-parastyle="pw-post-body-paragraph"> the end, we successfully automated this stage.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph">We </span><span data-ccp-parastyle="pw-post-body-paragraph">didn’t</span><span data-ccp-parastyle="pw-post-body-paragraph"> find a canned solution for camera calibration, so we had to do it ourselves. After researching camera calibration methods, we found the </span></span><i><span data-ccp-charstyle="Emphasis">fspy</span></i><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph"> application. This application allows users to manually set parallel lines, and then export the camera parameters.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-14.jpg" id="7lnimikskyho" data-image="7lnimikskyho" alt="Adding 3D objects"></figure><p>&nbsp;</p><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">We managed to find out how the algorithm for calculating camera parameters works, using vanishing points. Since we could calculate the points automatically from the image, user participation was no longer </span><span data-ccp-parastyle="pw-post-body-paragraph">required</span><span data-ccp-parastyle="pw-post-body-paragraph">.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/1696230625_ML-AIgalgorithms-article-05.jpg" id="wjtx95ue4o30" data-image="wjtx95ue4o30" alt="Adding 3D objects graph"></figure><p>&nbsp;</p><p></p><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">Bringing all the pieces together, we achieved the following results for the interior redesign.</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><p>&nbsp;</p><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-15.jpg" id="nj2i6kmsj8nd" data-image="nj2i6kmsj8nd" alt="interior redesign"></figure><figure><img src="/files/blog-posts/2023/09/ML/ML-AIgalgorithms-pic-16.jpg" id="vd3p3ai96p5t" data-image="vd3p3ai96p5t"></figure></div></div></div></div></div></div></div>
</div>
<p>&nbsp;</p>
<h2 class="text-24 unscaled">Running ML inference with AMD GPU and ROCm     </h2>
<p>&nbsp;</p>
<div><div><p><span data-contrast="none"><span data-ccp-parastyle="pw-post-body-paragraph" data-ccp-parastyle-defn="{" objectid":"52d6a7ac-acd8-484c-bab5-0ebf4d181a08|9","classid":1073872969,"properties":[469775450,"pw-post-body-paragraph",201340122,"2",134233614,"true",469778129,"pw-post-body-paragraph",335572020,"1",469777841,"times="" new="" roman",469777842,"times="" roman",469777843,"times="" roman",469777844,"times="" roman",469769226,"times="" roman",268442635,"24",335559705,"2057",335559740,"240",201341983,"0",134233118,"true",134233117,"true",469778324,"normal"]}"="">As we mentioned earlier in the article</span><span data-ccp-parastyle="pw-post-body-paragraph">,</span><span data-ccp-parastyle="pw-post-body-paragraph"> </span><span data-ccp-parastyle="pw-post-body-paragraph">we </span><span data-ccp-parastyle="pw-post-body-paragraph">had </span><span data-ccp-parastyle="pw-post-body-paragraph">decided to try running our ML inference on AMD GPUs. </span><span data-ccp-parastyle="pw-post-body-paragraph">The following section of </span><span data-ccp-parastyle="pw-post-body-paragraph">this article</span><span data-ccp-parastyle="pw-post-body-paragraph"> goes into some detail about that journey an</span><span data-ccp-parastyle="pw-post-body-paragraph">d how using AMD’s GPUs as well as their new </span><span data-ccp-parastyle="pw-post-body-paragraph">ROCm</span><span data-ccp-parastyle="pw-post-body-paragraph"> capabilities made this </span><span data-ccp-parastyle="pw-post-body-paragraph">ML application for room layout editing</span><span data-ccp-parastyle="pw-post-body-paragraph"> far more approachable and achievable.&nbsp;</span></span><span data-ccp-props="{" 134233117":false,"134233118":false,"201341983":0,"335559738":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><div><p><b>System configuration</b><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">Our test environment included a single PC with the following configuration:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="8" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">AMD Ryzen 7</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="8" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none">Vega 20 [Radeon VII]</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="8" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none">Ubuntu 20.04</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul><div><p><b>1. Installing required libraries</b><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">In Firstly, we installed the ROCm v5.2 library following the </span><a href="https://docs.amd.com/bundle/ROCm-Installation-Guide-v5.2/page/How_to_Install_ROCm.html" target="_blank"><span data-contrast="none">official instructions</span></a><span data-contrast="none">:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><pre>sudo apt-get update 
wget https://repo.radeon.com/amdgpu-install/22.20/ubuntu/focal/amdgpu-install_22.20.50200-1_all.deb 
sudo apt-get install ./amdgpu-install_22.20.50200–1_all.deb 
sudo apt-get update 
sudo amdgpu-install - usecase=rocm 
sudo reboot </pre><div><p><span data-contrast="none">Next, we installed PyTorch as described in </span><a href="https://pytorch.org/get-started/locally/" target="_blank"><span data-contrast="none">their documentation</span></a><span data-contrast="none">.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">We planned to deploy everything in a Docker container. So, we chose a Docker with pre-installed ROCm libraries and the required version of PyTorch from the official </span><a href="https://hub.docker.com/r/rocm/pytorch" target="_blank">ROCm Docker Hub</a><span data-contrast="none">.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">To start the Docker, we followed these steps:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">1.​ ​ ​​Got the image with the required torch=1.11 version from the ROCm Docker hub:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><pre>docker pull rocm/pytorch:rocm5.2_ubuntu20.04_py3.7_pytorch_1.11.0</pre><div><p><span data-contrast="none">​​​Unlike NVIDIA and CUDA, ROCm did not require us to install additional plug-ins for Docker.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">2. After confirming the correctness of the Docker image, we created a custom Docker file inside the project:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><pre>FROM rocm/pytorch:rocm5.2_ubuntu20.04_py3.7_pytorch_1.11.0  
ARG APP_DIR=/app  
WORKDIR "$APP_DIR"  
COPY . $APP_DIR/ </pre><p><span data-contrast="none">3. Next, we built and started a Docker container using the following command:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><pre>sudo docker run -it --cap-add=SYS_PTRACE --security-opt seccomp=unconfined --device=/dev/kfd --device=/dev/dri --group-add video --ipc=host --shm-size 8G my_project/rocm </pre><div><p><b>2. Testing models with AMD graphics cards</b><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">Now that we had the necessary environment, we were able to load the models and run the inference. For the most part, the process was quite straightforward and smooth. You can find a brief report with our test results, below.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p><div><p><b>2.1 </b><span data-contrast="none">Vanishing points model</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="9" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Model source</b><span data-contrast="none">: </span><a href="https://github.com/zhou13/neurvps" target="_blank"><span data-contrast="none">https://github.com/zhou13/neurvps</span></a><span data-contrast="none"></span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="9" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><b>Details</b><span data-contrast="none">: The model uses a custom Deformable Convolution layer loaded via </span><i>torch.utils.cpp_extension</i><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="9" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><b>Status</b><span data-contrast="none">: [Success]</span>&nbsp;<br><span data-contrast="none">The model is successfully initialized with the weights loaded. Forward pass does not raise an error</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div><div><p><b>2.2 </b><span data-contrast="none">Object removal model</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="10" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="4" data-aria-level="1"><b>Model source</b><span data-contrast="none">: </span><a href="https://github.com/saic-mdal/lama" target="_blank"><span data-contrast="none">https://github.com/saic-mdal/lama</span></a><span data-contrast="none"></span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="10" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Details</b><span data-contrast="none">: The model uses default torch layers</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="10" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><b>Status</b><span data-contrast="none">: [Success]</span>&nbsp;<br><span data-contrast="none">The model is successfully initialized with the weights loaded. Forward pass does not raise an error</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div>
<div><div><p><b>2.3 </b><span data-contrast="none">Room layout model</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="11" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><b>Model source</b><span data-contrast="none">: </span><a href="https://github.com/leVirve/lsun-room" target="_blank"><span data-contrast="none">https://github.com/leVirve/lsun-room</span></a><span data-contrast="none"></span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="11" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="4" data-aria-level="1"><b>Details</b><span data-contrast="none">: The model uses default torch layers</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="11" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Status</b><span data-contrast="none">: [Success]</span>&nbsp;<br><span data-contrast="none">The model is successfully initialized with the weights loaded. Forward pass does not raise an error</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div>
<div><div><p><b>2.4 </b><span data-contrast="none">Segmentation model</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="12" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><b>Model source</b><span data-contrast="none">: </span><a href="https://github.com/open-mmlab/mmsegmentation" target="_blank"><span data-contrast="none">https://github.com/open-mmlab/mmsegmentation</span></a><span data-contrast="none"> [Success]</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="12" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><b>Details</b><span data-contrast="none">: We used the SWIN transformer architecture, which showed the best results on indoor segmentation. This model is based on the mmcv framework (3.7k stars) from open-mmlab</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div><div><p><span data-contrast="none">The major mmcv features:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div>
<div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="13" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">Various backbones and pre-trained models</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="13" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none">Bag of training tricks</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="13" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none">Large-scale training configs</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="13" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="4" data-aria-level="1"><span data-contrast="none">High efficiency and extensibility</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="13" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="5" data-aria-level="1"><span data-contrast="none">Powerful toolkits</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li><li data-leveltext="" data-font="Symbol" data-listid="13" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="1" data-aria-level="1"><b>Status</b><span data-contrast="none">: [Success]</span>&nbsp;<br><span data-contrast="none">This model was the hardest task of all because of mmcv</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul></div></div>
<div><div><p><span data-contrast="none">There are two known ways to install mmcv:</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div><div><ul class="unscaled default-ul"><li data-leveltext="" data-font="Symbol" data-listid="14" data-list-defn-props="{" 335552541":1,"335559684":-2,"335559685":720,"335559991":360,"469769226":"symbol","469769242":[8226],"469777803":"left","469777804":"","469777815":"multilevel"}"="" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none">Building mmcv from source. This approach caused an error:</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul><pre>File "/opt/conda/lib/python3.7/site-packages/torch/utils/cpp_extension.py", line 566, in unix_wrap_ninja_compilewith_cuda=with_cuda)File "/opt/conda/lib/python3.7/site-packages/torch/utils/cpp_extension.py", line 1418, in _write_ninja_file_and_compile_objectserror_prefix='Error compiling objects for extension')File "/opt/conda/lib/python3.7/site-packages/torch/utils/cpp_extension.py", line 1747, in _run_ninja_buildraise RuntimeError(message) from eRuntimeError: Error compiling objects for extension</pre><ul class="unscaled default-ul"><li><span data-contrast="none">Installing pre-built mmcv packages built for a specified CUDA version or CPU only</span><span data-ccp-props="{" 201341983":0,"335559685":1170,"335559739":120,"335559740":276}"="">&nbsp;</span></li></ul><div><p><span data-contrast="none">Since this was the only option left, we decided to use a TorchScript on a PC with CUDA libraries. TorchScript is a good solution for creating serializable and optimizable models from PyTorch code. Any TorchScript can be saved from a Python process and then loaded into a process where there is no Python dependency.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">So, we ended up with an approach that would allow us to port the model code from one PC to another. First, we initialized the model on a PC with an NVIDIA GPU. Next, we generated the model code using </span><i>torch.jit.trace</i><span data-contrast="none">. And after that, we uploaded the code to the PC with ROCm, so there was no need to install mmcv.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">As a result of our tests, the model was successfully initialized. Forward pass did not raise an error and was the same as on a PC with CUDA.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div></div></div></div></div></div></div></div></div>
</div>
<div>
<p>&nbsp;&nbsp;</p>
</div>
<h2 class="text-24 unscaled">Summary      </h2>
<p>&nbsp;</p>
<div><p><span data-contrast="none">Our research proved that ROCm library covers all the needs for running ML models on AMD GPUs. The standard and custom layers of the PyTorch framework work with no additional changes, which allows experimenting with models and deploying them.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<div><p><span data-contrast="none">Of course, there’s no single solution for all cases, as each project and each model has its own merits. Even though the mmcv framework does not yet include support for ROCm and we faced some difficulties with it, there’re still ways to successfully circumvent these limitations and get the models running.</span><span data-ccp-props="{" 201341983":0,"335559739":120,"335559740":276}"="">&nbsp;</span></p></div>
<p>&nbsp;</p>
<p>
    &nbsp;
</p>
            <section class="enhanced-blog-author blog-post-right-column">
        <div class="quote-container">
            <div class="quote">
                                                            <div class="quote__content">
                                                        <div class="author-image">
                                <figure>
                                    <img src="/files/people/2023/09/Arthur-Shaikhatarov.jpg" class="picture" alt="Arthur Shaikhatarov , AI/ML Project Manager, Automotive, Luxoft ">
                                </figure>
                            </div>
                                                        <div class="author-content">
                                <h3 class="author-name d-flex align-items-center text-20 unscaled">
                                                                            Arthur Shaikhatarov
                                                                                                                <a href="https://www.linkedin.com/in/arthur-shaikhatarov-1b358b211/" target="_blank">
                                            <img src="/theme/fintego/assets/images/icons/linkedin-gray24x24.svg" alt="author linkedin">
                                        </a>
                                                                    </h3>
                                <p class="author-title text-16 unscaled">AI/ML Project Manager, Automotive, Luxoft </p>
                                <p class="text-16 unscaled">Arthur has served as project manager specializing in AI/ML initiatives at Luxoft for 4 years. His journey in artificial intelligence and machine learning began as an engineer, where he honed his skills and knowledge. Arthur is responsible for team management and formation, presales activities for ML projects, the orchestration and execution of AI/ML proofs-of-concept and the growth of AI/ML activities within Luxoft. </p>
                            </div>
                        </div>
                                                </div>
        </div>
    </section>
        </div>
        <div class="col-12 col-md-4 col-lg-3 d-none d-md-block pl-70">
          <div class="blog-post-right-column__right-column ">
            <div class="blog-post-right-column blog-post-right-column__authors">
                        <div class="item">
                                <div class="image">
                    <figure>
                        <img src="/files/people/2023/09/Arthur-Shaikhatarov.jpg" class="picture" alt="Arthur Shaikhatarov , AI/ML Project Manager, Automotive, Luxoft ">
                    </figure>
                </div>
                                <div class="text">
                    <h3 class="author-name d-flex align-items-center text-16 unscaled">
                                                    Arthur Shaikhatarov
                                                                            <a href="https://www.linkedin.com/in/arthur-shaikhatarov-1b358b211/" target="_blank">
                                <img src="/theme/fintego/assets/images/icons/linkedin-gray24x24.svg" class="author-linkedin" alt="author linkedin">
                            </a>
                                            </h3>
                    <p class="author-title text-14 unscaled">AI/ML Project Manager, Automotive, Luxoft </p>
                </div>
            </div>
            </div>
            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><?xml encoding="utf-8" ?><html><body><div class="container"><div class="related-content">
								<div class="related-content__title">
									<p class="text-20 fs-4 unscaled">Related content</p>
								</div>
								<div class="related-content__items">
											<div class="item">
    <div class="item--image">
      <figure>
        <img src="/files/blog/2023/08/431955-CIS-CIS-blog-page-2-Blog-banner-960x960px-2023-07-27.jpg" alt="Mastering MLOps practices for a trading bot">
      </figure>
    </div>
    <div class="item--title">
      <a href="/blog/mastering-mlops-for-trading-bots" class="stretched-link" aria-label="Mastering MLOps practices for a trading bot ">
        <p class="text-20 unscaled fw-bold">
            Mastering MLOps practices for a trading bot 
        </p>
      </a>
    </div>
</div>
													</div>
							</div></div></body></html>
          </div>
        </div>
      </div>
    </div>
    <div class="blog-post-right-column__related-content">
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml encoding="utf-8" ?><html><body><div class="related-content-snippet container"><div class="row title"><div class="col text-center"><div class="text-28 fs-2 unscaled">Related content</div></div></div><div class="row">
<div class="col"><div class="related-content-snippet__item"><div class="related-content-snippet__item--image"><figure><img src="/files/blog/2023/08/431955-CIS-CIS-blog-page-2-Blog-banner-960x960px-2023-07-27.jpg" alt="Mastering MLOps practices for a trading bot"></figure></div><div class="related-content-snippet__item--content"><a href="/blog/mastering-mlops-for-trading-bots"><div class="stretched-link"><b class="text-18 unscaled">Mastering MLOps practices for a trading bot</b></div></a><p class="text-16 unscaled">by Arthur Shaikhatarov</p></div></div></div><div class="col"><div class="related-content-snippet__item"><div class="related-content-snippet__item--image"><figure><img src="/files/blog/2023/10/433541-FS-GEMS-blog-5-Machine-Learning-with-Microsoft-Azure-KV4-jpg-1.jpg" alt="Machine learning with Microsoft Azure Monitoring machine learning models in production"></figure></div><div class="related-content-snippet__item--content"><a href="/blog/master-mlops-with-azure-deploy-monitor-ml-models"><div class="stretched-link"><b class="text-18 unscaled">Machine learning with Microsoft Azure Monitoring machine learning models in production
</b></div></a><p class="text-16 unscaled">by  Arthur Shaikhatarov, Suraj Manjunatha</p></div></div></div>
<div class="col"><div class="related-content-snippet__item"><div class="related-content-snippet__item--image"><figure><img src="/files/services/computer-vision/header-banner.jpg" alt="Computer vision"></figure></div><div class="related-content-snippet__item--content"><a href="/services/computer-vision"><div class="stretched-link"><b class="text-18 unscaled">Computer vision
</b></div></a></div></div></div></div></div></body></html>
    </div>
        <div id="back-to-top-btn" class="back-to-top-btn">
            <button type="button">
                <img src="/theme/fintego/assets/images/arrow-down.svg" alt="back to top icon">
            </button>
        </div>
                                                                            <div id="page-industries" class="industry-Banking-and-Capital-Markets "></div>
                                                                        <div id="page-services" class="service-Data-Analytics "></div>
        <footer class="footer">
    <div class="container pt-10">
        <div class="row">
            <div class="col-12 col-lg-3 footer__col-contact">
                <p class="text-white paragraph-as-5">Enable your digital advantage with Luxoft</p>
                <a class="btn btn-outline" id="button-addon2" type="button" href="/contact-form">
                    Connect with us
                </a>
                <ul class="footer__social-networks">
                    <li>
                        <a href="https://www.facebook.com/Luxoft" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-fb.svg" alt="facebook icon">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.youtube.com/channel/UCDtOIqWxKHTdtmVi8yr_D7Q" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-yt.svg" alt="youtube icon">
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/Luxoft" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-tw.svg" alt="twitter icon">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/companies/luxoft" target="_blank" rel="noreferer, noopener">
                            <img src="/theme/fintego/assets/images/logo-in.svg" alt="linkedin icon">
                        </a>
                    </li>
                </ul>
            </div>
            <div class="col-12 col-lg-3 footer__menu mt-0">
    <div class="menu-section">
        <p class="mb-3 overline menu-section--title">
            Discover Luxoft
        </p>
        <ul>
            <li>
                <a href="/about-us">About Us</a>
            </li>
            <li>
                <a href="https://career.fintego.com/">Careers</a>
            </li>
            <li>
                <a href="/contact-form">Contact Us</a>
            </li>
            <li>
                <a href="/event">Events</a>
            </li>
            <li>
                <a href="/esg">Environmental, Social and Governance</a>
            </li>
            <li>
                <a href="/global-presence">Global Presence</a>
            </li>
            <li>
                <a href="/insights">Insights</a>
            </li>
            <li>
                <a href="/pr">Newsroom</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapsePartnerships"
                                aria-controls="collapsePartnerships"
                                aria-expanded="false">
                                Partnerships
                        </button>
                    </p>
                    <div id="collapsePartnerships" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/partners">Luxoft's partners</a>
                                </li>
                                <li>
                                    <a href="/partners/nasdaq">Nasdaq</a>
                                </li>
                                <li>
                                    <a href="/partners/appian">Appian</a>
                                </li>
                                <li>
                                    <a href="/partners/aws">AWS</a>
                                </li>
                                <li>
                                    <a href="/partners/clm">Fenergo</a>
                                </li>
                                <li>
                                    <a href="/partners/finastra">Finastra</a>
                                </li>
                                <li>
                                    <a href="/partners/goldensource">GoldenSource</a>
                                </li>
                                <li>
                                    <a href="/partners/itrs">ITRS</a>
                                </li>
                                <li>
                                    <a href="/partners/microsoft">Microsoft</a>
                                </li>
                                <li>
                                    <a href="/partners/moodys">Moody's Analytics</a>
                                </li>
                                <li>
                                    <a href="/partners/murex">Murex</a>
                                </li>
                                <li>
                                    <a href="/partners/orchestrade">Orchestrade</a>
                                </li>
                                <li>
                                    <a href="/partners/pega">Pega</a>
                                </li>
                                <li>
                                    <a href="/partners/planixs">Planixs</a>
                                </li>
                                <li>
                                    <a href="/partners/smartstream">SmartStream</a>
                                </li>
                                <li>
                                    <a href="/partners/temenos">Temenos</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/ukraine-updates">Ukraine updates</a>
            </li>
        </ul>
    </div>
</div>
<div class="col-12 col-lg-3 footer__menu mt-0">
    <div class="menu-section">
        <p class="mb-3 overline menu-section--title">
            Services
        </p>
        <ul>
            <li>
                <a href="/services/cloud-solutions">Cloud Solutions</a>
            </li>
            <li>
                <a href="/services/data-to-insights">Data Analytics</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseDesign"
                                aria-controls="collapseDesign"
                                aria-expanded="false">
                                Design
                        </button>
                    </p>
                    <div id="collapseDesign" class="accordion-collapse collapse">
                        <div class="accordion-body smallest">
                            <ul>
                                <li>
                                    <a href="/services/design">Design services</a>
                                </li>
                                <li>
                                    <a href="/services/innovation-strategy">Innovation strategy</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseFrontendDevelopment"
                                aria-controls="collapseFrontendDevelopment"
                                aria-expanded="false">
                            Front-end Development
                        </button>
                    </p>
                    <div id="collapseFrontendDevelopment" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/services/front-end-development">Front-end development services</a>
                                </li>
                                <li>
                                    <a href="/services/mobile-app-development">Mobile Development</a>
                                </li>
                                <li>
                                    <a href="/services/web-development">Web Development</a>
                                </li>
                                <li>
                                    <a href="/services/3d-ar-vr-development">3D, AR and VR Development</a>
                                </li>
                                <li>
                                    <a href="/services/web-architecture">Web/Cloud Architecture</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseIntelligentAutomation"
                                aria-controls="collapseIntelligentAutomation"
                                aria-expanded="false">
                            Intelligent Automation
                        </button>
                    </p>
                    <div id="collapseIntelligentAutomation" class="accordion-collapse collapse">
                        <div class="accordion-body smallest">
                            <ul>
                                <li>
                                    <a href="/services/intelligent-automation">Intelligent automation services</a>
                                </li>
                                <li>
                                    <a href="/services/low-code-development">Low-code development</a>
                                </li>
                                <li>
                                    <a href="/services/robotic-process-automation">Robotic process automation (RPA) services</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseLegacyModernization"
                                aria-controls="collapseLegacyModernization"
                                aria-expanded="false">
                            Legacy Modernization
                        </button>
                    </p>
                    <div id="collapseLegacyModernization" class="accordion-collapse collapse">
                        <div class="accordion-body smallest">
                            <ul>
                                <li>
                                    <a href="/services/legacy-modernization">Legacy modernization services</a>
                                </li>
                                <li>
                                    <a href="/services/mainframe-modernization">Mainframe modernization</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/services/beyond">Luxoft Beyond</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseMachineLearning"
                                aria-controls="collapseMachineLearning"
                                aria-expanded="false">
                                Machine Learning
                        </button>
                    </p>
                    <div id="collapseMachineLearning" class="accordion-collapse collapse">
                        <div class="accordion-body small">
                            <ul>
                                <li>
                                    <a href="/services/machine-learning">Machine learning services</a>
                                </li>
                                <li>
                                    <a href="/services/computer-vision">Computer vision</a>
                                </li>
                                <li>
                                    <a href="/services/natural-language-processing">Natural language processing</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseSoftwareEngineering"
                                aria-controls="collapseSoftwareEngineering"
                                aria-expanded="false">
                                Software Engineering
                        </button>
                    </p>
                    <div id="collapseSoftwareEngineering" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/services/engineering-services">Software engineering services</a>
                                </li>
                                <li>
                                    <a href="/services/financial-software-development">Financial software development</a>
                                </li>
                                <li>
                                    <a href="/services/qa-automation">QA automation</a>
                                </li>
                                <li>
                                    <a href="/services/trading-software-development">Trading software development</a>
                                </li>
                                <li>
                                    <a href="/services/software-development-outsourcing">Software development outsourcing</a>
                                </li>
                                <li>
                                    <a href="/services/custom-software-development">Custom software development</a>
                                </li>
                                <li>
                                    <a href="/services/application-engineering-services">Application engineering services</a>
                                </li>
                                <li>
                                    <a href="/services/bespoke-software-development">Bespoke software development</a>
                                </li>
                                <li>
                                    <a href="/services/product-engineering-services">Product engineering services</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<div class="col-12 col-lg-3 footer__menu mt-0">
    <div class="menu-section">
        <p class="mb-3 overline menu-section--title">
            Industries
        </p>
        <ul>
            <li>
                <a href="/industries/automotive">Automotive</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseBanking"
                                aria-controls="collapseBanking"
                                aria-expanded="false">
                                Banking
                        </button>
                    </p>
                    <div id="collapseBanking" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/industries/banking">IT services for banking</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/boomerang">Boomerang software</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/cloud">Cloud banking services</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/connected-wealth">Wealth management solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/core-banking">Core banking software</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/earlyresolution">EarlyResolution</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/earlyresolution/auto-loan">EarlyResolution auto loan</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/earlyresolution/borrower-portal">EarlyResolution borrower portal</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan">Hogan banking system</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/health-check">Hogan health check</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/hybrid-cloud">Hogan hybrid cloud</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/hogan-io">Hogan io</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/academy">Hogan academy</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/hogan/managed-services">Hogan managed services</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/luxoft-banking-transformation-advisory">Banking transformation advisory</a>
                                </li>
                                <li>
                                    <a href="/industries/banking/luxoft-cams">CAMS card processing solution</a>
                                </li>
                                <li>
                                    <a href="/partners/temenos/health-check">Temenos health check</a>
                                </li>
                                <li>
                                    <a href="/partners/temenos/upgrades">Temenos upgrade</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseCapitalMarkets"
                                aria-controls="collapseCapitalMarkets"
                                aria-expanded="false">
                                Capital Markets
                        </button>
                    </p>
                    <div id="collapseCapitalMarkets" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/industries/capital-markets">Capital markets technology solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/clm-consultancy">CLM solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/energy-and-commodity">Energy and commodity trading</a>
                                </li>
                                <li>
                                    <a href="/partners/goldensource">GoldenSource client services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/liquidity-management">Liquidity management services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/reconciliation-solution">Reconciliation solution</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/regtech-solutions">Regtech in financial services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/regulatory-reporting">Regulatory reporting services</a>
                                </li>
                                <li>
                                    <a href="/industries/capital-markets/treasury-solutions">Corporate treasury solutions</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/industries/consumer-goods">Consumer Goods</a>
            </li>
            <li>
                <a href="/industries/energy-and-utilities">Energy and Utilities</a>
            </li>
            <li>
                <a href="/industries/healthcare">Healthcare and Life Sciences</a>
            </li>
            <li>
                <div class="accordion-item">
                    <p class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapseInsurance"
                                aria-controls="collapseInsurance"
                                aria-expanded="false">
                            Insurance
                        </button>
                    </p>
                    <div id="collapseInsurance" class="accordion-collapse collapse">
                        <div class="accordion-body">
                            <ul>
                                <li>
                                    <a href="/industries/insurance">Insurance technology solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/data-analytics-ai">AI and Analytics solutions</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/intelligent-automation">Automation</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/legacy-modernization">Legacy modernization</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/software-engineering">Software development</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/technology-advisory">Technology advisory</a>
                                </li>
                                <li>
                                    <a href="/industries/insurance/ui-ux-design">UI / UX Design</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                <a href="/industries/manufacturing">Manufacturing</a>
            </li>
            <li>
                <a href="/industries/media">Media</a>
            </li>
            <li>
                <a href="/industries/technology-networking">Networking and Technology</a>
            </li>
            <li>
                <a href="/industries/oil">Oil and Gas</a>
            </li>
            <li>
                <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
            </li>
            <li>
                <a href="/industries/telecommunications">Telecommunications</a>
            </li>
            <li>
                <a href="/industries/travel-and-hospitality">Travel and Hospitality</a>
            </li>
            <li>
                <a href="/industries/transportation-and-logistics">Transportation and Logistics</a>
            </li>
        </ul>
    </div>
</div>
<div class="footer__menu-mobile">
    <div class="menu-accordion">
        <div class="accordion-item normal">
            <p class="accordion-header">
                <button class="accordion-button text-20 text-uppercase collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseIndustries"
                        aria-controls="collapseIndustries">
                    Industries
                </button>
            </p>
            <div id="collapseIndustries" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <ul>
                        <li>
                            <a href="/industries/automotive">Automotive</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseBankingMobile"
                                            aria-controls="collapseBankingMobile">
                                            Banking
                                    </button>
                                </p>
                                <div id="collapseBankingMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/industries/banking">IT services for banking</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/boomerang">Boomerang software</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/cloud">Cloud banking services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/connected-wealth">Wealth management solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/core-banking">Core banking software</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/earlyresolution">EarlyResolution</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/earlyresolution/auto-loan">EarlyResolution auto loan</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/earlyresolution/borrower-portal">EarlyResolution borrower portal</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan">Hogan banking system</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/health-check">Hogan health check</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/hybrid-cloud">Hogan hybrid cloud</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/hogan-io">Hogan io</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/academy">Hogan academy</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/hogan/managed-services">Hogan managed services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/luxoft-banking-transformation-advisory">Banking transformation advisory</a>
                                            </li>
                                            <li>
                                                <a href="/industries/banking/luxoft-cams">CAMS card processing solution</a>
                                            </li>
                                            <li>
                                                <a href="/partners/temenos/health-check">Temenos health check</a>
                                            </li>
                                            <li>
                                                <a href="/partners/temenos/upgrades">Temenos upgrade</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseCapitalMobile"
                                            aria-controls="collapseCapitalMobile">
                                            Capital Markets
                                    </button>
                                </p>
                                <div id="collapseCapitalMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/industries/capital-markets">Capital markets technology solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/clm-consultancy">CLM solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/energy-and-commodity">Energy and commodity trading</a>
                                            </li>
                                            <li>
                                                <a href="/partners/goldensource">GoldenSource client services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/liquidity-management">Liquidity management services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/reconciliation-solution">Reconciliation solution</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/regtech-solutions">Regtech in financial services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/regulatory-reporting">Regulatory reporting services</a>
                                            </li>
                                            <li>
                                                <a href="/industries/capital-markets/treasury-solutions">Corporate treasury solutions</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/industries/consumer-goods">Consumer Goods</a>
                        </li>
                        <li>
                            <a href="/industries/energy-and-utilities">Energy and Utilities</a>
                        </li>
                        <li>
                            <a href="/industries/healthcare">Healthcare and Life Sciences</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseInsuranceMobile"
                                            aria-controls="collapseInsuranceMobile">
                                        Insurance
                                    </button>
                                </p>
                                <div id="collapseInsuranceMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/industries/insurance">Insurance technology solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/data-analytics-ai">AI and Analytics solutions</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/intelligent-automation">Automation</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/legacy-modernization">Legacy modernization</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/software-engineering">Software development</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/technology-advisory">Technology advisory</a>
                                            </li>
                                            <li>
                                                <a href="/industries/insurance/ui-ux-design">UI / UX Design</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/industries/manufacturing">Manufacturing</a>
                        </li>
                        <li>
                            <a href="/industries/media">Media</a>
                        </li>
                        <li>
                            <a href="/industries/technology-networking">Networking and Technology</a>
                        </li>
                        <li>
                            <a href="/industries/oil">Oil and Gas</a>
                        </li>
                        <li>
                            <a href="/industries/retail-and-ecommerce">Retail and E-commerce</a>
                        </li>
                        <li>
                            <a href="/industries/telecommunications">Telecommunications</a>
                        </li>
                        <li>
                            <a href="/industries/travel-and-hospitality">Travel and Hospitality</a>
                        </li>
                        <li>
                            <a href="/industries/transportation-and-logistics">Transportation and Logistics</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="accordion-item normal">
            <p class="accordion-header">
                <button class="accordion-button text-20 text-uppercase collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseServices"
                        aria-controls="collapseServices">
                    Services
                </button>
            </p>
            <div id="collapseServices" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <ul>
                        <li>
                            <a href="/services/cloud-solutions">Cloud Solutions</a>
                        </li>
                        <li>
                            <a href="/services/data-to-insights">Data Analytics</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseDesignMobile"
                                            aria-controls="collapseDesignMobile">
                                            Design
                                    </button>
                                </p>
                                <div id="collapseDesignMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/design">Design services</a>
                                            </li>
                                            <li>
                                                <a href="/services/innovation-strategy">Innovation strategy</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseFrontendDevelopmentMobile"
                                            aria-controls="collapseFrontendDevelopmentMobile">
                                        Front-end Development
                                    </button>
                                </p>
                                <div id="collapseFrontendDevelopmentMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/front-end-development">Front-end development services</a>
                                            </li>
                                            <li>
                                                <a href="/services/mobile-app-development">Mobile Development</a>
                                            </li>
                                            <li>
                                                <a href="/services/web-development">Web Development</a>
                                            </li>
                                            <li>
                                                <a href="/services/3d-ar-vr-development">3D, AR and VR Development</a>
                                            </li>
                                            <li>
                                                <a href="/services/web-architecture">Web/Cloud Architecture</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseIntelligentAutomationMobile"
                                            aria-controls="collapseIntelligentAutomationMobile">
                                        Intelligent Automation
                                    </button>
                                </p>
                                <div id="collapseIntelligentAutomationMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/intelligent-automation">Intelligent automation services</a>
                                            </li>
                                            <li>
                                                <a href="/services/low-code-development">Low-code development</a>
                                            </li>
                                            <li>
                                                <a href="/services/robotic-process-automation">Robotic process automation (RPA) services</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseLegacyModernizationMobile"
                                            aria-controls="collapseLegacyModernizationMobile">
                                            Legacy Modernization
                                    </button>
                                </p>
                                <div id="collapseLegacyModernizationMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/legacy-modernization">Legacy Modernization</a>
                                            </li>
                                            <li>
                                                <a href="/services/mainframe-modernization">Mainframe modernization</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/services/beyond">Luxoft Beyond</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseMachineLearningMobile"
                                            aria-controls="collapseMachineLearningMobile">
                                            Machine Learning
                                    </button>
                                </p>
                                <div id="collapseMachineLearningMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/machine-learning">Machine learning services</a>
                                            </li>
                                            <li>
                                                <a href="/services/computer-vision">Computer vision</a>
                                            </li>
                                            <li>
                                                <a href="/services/natural-language-processing">Natural language processing</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapseSoftwareEngineeringMobile"
                                            aria-controls="collapseSoftwareEngineeringMobile">
                                            Software Engineering
                                    </button>
                                </p>
                                <div id="collapseSoftwareEngineeringMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/services/engineering-services">Software engineering services</a>
                                            </li>
                                            <li>
                                                <a href="/services/financial-software-development">Financial software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/qa-automation">QA automation</a>
                                            </li>
                                            <li>
                                                <a href="/services/trading-software-development">Trading software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/software-development-outsourcing">Software development outsourcing</a>
                                            </li>
                                            <li>
                                                <a href="/services/custom-software-development">Custom software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/application-engineering-services">Application engineering services</a>
                                            </li>
                                            <li>
                                                <a href="/services/bespoke-software-development">Bespoke software development</a>
                                            </li>
                                            <li>
                                                <a href="/services/product-engineering-services">Product engineering services</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="accordion-item normal">
            <p class="accordion-header">
                <button class="accordion-button text-20 text-uppercase collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseDiscoverLuxoft"
                        aria-controls="collapseDiscoverLuxoft">
                    Discover Luxoft
                </button>
            </p>
            <div id="collapseDiscoverLuxoft" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <ul>
                        <li>
                            <a href="/about-us">About Us</a>
                        </li>
                        <li>
                            <a href="https://career.fintego.com/">Careers</a>
                        </li>
                        <li>
                            <a href="/contact-form">Contact Us</a>
                        </li>
                        <li>
                            <a href="/event">Events</a>
                        </li>
                        <li>
                            <a href="/esg">Environmental, Social and Governance</a>
                        </li>
                        <li>
                            <a href="/global-presence">Global Presence</a>
                        </li>
                        <li>
                            <a href="/insights">Insights</a>
                        </li>
                        <li>
                            <a href="/pr">Newsroom</a>
                        </li>
                        <li>
                            <div class="accordion-item mobile">
                                <p class="accordion-header">
                                    <button class="accordion-button collapsed"
                                            type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#collapsePartnershipsMobile"
                                            aria-controls="collapsePartnershipsMobile">
                                            Partnerships
                                    </button>
                                </p>
                                <div id="collapsePartnershipsMobile" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>
                                                <a href="/partners">Luxoft's partners</a>
                                            </li>
                                            <li>
                                                <a href="/partners/nasdaq">Nasdaq</a>
                                            </li>
                                            <li>
                                                <a href="/partners/appian">Appian</a>
                                            </li>
                                            <li>
                                                <a href="/partners/aws">AWS</a>
                                            </li>
                                            <li>
                                                <a href="/partners/clm">Fenergo</a>
                                            </li>
                                            <li>
                                                <a href="/partners/finastra">Finastra</a>
                                            </li>
                                            <li>
                                                <a href="/partners/goldensource">GoldenSource</a>
                                            </li>
                                            <li>
                                                <a href="/partners/itrs">ITRS</a>
                                            </li>
                                            <li>
                                                <a href="/partners/microsoft">Microsoft</a>
                                            </li>
                                            <li>
                                                <a href="/partners/moodys">Moody's Analytics</a>
                                            </li>
                                            <li>
                                                <a href="/partners/murex">Murex</a>
                                            </li>
                                            <li>
                                                <a href="/partners/orchestrade">Orchestrade</a>
                                            </li>
                                            <li>
                                                <a href="/partners/pega">Pega</a>
                                            </li>
                                            <li>
                                                <a href="/partners/planixs">Planixs</a>
                                            </li>
                                            <li>
                                                <a href="/partners/smartstream">SmartStream</a>
                                            </li>
                                            <li>
                                                <a href="/partners/temenos">Temenos</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/ukraine-updates">Ukraine updates</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
        </div>
    </div>
    <div class="container border-top">
        <div class="row footer__sub-footer pt-3 pb-3">
            <div class="col-12 col-lg-5 text-uppercase order-lg-first order-sm-last copy-right mt-sm-3 pt-sm-3 pt-lg-0 mt-lg-0">
                <p>© 2025 LUXOFT, A DXC TECHNOLOGY COMPANY. ALL RIGHTS RESERVED.</p>
            </div>
            <div class="col-12 col-lg-7 order-lg-last order-sm-first">
                <ul class="list-group list-group-horizontal-lg float-lg-end text-uppercase">
                    <li>
                        <a href="/procurement">Procurement</a>
                    </li>
                    <li>
                        <a href="/corporate-policies">Corporate Policies</a>
                    </li>
                    <li>
                        <a href="/online-privacy-policy">Privacy Policy</a>
                    </li>
                    <li>
                        <a href="/terms-of-use">Terms of Use</a>
                    </li>
                    <li>
                        <a href="/contact-form#copyrights">Report Copyright Violation</a>
                    </li>
                    <li>
                        <a href="/sitemap">Sitemap</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
        <script crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
        <script src="/theme/fintego/assets/bootstrap.bundle.min.js"></script>
        <script src="/theme/fintego/assets/tiny-slider.min.js"></script>
                <script src="/theme/fintego/assets/app.min.0ae706d0b4e4289536f7.js"></script>
    </body>
</html>
